system "CRTBNDRPG PGM(NOXDB2/jsonsql1) SRCSTMF('test/jsonsql1.rpgle') DBGVIEW(*ALL)" 
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page      1
  Command  . . . . . . . . . . . . :   CRTBNDRPG
    Issued by  . . . . . . . . . . :     NLI
  Program  . . . . . . . . . . . . :   JSONSQL1
    Library  . . . . . . . . . . . :     NOXDB2
  Text 'description' . . . . . . . :   *SRCMBRTXT
  Source stream file   . . . . . . :   test/jsonsql1.rpgle
    CCSID  . . . . . . . . . . . . :     500
  Text 'description' . . . . . . . :
  Last Change  . . . . . . . . . . :   26-11-18  17:26:00
  Generation severity level  . . . :   10
  Default activation group . . . . :   *YES
  Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                       *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                       *DEBUGIO   *UNREF     *NOEVENTF
  Debugging views  . . . . . . . . :   *ALL
  Debug encryption key . . . . . . :   *NONE
  Output . . . . . . . . . . . . . :   *PRINT
  Optimization level . . . . . . . :   *NONE
  Source listing indentation . . . :   *NONE
  Type conversion options  . . . . :   *NONE
  Sort sequence  . . . . . . . . . :   *HEX
  Language identifier  . . . . . . :   *JOBRUN
  Replace program  . . . . . . . . :   *YES
  User profile . . . . . . . . . . :   *USER
  Authority  . . . . . . . . . . . :   *LIBCRTAUT
  Truncate numeric . . . . . . . . :   *YES
  Fix numeric  . . . . . . . . . . :   *NONE
  Target release . . . . . . . . . :   *CURRENT
  Allow null values  . . . . . . . :   *NO
  Define condition names . . . . . :   *NONE
  Enable performance collection  . :   *PEP
  Profiling data . . . . . . . . . :   *NOCOL
  Licensed Internal Code options . :
  Generate program interface . . . :   *NO
  Include directory  . . . . . . . :
  Preprocessor options . . . . . . :   *NONE
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page      2
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
                          S o u r c e   L i s t i n g
     1 **FREE                                                                                                               000001
     2       // build:                                                                                                      000002
     3       //  addlible noxdb2                                                                                            000003
     4       //  cd  '/prj/noxdbutf8'                                                                                       000004
     5       //  CRTBNDRPG PGM(NOXDB2/JSONSQL1) SRCSTMF('/prj/noxdbutf8/test/jsonsql1.rpgle') dbgview(*ALL)                 000005
     6       Ctl-Opt BndDir('NOXDB') dftactgrp(*NO) ACTGRP('QILE');                                                         000006
     7                                                                                                                      000007
     8       /include 'headers/JSONPARSER.rpgle'                                                                            000008
Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
        *--------------------------------------------------------------------------------------------*
        * RPG member name  . . . . . :  JSONPARSE+                                                   *                     1
        * External name  . . . . . . :  ./headers/JSONPARSER.rpgle                                   *                     1
        * Last change  . . . . . . . :  26-11-18  17:12:21                                           *                     1
        *--------------------------------------------------------------------------------------------*
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
     9+**FREE                                                                                                              1000001
    10+        // ---------------------------------------------------------------------- *                                 1000002
    11+        // This is the prototype for noxDB - JSON, XML and SQL made easy                                            1000003
    12+        // Use the NOXDB binddir when creating your program and include this                                        1000004
    13+        // prototypes like:                                                                                         1000005
    14+                                                                                                                    1000006
    15+        //     Ctl-Opt BndDir('NOXDB') dftactgrp(*NO) ACTGRP('QILE');                                               1000007
    16+        //     /include 'headers/JSONPARSER.rpgle'                                                                  1000008
    17+                                                                                                                    1000009
    18+        // Note: Both XMLPARSER and JSONPARSER headers are autogenerated from                                       1000010
    19+        // the NOXDB header. so please do not make any changes the there headerfile                                 1000011
    20+                                                                                                                    1000012
    21+        // ---------------------------------------------------------------------- *                                 1000013
    22+      /if defined( json_DEF)                                                                                        1000014
            LINES EXCLUDED: 1
    23+      /endif                                                                                                        1000016
    24+      /define  json_DEF                                                                                             1000017
    25+                                                                                                                    1000018
    26+        // 1M minus length of 4 bytes                                                                               1000019
        *--------------------------------------------------------------------*
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page      3
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
        * Compiler Options in Effect:                                        *
        *--------------------------------------------------------------------*
        *  Text 'description' . . . . . . . :                                *
        *  Generation severity level  . . . :   10                           *
        *  Default activation group . . . . :   *NO                          *
        *  Compiler options . . . . . . . . :   *XREF      *GEN              *
        *                                       *NOSECLVL  *SHOWCPY          *
        *                                       *EXPDDS    *EXT              *
        *                                       *NOSHOWSKP *NOSRCSTMT        *
        *                                       *DEBUGIO   *UNREF            *
        *                                       *NOEVENTF                    *
        *  Optimization level . . . . . . . :   *NONE                        *
        *  Source listing indentation . . . :   *NONE                        *
        *  Type conversion options  . . . . :   *NONE                        *
        *  Sort sequence  . . . . . . . . . :   *HEX                         *
        *  Language identifier  . . . . . . :   *JOBRUN                      *
        *  User profile . . . . . . . . . . :   *USER                        *
        *  Authority  . . . . . . . . . . . :   *LIBCRTAUT                   *
        *  Truncate numeric . . . . . . . . :   *YES                         *
        *  Fix numeric  . . . . . . . . . . :   *NONE                        *
        *  Allow null values  . . . . . . . :   *NO                          *
        *  Storage model . . .  . . . . . . :   *SNGLVL                      *
        *  Binding directory from Command . :   *NONE                        *
        *  Binding directory from Source  . :   NOXDB                        *
        *    Library  . . . . . . . . . . . :     *LIBL                      *
        *  Activation group . . . . . . . . :   QILE                         *
        *  Enable performance collection  . :   *PEP                         *
        *  Profiling data . . . . . . . . . :   *NOCOL                       *
        *  Generate program interface . . . :   *NO                          *
        *--------------------------------------------------------------------*
    27+        Dcl-S UTF8 varchar(1048572) CCSID(*UTF8) Template;                                                          1000020
    28+                                                                                                                    1000021
    29+        // ---------------------------------------------------------------------- *                                 1000022
    30+        // Type of a node:                                                                                          1000023
    31+        // ---------------------------------------------------------------------- *                                 1000024
    32+        Dcl-C json_UNKNOWN const(0);                                                                                1000025
    33+        Dcl-C json_OBJECT  const(1);                                                                                1000026
    34+        Dcl-C json_ARRAY   const(2);                                                                                1000027
    35+        Dcl-C json_EVAL    const(3);                                                                                1000028
    36+        Dcl-C json_POINTER_VALUE const(4);                                                                          1000029
    37+        Dcl-C json_VALUE   const(5);                                                                                1000030
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page      4
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    38+        Dcl-C json_ROOT    const(6);                                                                                1000031
    39+        Dcl-C json_LITERAL const(16);                                                                               1000032
    40+        Dcl-C json_OBJLINK const(17);                                                                               1000033
    41+        Dcl-C json_OBJREPLACE const(18);                                                                            1000034
    42+        Dcl-C json_OBJCOPY const(18);                                                                               1000035
    43+        Dcl-C json_BY_CONTEXT const(19);                                                                            1000036
    44+        Dcl-C json_OBJMOVE const(2048);                                                                             1000037
    45+                                                                                                                    1000038
    46+        // * Modifiers to "add" / "or" into "parseString" and "evaluate"                                            1000039
    47+        // !! Type - have to be backwards compat.                                                                   1000040
    48+        // Unlink the source and move it to dest.                                                                   1000041
    49+        Dcl-C json_MOVE_NODES const(2048);                                                                          1000042
    50+        // Allow strings ints and other values to                                                                   1000043
    51+        Dcl-C json_ALLOW_PRIMITIVES const(4096);                                                                    1000044
    52+                                                                                                                    1000045
    53+        // * Combinations:                                                                                          1000046
    54+        // json_PARSE  = json_EVAL + json_MOVE_NODES                                                                1000047
    55+        Dcl-C json_PARSE   const(2051);                                                                             1000048
    56+                                                                                                                    1000049
    57+        // Merge options:                                                                                           1000050
    58+        // Modifiers to "add" / "or" into "JSON_EVAL"                                                               1000051
    59+      /if not defined(MO_MERGE)                                                                                     1000052
    60+      /define  MO_MERGE                                                                                             1000053
    61+        // Only new elements are merged - existing                                                                  1000054
    62+        // are left untouched                                                                                       1000055
    63+        Dcl-C MO_MERGE_NEW const(256);                                                                              1000056
    64+        // Merge and replace only existing nodes.                                                                   1000057
    65+        Dcl-C MO_MERGE_MATCH const(512);                                                                            1000058
    66+        // Merge all: replace if it exists and                                                                      1000059
    67+        // append new nodes if not exists                                                                           1000060
    68+        Dcl-C MO_MERGE_REPLACE const(1024 );                                                                        1000061
    69+      /endif                                                                                                        1000062
    70+                                                                                                                    1000063
    71+        Dcl-C json_CHILD_LIST const('#0¤');                                                                         1000064
    72+                                                                                                                    1000065
    73+        // ----------------------------------------------------------------------                                   1000066
    74+        // Returns node to the json_object tree                                                                     1000067
    75+        Dcl-PR json_ParseFile Pointer extproc(*CWIDEN:'nox_ParseFile');                                             1000068
    76+          // File to parse                                                                                          1000069
    77+          FileName       pointer value  options(*string);                                                           1000070
    78+        End-PR;                                                                                                     1000071
    79+                                                                                                                    1000072
    80+        // Returns node json_object tree                                                                            1000073
    81+        Dcl-PR json_ParseStringVC Pointer extproc(*CWIDEN:'nox_ParseStringVC');                                     1000074
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page      5
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
    82+          // String to parse                                                                                        1000075
    83+          String         Like(UTF8) const options(*varsize);                                                        1000076
    84+        End-PR;                                                                                                     1000077
    85+                                                                                                                    1000078
    86+        // Set , or . for numeri decimal point                                                                      1000079
    87+        Dcl-PR json_setDecPoint  extproc(*CWIDEN : 'nox_SetDecPoint');                                              1000080
    88+          // decimal point char                                                                                     1000081
    89+          decPoint       Like(UTF8) const options(*varsize);                                                        1000082
    90+        End-PR;                                                                                                     1000083
    91+                                                                                                                    1000084
    92+        // Bool true if errors occures                                                                              1000085
    93+        Dcl-PR json_Error Ind extproc(*CWIDEN:'nox_Error');                                                         1000086
    94+          // json_Object  node                                                                                      1000087
    95+          pNode          Pointer    value;                                                                          1000088
    96+        End-PR;                                                                                                     1000089
    97+                                                                                                                    1000090
    98+        // Return error description                                                                                 1000091
    99+        // NL-OK                                                                                                    1000092
   100+        Dcl-PR json_Message varchar(1024) extproc(*CWIDEN:'nox_MessageVC');                                         1000093
   101+          // json_Object                                                                                            1000094
   102+          pNode          Pointer    value;                                                                          1000095
   103+        End-PR;                                                                                                     1000096
   104+                                                                                                                    1000097
   105+        // Without parameters you will get the last internal error                                                  1000098
   106+        // Otherwise it will format an error object                                                                 1000099
   107+        // NL-OK                                                                                                    1000100
   108+        Dcl-PR json_GetMessageObject Pointer // Return error description                                            1000101
   109+                                   extproc(*CWIDEN:'nox_GetMessageObject');                                         1000102
   110+          MessageId      Like(UTF8) const options(*nopass:*varsize);                                                1000103
   111+          MessageData    Like(UTF8) const options(*nopass:*varsize);                                                1000104
   112+        End-PR;                                                                                                     1000105
   113+                                                                                                                    1000106
   114+        // simple courtesy function to return a æ"success":trueå object                                             1000107
   115+        // Return success:true object                                                                               1000108
   116+        Dcl-PR json_SuccessTrue Pointer extproc(*CWIDEN:'nox_SuccessTrue');                                         1000109
   117+          MessageId      Like(UTF8) const options(*nopass:*varsize);                                                1000110
   118+          MessageData    Like(UTF8) const options(*nopass:*varsize);                                                1000111
   119+        End-PR;                                                                                                     1000112
   120+                                                                                                                    1000113
   121+        // Returns pointer to node                                                                                  1000114
   122+        // NL-OK                                                                                                    1000115
   123+        Dcl-PR json_Locate Pointer extproc(*CWIDEN : 'nox_GetNodeVC');                                              1000116
   124+          // Pointer to tree or node                                                                                1000117
   125+          pNode          Pointer    value;                                                                          1000118
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page      6
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   126+          // location expression                                                                                    1000119
   127+          Expression     Like(UTF8) const options(*varsize);                                                        1000120
   128+        End-PR;                                                                                                     1000121
   129+                                                                                                                    1000122
   130+        // Returns pointer to node                                                                                  1000123
   131+        Dcl-PR json_LocateOrCreate Pointer                                                                          1000124
   132+                                 extproc(*CWIDEN : 'nox_GetOrCreateNode');                                          1000125
   133+          // Pointer to tree or node                                                                                1000126
   134+          pNode          Pointer    value;                                                                          1000127
   135+          // location expression                                                                                    1000128
   136+          Expression     Like(UTF8) const options(*varsize);                                                        1000129
   137+        End-PR;                                                                                                     1000130
   138+                                                                                                                    1000131
   139+        // Returns 'ON' if node exists                                                                              1000132
   140+        Dcl-PR json_Has Ind extproc(*CWIDEN : 'nox_Has');                                                           1000133
   141+          // Pointer to tree or node                                                                                1000134
   142+          pNode          Pointer    value;                                                                          1000135
   143+          // Path to node                                                                                           1000136
   144+          NodeName       Like(UTF8) const options(*varsize);                                                        1000137
   145+        End-PR;                                                                                                     1000138
   146+                                                                                                                    1000139
   147+        // Returns 'ON' if node exists and has <> 0                                                                 1000140
   148+        Dcl-PR json_isTrue Ind extproc(*CWIDEN : 'nox_IsTrue');                                                     1000141
   149+          // Pointer to tree or node                                                                                1000142
   150+          pNode          Pointer    value;                                                                          1000143
   151+          // Path to node                                                                                           1000144
   152+          NodeName       Like(UTF8) const options(*varsize);                                                        1000145
   153+        End-PR;                                                                                                     1000146
   154+                                                                                                                    1000147
   155+        // Returns 'ON' if node exists and has <> 0                                                                 1000148
   156+        Dcl-PR json_isNull Ind extproc(*CWIDEN : 'nox_IsNull');                                                     1000149
   157+          // Pointer to tree or node                                                                                1000150
   158+          pNode          Pointer    value;                                                                          1000151
   159+          // Path to node                                                                                           1000152
   160+          NodeName       Like(UTF8) const options(*varsize);                                                        1000153
   161+        End-PR;                                                                                                     1000154
   162+                                                                                                                    1000155
   163+        // Returns 'ON' if it is a valid node                                                                       1000156
   164+        Dcl-PR json_isNode Ind extproc(*CWIDEN : 'nox_isNode');                                                     1000157
   165+          // a.k.a. false for strings                                                                               1000158
   166+          pNode          Pointer    value;                                                                          1000159
   167+        End-PR;                                                                                                     1000160
   168+                                                                                                                    1000161
   169+        // renames the node name                                                                                    1000162
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page      7
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   170+        Dcl-PR json_NodeRename Ind extproc(*CWIDEN : 'nox_NodeRename');                                             1000163
   171+          // Pointer to tree or node                                                                                1000164
   172+          pNode          Pointer    value;                                                                          1000165
   173+          // Path to node                                                                                           1000166
   174+          NodeName       Like(UTF8) const options(*varsize);                                                        1000167
   175+        End-PR;                                                                                                     1000168
   176+                                                                                                                    1000169
   177+        // Returns pointer to next sibling (elem)                                                                   1000170
   178+        Dcl-PR json_GetNext Pointer extproc(*CWIDEN : 'nox_GetNodeNext');                                           1000171
   179+          // Pointer to current node (elem)                                                                         1000172
   180+          pNode          Pointer    value;                                                                          1000173
   181+        End-PR;                                                                                                     1000174
   182+                                                                                                                    1000175
   183+        // Returns pointer to first child (elem)                                                                    1000176
   184+        Dcl-PR json_GetChild Pointer extproc(*CWIDEN : 'nox_GetNodeChild');                                         1000177
   185+          // Pointer to current node (elem)                                                                         1000178
   186+          pNode          Pointer    value;                                                                          1000179
   187+        End-PR;                                                                                                     1000180
   188+                                                                                                                    1000181
   189+        // Returns pointer to parent node                                                                           1000182
   190+        Dcl-PR json_GetParent Pointer extproc(*CWIDEN : 'nox_GetNodeParent');                                       1000183
   191+          // Pointer to current node (elem)                                                                         1000184
   192+          pNode          Pointer    value;                                                                          1000185
   193+        End-PR;                                                                                                     1000186
   194+                                                                                                                    1000187
   195+        Dcl-PR json_SetEval pointer extproc(*CWIDEN:'nox_SetEvalByName');                                           1000188
   196+          pNode          Pointer    value;                                                                          1000189
   197+          Expresion      Like(UTF8) const options(*varsize);                                                        1000190
   198+          Value          Like(UTF8) const options(*varsize);                                                        1000191
   199+        End-PR;                                                                                                     1000192
   200+                                                                                                                    1000193
   201+        Dcl-PR json_SetStr Pointer extproc(*CWIDEN: 'nox_SetStrByName');                                            1000194
   202+          // Pointer to json_ tree                                                                                  1000195
   203+          pNode          Pointer    value;                                                                          1000196
   204+          // X-path locations to node or attributes                                                                 1000197
   205+          Expresion      Like(UTF8) const options(*varsize);                                                        1000198
   206+          // New value to set / pointer to object                                                                   1000199
   207+          Value          Like(UTF8) const options(*varsize);                                                        1000200
   208+        End-PR;                                                                                                     1000201
   209+                                                                                                                    1000202
   210+        Dcl-PR json_SetInt Pointer extproc(*CWIDEN: 'nox_SetIntByName');                                            1000203
   211+          // Pointer to json_ tree                                                                                  1000204
   212+          pNode          Pointer    value;                                                                          1000205
   213+          // X-path locations to node or attributes                                                                 1000206
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page      8
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   214+          Expresion      Like(UTF8) const options(*varsize);                                                        1000207
   215+          // New value to set / pointer to object                                                                   1000208
   216+          Value          Int(10)    value;                                                                          1000209
   217+        End-PR;                                                                                                     1000210
   218+                                                                                                                    1000211
   219+        Dcl-PR json_SetNum Pointer extproc(*CWIDEN: 'nox_SetDecByName');                                            1000212
   220+          // Pointer to json_ tree                                                                                  1000213
   221+          pNode          Pointer    value;                                                                          1000214
   222+          // X-path locations to node or attributes                                                                 1000215
   223+          Expresion      Like(UTF8) const options(*varsize);                                                        1000216
   224+          // New value to set / pointer to object                                                                   1000217
   225+          Value          Packed(30:15) value;                                                                       1000218
   226+        End-PR;                                                                                                     1000219
   227+                                                                                                                    1000220
   228+        Dcl-PR json_SetBool Pointer extproc(*CWIDEN: 'nox_SetBoolByName');                                          1000221
   229+          // Pointer to json_ tree                                                                                  1000222
   230+          pNode          Pointer    value;                                                                          1000223
   231+          // X-path locations to node or attributes                                                                 1000224
   232+          Expresion      Like(UTF8) const options(*varsize);                                                        1000225
   233+          // New value to set / pointer to object                                                                   1000226
   234+          Value          Ind        value;                                                                          1000227
   235+        End-PR;                                                                                                     1000228
   236+                                                                                                                    1000229
   237+        Dcl-PR json_SetPtr Pointer extproc(*CWIDEN: 'nox_SetPtrByName');                                            1000230
   238+          // Pointer to json_ tree                                                                                  1000231
   239+          pNode          Pointer    value;                                                                          1000232
   240+          // X-path locations to node or attributes                                                                 1000233
   241+          Expresion      Like(UTF8) const options(*varsize);                                                        1000234
   242+          // Pointer to anything - You do the cleanup                                                               1000235
   243+          Value          Pointer    value;                                                                          1000236
   244+        End-PR;                                                                                                     1000237
   245+                                                                                                                    1000238
   246+        Dcl-PR json_SetProcPtr Pointer extproc(*CWIDEN: 'nox_SetPtrByName');                                        1000239
   247+          pNode          Pointer    value; // Pointer to json_ tree                                                 1000240
   248+          // X-path locations to node or attributes                                                                 1000241
   249+          Expresion      Like(UTF8) const options(*varsize);                                                        1000242
   250+          Proc           Pointer(*Proc); // Pointer to a procedure                                                  1000243
   251+          // *ON=String escape, *OFF=If literals                                                                    1000244
   252+          isString       Ind        value options(*nopass);                                                         1000245
   253+        End-PR;                                                                                                     1000246
   254+                                                                                                                    1000247
   255+        Dcl-PR json_SetValue Pointer extproc(*CWIDEN: 'nox_SetValueByName');                                        1000248
   256+          // Pointer to json_ tree                                                                                  1000249
   257+          pNode          Pointer    value;                                                                          1000250
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page      9
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   258+          // X-path locations to node or attributes                                                                 1000251
   259+          Expresion      Like(UTF8) const options(*varsize);                                                        1000252
   260+          // New value to set / pointer to object                                                                   1000253
   261+          Value          Like(UTF8) const options(*nopass:*varsize);                                                1000254
   262+          // Optional new type (Refer "node type"                                                                   1000255
   263+          Type           Uns(5)     value options(*nopass);                                                         1000256
   264+        End-PR;                                                                                                     1000257
   265+                                                                                                                    1000258
   266+        Dcl-PR json_GetValueStr Like(UTF8)                                                                          1000259
   267+                              extproc(*CWIDEN : 'nox_GetNodeValueVC');                                              1000260
   268+          // Pointer to node                                                                                        1000261
   269+          pNode          Pointer    value;                                                                          1000262
   270+          // If not found - default value                                                                           1000263
   271+          Defaultvalue   Like(UTF8) const options(*nopass:*varsize);                                                1000264
   272+        End-PR;                                                                                                     1000265
   273+                                                                                                                    1000266
   274+        Dcl-PR json_GetValueNum Packed(30:15)                                                                       1000267
   275+                              extproc(*CWIDEN : 'nox_GetNodeValueNum');                                             1000268
   276+          // Pointer to node                                                                                        1000269
   277+          pNode          Pointer    value;                                                                          1000270
   278+          // If not found - default value                                                                           1000271
   279+          Defaultvalue   Packed(30:15) value options(*NOPASS);                                                      1000272
   280+        End-PR;                                                                                                     1000273
   281+                                                                                                                    1000274
   282+        Dcl-PR json_GetValueInt Int(20) extproc(*CWIDEN : 'nox_GetNodeValueInt');                                   1000275
   283+          pNode          Pointer    value; // Pointer to node                                                       1000276
   284+          // If not found - default value                                                                           1000277
   285+          Defaultvalue   Int(20)    value options(*NOPASS);                                                         1000278
   286+        End-PR;                                                                                                     1000279
   287+                                                                                                                    1000280
   288+        Dcl-PR json_GetValuePtr Pointer extproc(*CWIDEN : 'nox_GetNodeValuePtr');                                   1000281
   289+          // Pointer to node                                                                                        1000282
   290+          pNode          Pointer    value;                                                                          1000283
   291+          // If not found - default value                                                                           1000284
   292+          Defaultvalue   Like(UTF8) const options(*nopass:*varsize);                                                1000285
   293+        End-PR;                                                                                                     1000286
   294+                                                                                                                    1000287
   295+        Dcl-PR json_GetName Like(UTF8)                                                                              1000288
   296+                          extproc(*CWIDEN : 'nox_GetNodeNameVC');                                                   1000289
   297+          // Pointer to node                                                                                        1000290
   298+          pNode          Pointer    value;                                                                          1000291
   299+        End-PR;                                                                                                     1000292
   300+                                                                                                                    1000293
   301+        Dcl-PR json_GetNameAsPath Like(UTF8)                                                                        1000294
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     10
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   302+                                extproc(*CWIDEN : 'nox_GetNodeNameAsPath');                                         1000295
   303+          // Pointer to node                                                                                        1000296
   304+          pNode          Pointer    value;                                                                          1000297
   305+          // Delimiter like - or . or / or \                                                                        1000298
   306+          Delimiter      Char(1)    value CCSID(*UTF8);                                                             1000299
   307+        End-PR;                                                                                                     1000300
   308+                                                                                                                    1000301
   309+        // * Refer to node type above                                                                               1000302
   310+        Dcl-PR json_NodeType Int(5) extproc(*CWIDEN : 'nox_GetNodeType');                                           1000303
   311+          // Pointer to json_ tree to receive format                                                                1000304
   312+          pNode          Pointer    value;                                                                          1000305
   313+        End-PR;                                                                                                     1000306
   314+                                                                                                                    1000307
   315+      // Get string by expresion                                                                                    1000308
   316+      //  /object/array#123¤/name                                                                                   1000309
   317+      //  .object.array#123¤.name                                                                                   1000310
   318+      // NL-OK                                                                                                      1000311
   319+        Dcl-PR json_GetStr Like(UTF8) rtnparm extproc(*CWIDEN : 'nox_GetValueVC');                                  1000312
   320+          // Pointer to relative node                                                                               1000313
   321+          pNode          Pointer    value;                                                                          1000314
   322+          // Locations expression to node                                                                           1000315
   323+          Expression     Like(UTF8) const options(*nopass:*varsize);                                                1000316
   324+          // If not found - default value                                                                           1000317
   325+          Defaultvalue   Like(UTF8) const options(*nopass:*varsize);                                                1000318
   326+        End-PR;                                                                                                     1000319
   327+                                                                                                                    1000320
   328+      //  will join all subsequent array nodes into one resulting string                                            1000321
   329+        Dcl-PR json_GetStrJoin Like(UTF8)                                                                           1000322
   330+                             extproc(*CWIDEN : 'nox_GetStrJoinVC');                                                 1000323
   331+          // Pointer to relative node                                                                               1000324
   332+          pNode          Pointer    value;                                                                          1000325
   333+          // Locations expression to node                                                                           1000326
   334+          Expression     Like(UTF8) const options(*nopass:*varsize);                                                1000327
   335+          // If not found - default value                                                                           1000328
   336+          Defaultvalue   Like(UTF8) const options(*nopass:*varsize);                                                1000329
   337+        End-PR;                                                                                                     1000330
   338+                                                                                                                    1000331
   339+      // Get number by expresion like:                                                                              1000332
   340+      //  /object/array#123¤/name                                                                                   1000333
   341+      //  .object.array#123¤.name                                                                                   1000334
   342+      // NL-OK                                                                                                      1000335
   343+        Dcl-PR json_GetNum Packed(30:15) extproc(*CWIDEN : 'nox_GetValueNumVC');                                    1000336
   344+          // Pointer to relative node                                                                               1000337
   345+          pNode          Pointer    value;                                                                          1000338
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     11
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   346+          // Locations expression to node                                                                           1000339
   347+          Expression     Like(UTF8) const  options(*nopass:*varsize);                                               1000340
   348+          // If not found - default value                                                                           1000341
   349+          Defaultvalue   Packed(30:15) value options(*nopass);                                                      1000342
   350+        End-PR;                                                                                                     1000343
   351+                                                                                                                    1000344
   352+        Dcl-PR json_GetInt Int(20) extproc(*CWIDEN : 'nox_GetValueIntVC');                                          1000345
   353+          // Pointer to relative node                                                                               1000346
   354+          pNode          Pointer    value;                                                                          1000347
   355+          // Locations expression to node                                                                           1000348
   356+          Expression     Like(UTF8) const options(*nopass:*varsize);                                                1000349
   357+          // If not found - default value                                                                           1000350
   358+          Defaultvalue   Int(20)    value options(*nopass);                                                         1000351
   359+        End-PR;                                                                                                     1000352
   360+                                                                                                                    1000353
   361+        // Set an ILOB object to a value found by X                                                                 1000354
   362+        // Return *ON if found                                                                                      1000355
   363+        Dcl-PR json_GetIlobValue Ind extproc(*CWIDEN :'ILOB_XmlGetValue');                                          1000356
   364+          // Pointer to ILOB object to receive the va                                                               1000357
   365+          pIlob          Pointer    value;                                                                          1000358
   366+          // Pointer to tree                                                                                        1000359
   367+          pNode          Pointer    value;                                                                          1000360
   368+          // X-path locations to node or attributes                                                                 1000361
   369+          Expression     Like(UTF8) const options(*varsize);                                                        1000362
   370+        End-PR;                                                                                                     1000363
   371+                                                                                                                    1000364
   372+        Dcl-PR json_CopyValue Pointer extproc(*CWIDEN : 'nox_CopyValue');                                           1000365
   373+          // destination node                                                                                       1000366
   374+          pDest          Pointer    value;                                                                          1000367
   375+          // destiantion name (or *NULL or '')                                                                      1000368
   376+          destName       Like(UTF8) const options(*varsize);                                                        1000369
   377+          // source node                                                                                            1000370
   378+          pSource        Pointer    value;                                                                          1000371
   379+          // source name (or *NULL or '')                                                                           1000372
   380+          sourceName     Like(UTF8) const options(*varsize);                                                        1000373
   381+        End-PR;                                                                                                     1000374
   382+                                                                                                                    1000375
   383+        Dcl-PR json_NodeCopy extproc(*CWIDEN : 'nox_NodeCopy');                                                     1000376
   384+          // node. Retrive from Locate()                                                                            1000377
   385+          pRootNode      Pointer    value;                                                                          1000378
   386+          // node. Retrive from Locate()                                                                            1000379
   387+          pNewChild      Pointer    value;                                                                          1000380
   388+          // Reference location to where it arrive                                                                  1000381
   389+          RefLocation    Int(10)    value;                                                                          1000382
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     12
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   390+        End-PR;                                                                                                     1000383
   391+                                                                                                                    1000384
   392+        // Following constants used by json_NodeCopy:RefLocation                                                    1000385
   393+        Dcl-C json_FIRST_CHILD const(1);                                                                            1000386
   394+        Dcl-C json_LAST_CHILD const(2);                                                                             1000387
   395+        Dcl-C json_BEFORE_SIBLING const(3);                                                                         1000388
   396+        Dcl-C json_AFTER_SIBLING const(4);                                                                          1000389
   397+                                                                                                                    1000390
   398+        Dcl-PR json_NodeClone Pointer extproc(*CWIDEN : 'nox_NodeClone');                                           1000391
   399+          // node. Retrive from Locate()                                                                            1000392
   400+          pSource        Pointer    value;                                                                          1000393
   401+        End-PR;                                                                                                     1000394
   402+                                                                                                                    1000395
   403+        // returns the new node                                                                                     1000396
   404+        Dcl-PR json_NodeAdd Pointer extproc(*CWIDEN : 'nox_NodeAdd');                                               1000397
   405+          // node. Retrive from Locate()                                                                            1000398
   406+          pRootNode      Pointer    value;                                                                          1000399
   407+          // Reference location to where it arrive                                                                  1000400
   408+          RefLocation    Int(10)    value;                                                                          1000401
   409+          // Name of node                                                                                           1000402
   410+          Name           Like(UTF8) const options(*varsize);                                                        1000403
   411+          // Value or expression                                                                                    1000404
   412+          Value          Like(UTF8) const options(*varsize);                                                        1000405
   413+          // New type (Refer "node type"                                                                            1000406
   414+          Type           Uns(5)     value;                                                                          1000407
   415+        End-PR;                                                                                                     1000408
   416+                                                                                                                    1000409
   417+        Dcl-PR json_NodeDelete extproc(*CWIDEN : 'nox_NodeDelete');                                                 1000410
   418+          // node. Retrive from Locate()                                                                            1000411
   419+          pRootNode      Pointer    value;                                                                          1000412
   420+        End-PR;                                                                                                     1000413
   421+                                                                                                                    1000414
   422+        // Alternative name:                                                                                        1000415
   423+        Dcl-PR json_Delete extproc(*CWIDEN : 'nox_NodeDelete');                                                     1000416
   424+          // element. Retrive from Locate()                                                                         1000417
   425+          pRootNode      Pointer    value;                                                                          1000418
   426+        End-PR;                                                                                                     1000419
   427+                                                                                                                    1000420
   428+                                                                                                                    1000421
   429+        // Unlink the note from its previous and promote it as a new root node                                      1000422
   430+        Dcl-PR json_NodeUnlink Pointer extproc(*CWIDEN : 'nox_NodeUnlink');                                         1000423
   431+          // Targenode. Retrive from Locate(                                                                        1000424
   432+          pNode          Pointer    value;                                                                          1000425
   433+        End-PR;                                                                                                     1000426
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     13
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   434+                                                                                                                    1000427
   435+        Dcl-PR json_NodeSanitize extproc(*CWIDEN : 'nox_NodeSanitize');                                             1000428
   436+          // node. Retrive from Locate()                                                                            1000429
   437+          pRootNode      Pointer    value;                                                                          1000430
   438+        End-PR;                                                                                                     1000431
   439+                                                                                                                    1000432
   440+        // CheckSum of all names and values                                                                         1000433
   441+        // Delete all nodes which value are null                                                                    1000434
   442+        Dcl-PR json_NodeCheckSum Uns(10) extproc(*CWIDEN : 'nox_NodeCheckSum');                                     1000435
   443+          pRootNode      Pointer    value; // node. Retrive from Locate()                                           1000436
   444+        End-PR;                                                                                                     1000437
   445+                                                                                                                    1000438
   446+        // returns the new node                                                                                     1000439
   447+        Dcl-PR json_NewObject Pointer extproc(*CWIDEN : 'nox_NewObject');                                           1000440
   448+          // Destination. Retrive from Locate()                                                                     1000441
   449+          pDestNode      Pointer    value options(*nopass);                                                         1000442
   450+        End-PR;                                                                                                     1000443
   451+                                                                                                                    1000444
   452+      // Array functions                                                                                            1000445
   453+        // returns the new node                                                                                     1000446
   454+        Dcl-PR json_NewArray Pointer extproc(*CWIDEN : 'nox_NewArray');                                             1000447
   455+          // Destination. Retrive from Locate()                                                                     1000448
   456+          pDestNode      Pointer    value options(*nopass);                                                         1000449
   457+        End-PR;                                                                                                     1000450
   458+                                                                                                                    1000451
   459+        // returns the new node added to the end of                                                                 1000452
   460+        Dcl-PR json_ArrayPush Pointer extproc(*CWIDEN : 'nox_ArrayPush');                                           1000453
   461+          // Destination. Retrive from Locate()                                                                     1000454
   462+          pDestArray     Pointer    value;                                                                          1000455
   463+          // source node to append                                                                                  1000456
   464+          pSourceNode    Like(UTF8) const options(*varsize);                                                        1000457
   465+          // 0=(Dft) Unlink and move, 1=copy a clone                                                                1000458
   466+          copy           Uns(5)     value options(*nopass);                                                         1000459
   467+        End-PR;                                                                                                     1000460
   468+                                                                                                                    1000461
   469+        // Following constants used by json_ArrayPush:copy                                                          1000462
   470+        Dcl-C json_MOVE_UNLINK const(0);                                                                            1000463
   471+        Dcl-C json_COPY_CLONE const(1);                                                                             1000464
   472+                                                                                                                    1000465
   473+        // returns the new node added to the end of                                                                 1000466
   474+        Dcl-PR json_ArrayAppend Pointer extproc(*CWIDEN :'nox_ArrayAppend');                                        1000467
   475+          // Destination. Retrive from Locate()                                                                     1000468
   476+          pDestArray     Pointer    value;                                                                          1000469
   477+          // source node to append                                                                                  1000470
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     14
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   478+          pSourceNode    Like(UTF8) const options(*varsize);                                                        1000471
   479+          // 0=(Dft) Unlink and move, 1=copy a clone                                                                1000472
   480+          copy           Uns(5)     value options(*nopass);                                                         1000473
   481+        End-PR;                                                                                                     1000474
   482+                                                                                                                    1000475
   483+        // returns the new array fro source array                                                                   1000476
   484+        Dcl-PR json_ArraySlice Pointer extproc(*CWIDEN : 'nox_ArraySlice' );                                        1000477
   485+          // source node or array string                                                                            1000478
   486+          pSourceNode    Like(UTF8) const options(*varsize);                                                        1000479
   487+          // From entry ( 1=First)                                                                                  1000480
   488+          from           Int(10)    value;                                                                          1000481
   489+          // To and includ   (-1 = Until end)                                                                       1000482
   490+          to             Int(10)    value;                                                                          1000483
   491+          // 0=(Dft) Unlink and move, 1=copy a clone                                                                1000484
   492+          copy           Uns(5)     value options(*nopass);                                                         1000485
   493+        End-PR;                                                                                                     1000486
   494+                                                                                                                    1000487
   495+        // returns the new node added to the end of                                                                 1000488
   496+        Dcl-PR json_ArraySort Pointer extproc(*CWIDEN : 'nox_ArraySort');                                           1000489
   497+          // Destination. Retrive from Locate()                                                                     1000490
   498+          pArray         Pointer    value;                                                                          1000491
   499+          // nodenames if any in subobject to comapre                                                               1000492
   500+          pkeyNames      Like(UTF8) value ;                                                                         1000493
   501+          // 0=(Dft) use json numerics, 1=Use locale                                                                1000494
   502+          options        uns(5)     value options(*nopass);                                                         1000495
   503+        End-PR;                                                                                                     1000496
   504+                                                                                                                    1000497
   505+        Dcl-C json_USE_LOCALE const(1);                                                                             1000498
   506+                                                                                                                    1000499
   507+        // returns the first node with expr value                                                                   1000500
   508+        Dcl-PR json_LookupValue Pointer extproc(*CWIDEN : 'nox_lookupValue');                                       1000501
   509+          // Array/ obj to search                                                                                   1000502
   510+          pArray         Pointer    value;                                                                          1000503
   511+          // What to search for                                                                                     1000504
   512+          expr           Like(UTF8) const options(*varsize);                                                        1000505
   513+          // 0=(Dft) Same case, 1=ignore case                                                                       1000506
   514+          ignoreCase     Uns(5)     value options(*nopass);                                                         1000507
   515+        End-PR;                                                                                                     1000508
   516+                                                                                                                    1000509
   517+        // Following constants used by json_LookupValue:ignoreCase                                                  1000510
   518+        Dcl-C json_SAME_CASE const(0);                                                                              1000511
   519+        Dcl-C json_IGNORE_CASE const(1);                                                                            1000512
   520+                                                                                                                    1000513
   521+        // returns numer of element in array or obj                                                                 1000514
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     15
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   522+        Dcl-PR json_GetLength Int(10) extproc(*CWIDEN : 'nox_getLength'  );                                         1000515
   523+          // Array to count length                                                                                  1000516
   524+          pArray         Pointer    value;                                                                          1000517
   525+        End-PR;                                                                                                     1000518
   526+                                                                                                                    1000519
   527+        // returns the new node                                                                                     1000520
   528+        Dcl-PR json_Merge Pointer extproc(*CWIDEN : 'nox_NodeMerge');                                               1000521
   529+          // Destination. Retrive from Locate()                                                                     1000522
   530+          pDestNode      Pointer    value;                                                                          1000523
   531+          // Source tree  Retrive from Locate()                                                                     1000524
   532+          pSourceNode    Pointer    value;                                                                          1000525
   533+          // Optional new type                                                                                      1000526
   534+          Type           Uns(5)     value options(*nopass);                                                         1000527
   535+        End-PR;                                                                                                     1000528
   536+                                                                                                                    1000529
   537+        // Following constants used by json_Merge:Type                                                              1000530
   538+        Dcl-C json_DONTREPLACE const(0);                                                                            1000531
   539+        Dcl-C json_REPLACE const(1);                                                                                1000532
   540+                                                                                                                    1000533
   541+        // returns the new node                                                                                     1000534
   542+        Dcl-PR json_MergeObjects Pointer extproc(*CWIDEN : 'nox_MergeObjects');                                     1000535
   543+          // Destination. Retrive from Locate()                                                                     1000536
   544+          pDestObj       Pointer    value;                                                                          1000537
   545+          // Source tree  Retrive from Locate()                                                                     1000538
   546+          pSourceObj     Pointer    value;                                                                          1000539
   547+          // json_DONTREPLACE or json_OBJREPLACE                                                                    1000540
   548+          Type           Uns(5)     value;                                                                          1000541
   549+        End-PR;                                                                                                     1000542
   550+                                                                                                                    1000543
   551+        // returns the source node                                                                                  1000544
   552+        Dcl-PR json_MoveObjectInto Pointer extproc(*CWIDEN : 'nox_NodeMoveInto');                                   1000545
   553+          // Destination. Retrive from Locate()                                                                     1000546
   554+          pDestObj       Pointer    value;                                                                          1000547
   555+          Name           Like(UTF8) const options(*varsize);                                                        1000548
   556+          // Source tree  Retrive from Locate()                                                                     1000549
   557+          pSourceObj     Pointer    value;                                                                          1000550
   558+        End-PR;                                                                                                     1000551
   559+                                                                                                                    1000552
   560+        Dcl-PR json_Dump  extproc(*CWIDEN : 'nox_Dump');                                                            1000553
   561+          // Pointer to tree                                                                                        1000554
   562+          pNode          Pointer    value;                                                                          1000555
   563+        End-PR;                                                                                                     1000556
   564+                                                                                                                    1000557
   565+                                                                                                                    1000558
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     16
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   566+        Dcl-PR json_CloneFormat  extproc(*CWIDEN : 'nox_CloneFormat');                                              1000559
   567+          // Pointer to tree to receive format                                                                      1000560
   568+          pNode          Pointer    value;                                                                          1000561
   569+          // node ptr or path with right formating                                                                  1000562
   570+          pCloneFrom     Like(UTF8) const options(*varsize);                                                        1000563
   571+        End-PR;                                                                                                     1000564
   572+                                                                                                                    1000565
   573+        // **  JSON renderes ***                                                                                    1000566
   574+        Dcl-PR json_WriteJsonStmf  extproc(*CWIDEN : 'nox_WriteJsonStmf');                                          1000567
   575+          // node. Retrive from Locate()                                                                            1000568
   576+          pNode          Pointer    value;                                                                          1000569
   577+          // Name of output stream file                                                                             1000570
   578+          FileName       Like(UTF8) const options(*varsize);                                                        1000571
   579+          // Ccsid of output file                                                                                   1000572
   580+          Ccsid          Int(10)    value;                                                                          1000573
   581+          Trim           Ind        value;                                                                          1000574
   582+          // Extra options                                                                                          1000575
   583+          Options        Like(UTF8) const options(*nopass:*varsize);                                                1000576
   584+        End-PR;                                                                                                     1000577
   585+                                                                                                                    1000578
   586+        Dcl-PR json_AsJsonText Like(UTF8)                                                                           1000579
   587+                             extproc(*CWIDEN : 'nox_AsJsonText');                                                   1000580
   588+          // node. Retrive from Locate()                                                                            1000581
   589+          pNode          Pointer    value;                                                                          1000582
   590+        End-PR;                                                                                                     1000583
   591+                                                                                                                    1000584
   592+        Dcl-PR json_AsJsonTextMem Uns(10)                                                                           1000585
   593+                                extproc(*CWIDEN : 'nox_AsJsonTextMem');                                             1000586
   594+          // node. Retrive from Locate()                                                                            1000587
   595+          pNode          Pointer    value;                                                                          1000588
   596+          // pointer to any memory buffer                                                                           1000589
   597+          pBuffer        Pointer    value;                                                                          1000590
   598+          // Max number of bytes in buffer %size()                                                                  1000591
   599+          maxSize        Uns(10)    value options(*nopass);                                                         1000592
   600+        End-PR;                                                                                                     1000593
   601+                                                                                                                    1000594
   602+        // **  XML  renderes ***                                                                                    1000595
   603+        Dcl-PR json_WriteXmlStmf  extproc(*CWIDEN : 'nox_WriteXmlStmf');                                            1000596
   604+          // node. Retrive from Locate()                                                                            1000597
   605+          pNode          Pointer    value;                                                                          1000598
   606+          // Name of output stream file                                                                             1000599
   607+          FileName       Like(UTF8) const options(*varsize);                                                        1000600
   608+          // Ccsid of output file                                                                                   1000601
   609+          Ccsid          Int(10)    value;                                                                          1000602
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     17
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   610+          Trim           Ind        value;                                                                          1000603
   611+          // Extra options                                                                                          1000604
   612+          Options        Like(UTF8) const options(*nopass:*varsize);                                                1000605
   613+        End-PR;                                                                                                     1000606
   614+                                                                                                                    1000607
   615+        Dcl-PR json_AsXmlText Like(UTF8) extproc(*CWIDEN : 'nox_AsXmlText');                                        1000608
   616+          // node. Retrive from Locate()                                                                            1000609
   617+          pNode          Pointer    value;                                                                          1000610
   618+        End-PR;                                                                                                     1000611
   619+                                                                                                                    1000612
   620+        Dcl-PR json_AsXmlTextMem Uns(10) extproc(*CWIDEN : 'nox_AsXmlTextMem');                                     1000613
   621+          // node. Retrive from Locate()                                                                            1000614
   622+          pNode          Pointer    value;                                                                          1000615
   623+          // pointer to any memory buffer                                                                           1000616
   624+          pBuffer        Pointer    value;                                                                          1000617
   625+        End-PR;                                                                                                     1000618
   626+                                                                                                                    1000619
   627+        // Return a streamer object to be used in own serialisers                                                   1000620
   628+        Dcl-PR json_Stream pointer extproc(*CWIDEN : 'nox_Stream');                                                 1000621
   629+          // node. Retrive from Locate()                                                                            1000622
   630+          pNode          Pointer    value;                                                                          1000623
   631+        End-PR;                                                                                                     1000624
   632+                                                                                                                    1000625
   633+        // **  CSV  renderes ***                                                                                    1000626
   634+        Dcl-PR json_WriteCsvStmf  extproc(*CWIDEN : 'nox_WriteCsvStmf');                                            1000627
   635+          // node. Retrive from Locate()                                                                            1000628
   636+          pNode          Pointer    value;                                                                          1000629
   637+          // Name of output stream file                                                                             1000630
   638+          FileName       Like(UTF8) const options(*varsize);                                                        1000631
   639+          // Ccsid of output file                                                                                   1000632
   640+          Ccsid          Int(10)    value;                                                                          1000633
   641+          // *ON=Remove inter blanks                                                                                1000634
   642+          Trim           Ind        value;                                                                          1000635
   643+          // Options: ';.' for separator and dec                                                                    1000636
   644+          Options        Like(UTF8) const options(*nopass:*varsize);                                                1000637
   645+        End-PR;                                                                                                     1000638
   646+                                                                                                                    1000639
   647+                                                                                                                    1000640
   648+        Dcl-DS json_DelimiterDS  based(prototype_only) qualified;                                                   1000641
   649+          Slash          Char(1) CCSID(*UTF8);                                                                      1000642
   650+          BackSlash      Char(1) CCSID(*UTF8);                                                                      1000643
   651+          Masterspace    Char(1) CCSID(*UTF8);                                                                      1000644
   652+          BraBeg         Char(1) CCSID(*UTF8);                                                                      1000645
   653+          BraEnd         Char(1) CCSID(*UTF8);                                                                      1000646
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     18
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   654+          Blank          Char(1) CCSID(*UTF8);                                                                      1000647
   655+          Dot            Char(1) CCSID(*UTF8);                                                                      1000648
   656+          CurBeg         Char(1) CCSID(*UTF8);                                                                      1000649
   657+          CurEnd         Char(1) CCSID(*UTF8);                                                                      1000650
   658+          Apos           Char(1) CCSID(*UTF8);                                                                      1000651
   659+          Quot           Char(1) CCSID(*UTF8);                                                                      1000652
   660+        End-DS;                                                                                                     1000653
   661+                                                                                                                    1000654
   662+        // Iterators: First use the set the use forEach                                                             1000655
   663+        Dcl-DS json_Iterator  based(prototype_only) qualified;                                                      1000656
   664+          root           Pointer;                                                                                   1000657
   665+          this           Pointer;                                                                                   1000658
   666+          isList         Ind;                                                                                       1000659
   667+          isFirst        Ind;                                                                                       1000660
   668+          isLast         Ind;                                                                                       1000661
   669+          isRecursive    Ind;                                                                                       1000662
   670+          comma          Varchar(1);                                                                                1000663
   671+          count          Int(10);                                                                                   1000664
   672+          length         Int(10);                                                                                   1000665
   673+          size           Int(10);                                                                                   1000666
   674+          // Pointer to temp array of elms                                                                          1000667
   675+          listArr        Pointer;                                                                                   1000668
   676+          // Set  this to *ON to teminate loop                                                                      1000669
   677+          break          Ind;                                                                                       1000670
   678+          filler         Char(64);                                                                                  1000671
   679+        End-DS;                                                                                                     1000672
   680+                                                                                                                    1000673
   681+        Dcl-PR json_setIterator  likeds( json_Iterator)                                                             1000674
   682+                               extproc(*CWIDEN : 'nox_SetIterator');                                                1000675
   683+          // node. Retrive from Locate()                                                                            1000676
   684+          pNode          Pointer    value;                                                                          1000677
   685+          // Optional - path to node                                                                                1000678
   686+          path           Like(UTF8) const options(*nopass:*varsize);                                                1000679
   687+        End-PR;                                                                                                     1000680
   688+                                                                                                                    1000681
   689+        Dcl-PR json_setRecursiveIterator  likeds( json_Iterator)                                                    1000682
   690+                                        extproc(*CWIDEN :                                                           1000683
   691+                                        'nox_SetRecursiveIterator');                                                1000684
   692+          // node. Retrive from Locate()                                                                            1000685
   693+          pNode          Pointer    value;                                                                          1000686
   694+          // Optional - path to node                                                                                1000687
   695+          path           Like(UTF8) const options(*nopass:*varsize);                                                1000688
   696+        End-PR;                                                                                                     1000689
   697+                                                                                                                    1000690
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     19
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   698+        // Iterator Structure                                                                                       1000691
   699+        Dcl-PR json_forEach Ind extproc(*CWIDEN : 'nox_ForEach');                                                   1000692
   700+          iterator                  likeds( json_Iterator);                                                         1000693
   701+        End-PR;                                                                                                     1000694
   702+                                                                                                                    1000695
   703+        // For XML attributes                                                                                       1000696
   704+        Dcl-PR json_GetNodeAttrValue Like(UTF8)                                                                     1000697
   705+                                   extproc(*CWIDEN : 'nox_GetNodeAttrValueVC');                                     1000698
   706+          // Pointer to exsiting element                                                                            1000699
   707+          pNode          Pointer    value;                                                                          1000700
   708+          // Attribute Name                                                                                         1000701
   709+          AttrName       Like(UTF8) const options(*varsize);                                                        1000702
   710+          // If not found - default value                                                                           1000703
   711+          Defaultvalue   Like(UTF8) const options(*nopass:*varsize);                                                1000704
   712+        End-PR;                                                                                                     1000705
   713+                                                                                                                    1000706
   714+        Dcl-PR json_SetNodeAttrValue extproc(*CWIDEN : 'nox_SetNodeAttrValue');                                     1000707
   715+          // Pointer to exsiting element                                                                            1000708
   716+          pNode          Pointer    value;                                                                          1000709
   717+          // Attribute name                                                                                         1000710
   718+          AttrName       Like(UTF8) const options(*varsize);                                                        1000711
   719+          // New value                                                                                              1000712
   720+          Value          Like(UTF8) const options(*varsize);                                                        1000713
   721+        End-PR;                                                                                                     1000714
   722+                                                                                                                    1000715
   723+        Dcl-PR json_GetAttrValue Like(UTF8)                                                                         1000716
   724+                               extproc(*CWIDEN : 'nox_GetAttrValueVC');                                             1000717
   725+          // Pointer Attribute                                                                                      1000718
   726+          pAttr          Pointer    value;                                                                          1000719
   727+          // If not found - default value                                                                           1000720
   728+          Defaultvalue   Like(UTF8) const options(*nopass:*varsize);                                                1000721
   729+        End-PR;                                                                                                     1000722
   730+                                                                                                                    1000723
   731+        Dcl-PR json_SetAttrValue extproc(*CWIDEN : 'nox_SetAttrValue');                                             1000724
   732+          // Pointer Attribute                                                                                      1000725
   733+          pAttr          Pointer    value;                                                                          1000726
   734+          // New value                                                                                              1000727
   735+          AttrName       Like(UTF8) const options(*varsize);                                                        1000728
   736+          // Default value                                                                                          1000729
   737+          Value          Like(UTF8) const options(*varsize);                                                        1000730
   738+        End-PR;                                                                                                     1000731
   739+                                                                                                                    1000732
   740+        // Returns pointer to attribute list                                                                        1000733
   741+        Dcl-PR json_GetAttrFirst Pointer extproc(*CWIDEN : 'nox_GetAttrFirst');                                     1000734
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     20
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   742+          // Pointer to element                                                                                     1000735
   743+          pElem          Pointer    value;                                                                          1000736
   744+        End-PR;                                                                                                     1000737
   745+                                                                                                                    1000738
   746+        // Returns pointer to attribute list                                                                        1000739
   747+        Dcl-PR json_GetAttrNext Pointer extproc(*CWIDEN : 'nox_GetAttrNext');                                       1000740
   748+          // Pointer to attribute list                                                                              1000741
   749+          pAttr          Pointer    value;                                                                          1000742
   750+        End-PR;                                                                                                     1000743
   751+                                                                                                                    1000744
   752+        Dcl-PR json_GetAttrName Like(UTF8)                                                                          1000745
   753+                              extproc(*CWIDEN : 'nox_GetAttrNameVC');                                               1000746
   754+          // Pointer to attribute list                                                                              1000747
   755+          pAttr          Pointer    value;                                                                          1000748
   756+        End-PR;                                                                                                     1000749
   757+                                                                                                                    1000750
   758+      // Clear the contents of an array or object / delete all children                                             1000751
   759+        Dcl-PR json_Clear  extproc(*CWIDEN : 'nox_Clear');                                                          1000752
   760+          pNode          Pointer    value; // Pointer to tree node                                                  1000753
   761+        End-PR;                                                                                                     1000754
   762+                                                                                                                    1000755
   763+      // Close all nodes in this tree - also parent and siblings                                                    1000756
   764+        Dcl-PR json_Close  extproc(*CWIDEN : 'nox_Close');                                                          1000757
   765+          // Pointer to tree node                                                                                   1000758
   766+          pNode          Pointer  ;                                                                                 1000759
   767+        End-PR;                                                                                                     1000760
   768+      // Detect if you have a memry leak: call this when you have closed everything at i will return                1000761
 ...    false
   769+        Dcl-PR json_MemLeak Ind extproc(*CWIDEN : 'nox_MemLeak');                                                   1000762
   770+        End-PR;                                                                                                     1000763
   771+                                                                                                                    1000764
   772+      // Print memory report                                                                                        1000765
   773+        Dcl-PR json_MemStat  extproc(*CWIDEN : 'nox_MemStat');                                                      1000766
   774+        End-PR;                                                                                                     1000767
   775+                                                                                                                    1000768
   776+      // retune number of bytest used                                                                               1000769
   777+        Dcl-PR json_MemUse Uns(20) extproc(*CWIDEN : 'nox_MemUse');                                                 1000770
   778+        End-PR;                                                                                                     1000771
   779+                                                                                                                    1000772
   780+      // Return a memory segment pointer, and build a scope where JSON/XML will be created                          1000773
   781+        Dcl-PR json_SegmentSelectNo Pointer                                                                         1000774
   782+                                  extproc(*CWIDEN : 'nox_SegmentSelectNo');                                         1000775
   783+          SegmentIndex   Int(10)    value;                                                                          1000776
   784+        End-PR;                                                                                                     1000777
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     21
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   785+                                                                                                                    1000778
   786+      //  Delete the segment and all JSON/XML nodes build while segment scope was active                            1000779
   787+        Dcl-PR json_SegmentDispose  extproc(*CWIDEN : 'nox_SegmentDispose');                                        1000780
   788+          segmentPtr     Pointer    value;                                                                          1000781
   789+        End-PR;                                                                                                     1000782
   790+                                                                                                                    1000783
   791+      // Maintain at list of index numbers to database CLOB/BLOB fields since pointers can not be sh                1000784
 ...   ared in SQL
   792+        // Returns *ON if found                                                                                     1000785
   793+        Dcl-PR json_mapIx Ind extproc(*CWIDEN:'nox_MapIx' );                                                        1000786
   794+          // pointer to node pointer                                                                                1000787
   795+          ppNode         Pointer;                                                                                   1000788
   796+          // index of pointer                                                                                       1000789
   797+          Index          Uns(10)    value;                                                                          1000790
   798+        End-PR;                                                                                                     1000791
   799+                                                                                                                    1000792
   800+        // ------------------------------------------------------------------------                                 1000793
   801+        // SQL interface:                                                                                           1000794
   802+        // Note: When SQL functions returns *NULL, then use  the json_Message() to re                               1000795
   803+        // ------------------------------------------------------------------------                                 1000796
   804+                                                                                                                    1000797
   805+      // If options need - then it has to be first call made.                                                       1000798
   806+      // NOTE: If a pConnection pointer is provided, it will be updated with the conection                          1000799
   807+        Dcl-PR json_sqlSetOptions  extproc(*CWIDEN: 'nox_sqlSetOptions');                                           1000800
   808+          // json object with options ( see sample)                                                                 1000801
   809+          parms          Like(UTF8) const options(*nopass:*varsize);                                                1000802
   810+        End-PR;                                                                                                     1000803
   811+                                                                                                                    1000804
   812+      // returns a object node with one resulting row for the SQL statment                                          1000805
   813+        // Returns one SQL row as jx Obejct                                                                         1000806
   814+        Dcl-PR json_sqlResultRow Pointer extproc(*CWIDEN: 'nox_sqlResultRow');                                      1000807
   815+          // SQL statement to run                                                                                   1000808
   816+          sqlStmt        Like(UTF8) const options(*varsize);                                                        1000809
   817+          // json object template                                                                                   1000810
   818+          parms          Like(UTF8) const options(*nopass:*varsize);                                                1000811
   819+        End-PR;                                                                                                     1000812
   820+                                                                                                                    1000813
   821+      // returns an array (or object with array) of resulting rows for the SQL statment                             1000814
   822+        // Returns SQL rows as jx Obejct                                                                            1000815
   823+        Dcl-PR json_sqlResultSet Pointer extproc(*CWIDEN: 'nox_sqlResultSet');                                      1000816
   824+          // SQL statement to run                                                                                   1000817
   825+          sqlStmt        Like(UTF8) const options(*varsize);                                                        1000818
   826+          // From row; 1=First                                                                                      1000819
   827+          start          Int(10)    value options(*nopass);                                                         1000820
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     22
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   828+          // max number of rows; json_ALLROWS=all                                                                   1000821
   829+          limit          Int(10)    value options(*nopass);                                                         1000822
   830+          // resultset format:                                                                                      1000823
   831+          format         Int(10)    value options(*nopass);                                                         1000824
   832+          // json object template                                                                                   1000825
   833+          parms          Like(UTF8) const options(*nopass:*varsize);                                                1000826
   834+        End-PR;                                                                                                     1000827
   835+                                                                                                                    1000828
   836+                                                                                                                    1000829
   837+        Dcl-C json_ALLROWS const(-1);                                                                               1000830
   838+                                                                                                                    1000831
   839+        // Following constants used by json_sqlResultSet:format                                                     1000832
   840+        // + An array with each row as an object                                                                    1000833
   841+        Dcl-C json_ROWARRAY const(0);                                                                               1000834
   842+        // + Metaobject: rows, fields                                                                               1000835
   843+        Dcl-C json_META    const(1);                                                                                1000836
   844+        // + Columns info                                                                                           1000837
   845+        Dcl-C json_FIELDS  const(2);                                                                                1000838
   846+        // + Count all rows in the resultset                                                                        1000839
   847+        // ( Pricy so awoid it !! )                                                                                 1000840
   848+        Dcl-C json_TOTALROWS const(4);                                                                              1000841
   849+        // + Uppercase column names                                                                                 1000842
   850+        Dcl-C json_UPPERCASE const(8);                                                                              1000843
   851+                                                                                                                    1000844
   852+        // + Appoximate number of rows..                                                                            1000845
   853+        //  ( unpresise but cheap !! prefered  )                                                                    1000846
   854+        Dcl-C json_APPROXIMATE_TOTALROWS const(16);                                                                 1000847
   855+                                                                                                                    1000848
   856+                                                                                                                    1000849
   857+                                                                                                                    1000850
   858+      // SQL cursor processing                                                                                      1000851
   859+        // Returns handle to sql statement                                                                          1000852
   860+        Dcl-PR json_sqlOpen Pointer extproc(*CWIDEN:'nox_sqlOpenVC'  );                                             1000853
   861+          // SQL statement to run                                                                                   1000854
   862+          sqlStmt        Like(UTF8) const options(*varsize);                                                        1000855
   863+          // json object template                                                                                   1000856
   864+          parms          pointer value options(*nopass:*string);                                                    1000857
   865+        End-PR;                                                                                                     1000858
   866+                                                                                                                    1000859
   867+      // Fetch next from from that open sql handle, starting from rowNumer. 1=First row                             1000860
   868+        // Returns a row object (or *NULL if EOF)                                                                   1000861
   869+        Dcl-PR json_sqlFetchRelative Pointer                                                                        1000862
   870+                                   extproc(*CWIDEN: 'nox_sqlFetchRelative');                                        1000863
   871+          // sql statement handle ( from sqlOpen)                                                                   1000864
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     23
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   872+          pSqlHndl       Pointer    value;                                                                          1000865
   873+          // row from where to start 1=First                                                                        1000866
   874+          fromRow        Int(10)    value;                                                                          1000867
   875+        End-PR;                                                                                                     1000868
   876+                                                                                                                    1000869
   877+      // Fetch next from from that open sql handle                                                                  1000870
   878+        // Returns a row object (or *NULL if EOF)                                                                   1000871
   879+        Dcl-PR json_sqlFetchNext Pointer extproc(*CWIDEN:'nox_sqlFetchNext');                                       1000872
   880+          // sql statement handle ( from sqlOpen)                                                                   1000873
   881+          pSqlHndl       Pointer    value;                                                                          1000874
   882+        End-PR;                                                                                                     1000875
   883+                                                                                                                    1000876
   884+      // Number of columns in result set ( -1 if error)                                                             1000877
   885+        // Returns number of columns                                                                                1000878
   886+        Dcl-PR json_sqlColumns Int(10) extproc(*CWIDEN:'nox_sqlColumns');                                           1000879
   887+          // sql statement handle ( from sqlOpen)                                                                   1000880
   888+          pSqlHndl       Pointer    value;                                                                          1000881
   889+        End-PR;                                                                                                     1000882
   890+                                                                                                                    1000883
   891+      // Number of rows  in result set ( -1 if error)                                                               1000884
   892+      // Note: This will run a hidden "select count(*)" which might be a little pricy                               1000885
   893+        // Returns number of rows                                                                                   1000886
   894+        Dcl-PR json_sqlRows Int(10) extproc(*CWIDEN:'nox_sqlRows');                                                 1000887
   895+          // sql statement handle ( from sqlOpen)                                                                   1000888
   896+          pSqlHndl       Pointer    value;                                                                          1000889
   897+        End-PR;                                                                                                     1000890
   898+                                                                                                                    1000891
   899+      // Always colse the cursor after use, to release resources                                                    1000892
   900+        Dcl-PR json_sqlClose  extproc(*CWIDEN:'nox_sqlClose');                                                      1000893
   901+          // sql statement handle ( from sqlOpen)                                                                   1000894
   902+          pSqlHndl       Pointer;                                                                                   1000895
   903+        End-PR;                                                                                                     1000896
   904+                                                                                                                    1000897
   905+      // Execute any SQL statement not involving a cursor                                                           1000898
   906+        // Returns *ON if error                                                                                     1000899
   907+        Dcl-PR json_sqlExec Ind extproc(*CWIDEN:'nox_sqlExec'  );                                                   1000900
   908+          // SQL statement to run (template)                                                                        1000901
   909+          sqlStmt        Like(UTF8) const options(*varsize);                                                        1000902
   910+          // json object template data                                                                              1000903
   911+          parms          Like(UTF8) const options(*nopass:*varsize);                                                1000904
   912+        End-PR;                                                                                                     1000905
   913+                                                                                                                    1000906
   914+      // Execute an update table where the row is defined as a json object                                          1000907
   915+        // Returns *ON if error                                                                                     1000908
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     24
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   916+        Dcl-PR json_sqlUpdate Ind extproc(*CWIDEN:'nox_sqlUpdate');                                                 1000909
   917+          // table name                                                                                             1000910
   918+          table          Like(UTF8) const options(*varsize);                                                        1000911
   919+          // json object: æa:123,b:"value"å                                                                         1000912
   920+          row            Like(UTF8) const options(*varsize);                                                        1000913
   921+          // where clause : 'where myKey=Åkey'                                                                      1000914
   922+          where          Like(UTF8) const options(*nopass:*varsize);                                                1000915
   923+          // where parameters: æ key:777å                                                                           1000916
   924+          whereParms     Like(UTF8) const options(*nopass:*varsize);                                                1000917
   925+        End-PR;                                                                                                     1000918
   926+                                                                                                                    1000919
   927+        // Returns *ON if error                                                                                     1000920
   928+        Dcl-PR json_sqlInsert Ind extproc(*CWIDEN:'nox_sqlInsert');                                                 1000921
   929+          // table name                                                                                             1000922
   930+          table          Like(UTF8) const options(*varsize);                                                        1000923
   931+          // json object: æa:123,b:"value"å                                                                         1000924
   932+          row            Like(UTF8) const options(*varsize);                                                        1000925
   933+          // extra parms                                                                                            1000926
   934+          parms          Like(UTF8) const options(*nopass:*varsize);                                                1000927
   935+        End-PR;                                                                                                     1000928
   936+                                                                                                                    1000929
   937+        // Returns *ON if error                                                                                     1000930
   938+        Dcl-PR json_sqlUpsert Ind extproc(*CWIDEN:'nox_sqlUpsert');                                                 1000931
   939+          // table name                                                                                             1000932
   940+          table          Like(UTF8) const options(*varsize);                                                        1000933
   941+          // json object: æa:123,b:"value"å                                                                         1000934
   942+          row            Like(UTF8) const options(*varsize);                                                        1000935
   943+          // where clause : 'where myKey=Åkey'                                                                      1000936
   944+          where          Like(UTF8) const options(*nopass:*varsize);                                                1000937
   945+          // where parameters: æ key:777å                                                                           1000938
   946+          whereParms     Like(UTF8) const options(*nopass:*varsize);                                                1000939
   947+        End-PR;                                                                                                     1000940
   948+                                                                                                                    1000941
   949+        // Returns id of last insert                                                                                1000942
   950+        Dcl-PR json_sqlGetInsertId Int(10) extproc(*CWIDEN:'nox_sqlGetInsertId');                                   1000943
   951+        End-PR;                                                                                                     1000944
   952+                                                                                                                    1000945
   953+        // Returns array of column info                                                                             1000946
   954+        Dcl-PR json_sqlGetMeta Pointer extproc(*CWIDEN:'nox_sqlGetMeta');                                           1000947
   955+          sqlstmt        Like(UTF8) const options(*varsize);                                                        1000948
   956+        End-PR;                                                                                                     1000949
   957+                                                                                                                    1000950
   958+      // Return pointer to database connection. No options => will be default local database                        1000951
   959+        Dcl-PR json_sqlConnect Pointer extproc(*CWIDEN: 'nox_sqlConnect');                                          1000952
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     25
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
   960+          // json object or string with options                                                                     1000953
   961+          parms          Like(UTF8) const options(*nopass:*varsize);                                                1000954
   962+        End-PR;                                                                                                     1000955
   963+                                                                                                                    1000956
   964+      // Return pointer to database connection. No options => will be default local database                        1000957
   965+        Dcl-PR json_sqlDisconnect  extproc(*CWIDEN: 'nox_sqlDisconnect');                                           1000958
   966+        End-PR;                                                                                                     1000959
   967+                                                                                                                    1000960
   968+      // Return sql code for previous statement                                                                     1000961
   969+        Dcl-PR json_sqlCode Int(10) extproc(*CWIDEN: 'nox_sqlCode');                                                1000962
   970+        End-PR;                                                                                                     1000963
   971+                                                                                                                    1000964
   972+      // Returns a JSON object from a REST call                                                                     1000965
   973+        Dcl-PR json_httpRequest Pointer extproc(*CWIDEN:'nox_httpRequest');                                         1000966
   974+          // Full URL to the resource                                                                               1000967
   975+          url            Like(UTF8) const options(*varsize);                                                        1000968
   976+          // json object or string                                                                                  1000969
   977+          pReqNode       Like(UTF8) const options(*nopass:*varsize);                                                1000970
   978+          // extra CURL options                                                                                     1000971
   979+          options        Like(UTF8) const options(*nopass:*varsize);                                                1000972
   980+        End-PR;                                                                                                     1000973
   981+                                                                                                                    1000974
   982+      // when the dataarea SQLTRACE is set, your SQL statements                                                     1000975
   983+      // are logged into SQLTRACE table.                                                                            1000976
   984+      // you can supply an extr eye-catch wariable :trcid                                                           1000977
   985+        Dcl-PR json_traceSetId  extproc(*CWIDEN : 'nox_traceSetId');                                                1000978
   986+          traceId        Int(20)    value; // Ccsid of inpur file                                                   1000979
   987+        End-PR;                                                                                                     1000980
   988+                                                                                                                    1000981
   989+                                                                                                                    1000982
   990+                                                                                                                    1000983
   991+                                                                                                                    1000984
   992+                                                                                                                    1000985
   993+                                                                                                                    1000986
   994+                                                                                                                    1000987
   995                                                                                                                      000009
   996                                                                                                                      000010
   997       Dcl-S pRow         Pointer;                                                                                    000011
   998       Dcl-S sqlHnd       Pointer;                                                                                    000012
   999                                                                                                                      000013
  1000       Dcl-S ints         Int(10);                                                                                    000014
  1001       Dcl-S numbers      Zoned(11:2);                                                                                000015
  1002       Dcl-S text         Varchar(512);                                                                               000016
  1003       Dcl-S dates        Date;                                                                                       000017
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     26
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1004                                                                                                                      000018
  1005       Dcl-S Result       Varchar(50);                                                                                000019
  1006                                                                                                                      000020
  1007       //------------------------------------------------------------- *                                              000021
  1008                                                                                                                      000022
  1009       Dcl-Pi JSONSQL1;                                                                                               000023
  1010          pResult Char(50);                                                                                           000024
  1011       End-Pi;                                                                                                        000025
  1012                                                                                                                      000026
  1013       Result = '';                                                                                                   000027
  1014                                                                                                                      000028
  1015       // Connection can be made implecit or explicit                                                                 000029
  1016       // json_sqlconnect();                                                                                          000030
  1017                                                                                                                      000031
  1018       // Open our SQL cursor. Use a simple select                                                                    000032
  1019       sqlhnd  = json_sqlOpen(                                                                                        000033
  1020          'Select * from product ' +                                                                                  000034
  1021          'where PRODID like ''Coolpix%'' ' +                                                                         000035
  1022          'fetch first 5 rows only'                                                                                   000036
  1023       );                                                                                                             000037
  1024                                                                                                                      000038
  1025       // Was there a problem ?                                                                                       000039
  1026       if json_Error(sqlhnd);                                                                         B01             000040
  1027          pResult = json_message(sqlhnd);                                                              01             000041
  1028          json_sqlDisconnect();                                                                        01             000042
  1029          return;  // You can return, however the rest of the routines a roubust enough to just conti  01             000043
 ...   nue
  1030       endif;                                                                                         E01             000044
  1031                                                                                                                      000045
  1032       // Now iterate on each row in the resultset                                                                    000046
  1033       pRow = json_sqlFetchNext(sqlhnd);                                                                              000047
  1034       dow (pRow <> *NULL);                                                                           B01             000048
  1035          ints    = json_getNum (pRow : 'PRODKEY');                                                    01             000049
  1036          numbers = json_getNum (pRow : 'PRICE');                                                      01             000050
  1037                                                                                                                      000051
  1038          text    = json_getStr (pRow : 'DESC');                                                       01             000052
  1039          // TODO !! json_getDate                                                                                     000053
  1040          // dates   = %date(json_getStr (pRow : 'STOCKDATE'));                                                       000054
  1041                                                                                                                      000055
  1042          Result += %Char(ints) + ',' + %Char(numbers) + '-';                                          01             000056
  1043                                                                                                                      000057
  1044          json_delete(pRow); // Always dispose it before get the next                                  01             000058
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     27
Line   <---------------------- Source Specifications ----------------------------------------------------->  Do  Change Src Seq
Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10  Num Date   Id  Number
  1045          pRow = json_sqlFetchNext(sqlhnd);                                                            01             000059
  1046       enddo;                                                                                         E01             000060
  1047                                                                                                                      000061
  1048       pResult = Result;                                                                                              000062
  1049                                                                                                                      000063
  1050       // Finaly and always !! close the SQL cursor and dispose the json row object                                   000064
  1051       json_sqlClose(sqlhnd);                                                                                         000065
  1052                                                                                                                      000066
  1053       // You can leave the connection on for succesive requests                                                      000067
  1054       // json_sqlDisconnect();                                                                                       000068
  1055                                                                                                                      000069
  1056       // That's it..                                                                                                 000070
  1057       *inlr = *on;                                                                                                   000071
  1058                                                                                                                      000072
  1059                                                                                                                      000073
       * * * * *   E N D   O F   S O U R C E   * * * * *
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     28
          A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
 Msg id  Sv Number Seq     Message text
 * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                            / C o p y   M e m b e r s
Line   Src  RPG name   <-------- External name -------> CCSID  <- Last change ->
Number Id              Library    File       Member            Date     Time
     8    1 JSONPARSE+ ./headers/JSONPARSER.rpgle        1208  26-11-18 17:12:21
         * * * * *   E N D   O F   / C O P Y   M E M B E R S   * * * * *
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     29
                          C r o s s   R e f e r e n c e
      File and Record References:
         File              Device             References (D=Defined)
           Record
         No references in the source.
      Global Field References:
         Field             Attributes         References (D=Defined M=Modified)
         *INLR             N(1)                 1057M
*RNF7031 DATES             D(10*ISO-)           1003D
         INTS              I(10,0)              1000D   1035M   1042
*RNF7031 JSON_AFTER_SIBLING...
                           CONST                 396D
*RNF7031 JSON_ALLOW_PRIMITIVES...
                           CONST                  51D
*RNF7031 JSON_ALLROWS      CONST                 837D
*RNF7031 JSON_APPROXIMATE_TOTALROWS...
                           CONST                 854D
*RNF7031 JSON_ARRAY        CONST                  34D
*RNF7031 JSON_ARRAYAPPEND  *(16)                 474D
                           PROTOTYPE
*RNF7031 JSON_ARRAYPUSH    *(16)                 460D
                           PROTOTYPE
*RNF7031 JSON_ARRAYSLICE   *(16)                 484D
                           PROTOTYPE
*RNF7031 JSON_ARRAYSORT    *(16)                 496D
                           PROTOTYPE
*RNF7031 JSON_ASJSONTEXT   A(1048572)            586D
                           VARYING(4)
                           CCSID(1208)
                           PROTOTYPE
*RNF7031 JSON_ASJSONTEXTMEM...
                           U(10,0)               592D
                           PROTOTYPE
*RNF7031 JSON_ASXMLTEXT    A(1048572)            615D
                           VARYING(4)
                           CCSID(1208)
                           PROTOTYPE
*RNF7031 JSON_ASXMLTEXTMEM U(10,0)               620D
                           PROTOTYPE
*RNF7031 JSON_BEFORE_SIBLING...
                           CONST                 395D
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     30
*RNF7031 JSON_BY_CONTEXT   CONST                  43D
*RNF7031 JSON_CHILD_LIST   CONST                  71D
*RNF7031 JSON_CLEAR        PROTOTYPE             759D
*RNF7031 JSON_CLONEFORMAT  PROTOTYPE             566D
*RNF7031 JSON_CLOSE        PROTOTYPE             764D
*RNF7031 JSON_COPY_CLONE   CONST                 471D
*RNF7031 JSON_COPYVALUE    *(16)                 372D
                           PROTOTYPE
         JSON_DELETE       PROTOTYPE             423D   1044M
*RNF7031 JSON_DELIMITERDS  DS(11)                648D
                           BASED(PROTOTYPE+)
*RNF7031   APOS            A(1)                  658D
                           CCSID(1208)
*RNF7031   BACKSLASH       A(1)                  650D
                           CCSID(1208)
*RNF7031   BLANK           A(1)                  654D
                           CCSID(1208)
*RNF7031   BRABEG          A(1)                  652D
                           CCSID(1208)
*RNF7031   BRAEND          A(1)                  653D
                           CCSID(1208)
*RNF7031   CURBEG          A(1)                  656D
                           CCSID(1208)
*RNF7031   CUREND          A(1)                  657D
                           CCSID(1208)
*RNF7031   DOT             A(1)                  655D
                           CCSID(1208)
*RNF7031   MASTERSPACE     A(1)                  651D
                           CCSID(1208)
*RNF7031   QUOT            A(1)                  659D
                           CCSID(1208)
*RNF7031   SLASH           A(1)                  649D
                           CCSID(1208)
*RNF7031 JSON_DONTREPLACE  CONST                 538D
*RNF7031 JSON_DUMP         PROTOTYPE             560D
         JSON_ERROR        N(1)                   93D   1026
                           PROTOTYPE
*RNF7031 JSON_EVAL         CONST                  35D
*RNF7031 JSON_FIELDS       CONST                 845D
*RNF7031 JSON_FIRST_CHILD  CONST                 393D
*RNF7031 JSON_FOREACH      N(1)                  699D
                           PROTOTYPE
*RNF7031 JSON_GETATTRFIRST *(16)                 741D
                           PROTOTYPE
*RNF7031 JSON_GETATTRNAME  A(1048572)            752D
                           VARYING(4)
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     31
                           CCSID(1208)
                           PROTOTYPE
*RNF7031 JSON_GETATTRNEXT  *(16)                 747D
                           PROTOTYPE
*RNF7031 JSON_GETATTRVALUE A(1048572)            723D
                           VARYING(4)
                           CCSID(1208)
                           PROTOTYPE
*RNF7031 JSON_GETCHILD     *(16)                 184D
                           PROTOTYPE
*RNF7031 JSON_GETILOBVALUE N(1)                  363D
                           PROTOTYPE
*RNF7031 JSON_GETINT       I(20,0)               352D
                           PROTOTYPE
*RNF7031 JSON_GETLENGTH    I(10,0)               522D
                           PROTOTYPE
*RNF7031 JSON_GETMESSAGEOBJECT...
                           *(16)                 108D
                           PROTOTYPE
*RNF7031 JSON_GETNAME      A(1048572)            295D
                           VARYING(4)
                           CCSID(1208)
                           PROTOTYPE
*RNF7031 JSON_GETNAMEASPATH...
                           A(1048572)            301D
                           VARYING(4)
                           CCSID(1208)
                           PROTOTYPE
*RNF7031 JSON_GETNEXT      *(16)                 178D
                           PROTOTYPE
*RNF7031 JSON_GETNODEATTRVALUE...
                           A(1048572)            704D
                           VARYING(4)
                           CCSID(1208)
                           PROTOTYPE
         JSON_GETNUM       P(30,15)              343D   1035    1036
                           PROTOTYPE
*RNF7031 JSON_GETPARENT    *(16)                 190D
                           PROTOTYPE
         JSON_GETSTR       A(1048572)            319D   1038
                           VARYING(4)
                           CCSID(1208)
                           PROTOTYPE
*RNF7031 JSON_GETSTRJOIN   A(1048572)            329D
                           VARYING(4)
                           CCSID(1208)
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     32
                           PROTOTYPE
*RNF7031 JSON_GETVALUEINT  I(20,0)               282D
                           PROTOTYPE
*RNF7031 JSON_GETVALUENUM  P(30,15)              274D
                           PROTOTYPE
*RNF7031 JSON_GETVALUEPTR  *(16)                 288D
                           PROTOTYPE
*RNF7031 JSON_GETVALUESTR  A(1048572)            266D
                           VARYING(4)
                           CCSID(1208)
                           PROTOTYPE
*RNF7031 JSON_HAS          N(1)                  140D
                           PROTOTYPE
*RNF7031 JSON_HTTPREQUEST  *(16)                 973D
                           PROTOTYPE
*RNF7031 JSON_IGNORE_CASE  CONST                 519D
*RNF7031 JSON_ISNODE       N(1)                  164D
                           PROTOTYPE
*RNF7031 JSON_ISNULL       N(1)                  156D
                           PROTOTYPE
*RNF7031 JSON_ISTRUE       N(1)                  148D
                           PROTOTYPE
         JSON_ITERATOR     DS(145)               663D    681     689     700
                           BASED(PROTOTYPE+)
*RNF7031   BREAK           N(1)                  677D
*RNF7031   COMMA           A(1)                  670D
                           VARYING(2)
*RNF7031   COUNT           I(10,0)               671D
*RNF7031   FILLER          A(64)                 678D
*RNF7031   ISFIRST         N(1)                  667D
*RNF7031   ISLAST          N(1)                  668D
*RNF7031   ISLIST          N(1)                  666D
*RNF7031   ISRECURSIVE     N(1)                  669D
*RNF7031   LENGTH          I(10,0)               672D
*RNF7031   LISTARR         *(16)                 675D
*RNF7031   ROOT            *(16)                 664D
*RNF7031   SIZE            I(10,0)               673D
*RNF7031   THIS            *(16)                 665D
*RNF7031 JSON_LAST_CHILD   CONST                 394D
*RNF7031 JSON_LITERAL      CONST                  39D
*RNF7031 JSON_LOCATE       *(16)                 123D
                           PROTOTYPE
*RNF7031 JSON_LOCATEORCREATE...
                           *(16)                 131D
                           PROTOTYPE
*RNF7031 JSON_LOOKUPVALUE  *(16)                 508D
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     33
                           PROTOTYPE
*RNF7031 JSON_MAPIX        N(1)                  793D
                           PROTOTYPE
*RNF7031 JSON_MEMLEAK      N(1)                  769D
                           PROTOTYPE
*RNF7031 JSON_MEMSTAT      PROTOTYPE             773D
*RNF7031 JSON_MEMUSE       U(20,0)               777D
                           PROTOTYPE
*RNF7031 JSON_MERGE        *(16)                 528D
                           PROTOTYPE
*RNF7031 JSON_MERGEOBJECTS *(16)                 542D
                           PROTOTYPE
         JSON_MESSAGE      A(1024)               100D   1027
                           VARYING(2)
                           PROTOTYPE
*RNF7031 JSON_META         CONST                 843D
*RNF7031 JSON_MOVE_NODES   CONST                  49D
*RNF7031 JSON_MOVE_UNLINK  CONST                 470D
*RNF7031 JSON_MOVEOBJECTINTO...
                           *(16)                 552D
                           PROTOTYPE
*RNF7031 JSON_NEWARRAY     *(16)                 454D
                           PROTOTYPE
*RNF7031 JSON_NEWOBJECT    *(16)                 447D
                           PROTOTYPE
*RNF7031 JSON_NODEADD      *(16)                 404D
                           PROTOTYPE
*RNF7031 JSON_NODECHECKSUM U(10,0)               442D
                           PROTOTYPE
*RNF7031 JSON_NODECLONE    *(16)                 398D
                           PROTOTYPE
*RNF7031 JSON_NODECOPY     PROTOTYPE             383D
*RNF7031 JSON_NODEDELETE   PROTOTYPE             417D
*RNF7031 JSON_NODERENAME   N(1)                  170D
                           PROTOTYPE
*RNF7031 JSON_NODESANITIZE PROTOTYPE             435D
*RNF7031 JSON_NODETYPE     I(5,0)                310D
                           PROTOTYPE
*RNF7031 JSON_NODEUNLINK   *(16)                 430D
                           PROTOTYPE
*RNF7031 JSON_OBJCOPY      CONST                  42D
*RNF7031 JSON_OBJECT       CONST                  33D
*RNF7031 JSON_OBJLINK      CONST                  40D
*RNF7031 JSON_OBJMOVE      CONST                  44D
*RNF7031 JSON_OBJREPLACE   CONST                  41D
*RNF7031 JSON_PARSE        CONST                  55D
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     34
*RNF7031 JSON_PARSEFILE    *(16)                  75D
                           PROTOTYPE
*RNF7031 JSON_PARSESTRINGVC...
                           *(16)                  81D
                           PROTOTYPE
*RNF7031 JSON_POINTER_VALUE...
                           CONST                  36D
*RNF7031 JSON_REPLACE      CONST                 539D
*RNF7031 JSON_ROOT         CONST                  38D
*RNF7031 JSON_ROWARRAY     CONST                 841D
*RNF7031 JSON_SAME_CASE    CONST                 518D
*RNF7031 JSON_SEGMENTDISPOSE...
                           PROTOTYPE             787D
*RNF7031 JSON_SEGMENTSELECTNO...
                           *(16)                 781D
                           PROTOTYPE
*RNF7031 JSON_SETATTRVALUE PROTOTYPE             731D
*RNF7031 JSON_SETBOOL      *(16)                 228D
                           PROTOTYPE
*RNF7031 JSON_SETDECPOINT  PROTOTYPE              87D
*RNF7031 JSON_SETEVAL      *(16)                 195D
                           PROTOTYPE
*RNF7031 JSON_SETINT       *(16)                 210D
                           PROTOTYPE
*RNF7031 JSON_SETITERATOR  DS(145)               681D
                           PROTOTYPE
*RNF7031 JSON_SETNODEATTRVALUE...
                           PROTOTYPE             714D
*RNF7031 JSON_SETNUM       *(16)                 219D
                           PROTOTYPE
*RNF7031 JSON_SETPROCPTR   *(16)                 246D
                           PROTOTYPE
*RNF7031 JSON_SETPTR       *(16)                 237D
                           PROTOTYPE
*RNF7031 JSON_SETRECURSIVEITERATOR...
                           DS(145)               689D
                           PROTOTYPE
*RNF7031 JSON_SETSTR       *(16)                 201D
                           PROTOTYPE
*RNF7031 JSON_SETVALUE     *(16)                 255D
                           PROTOTYPE
         JSON_SQLCLOSE     PROTOTYPE             900D   1051M
*RNF7031 JSON_SQLCODE      I(10,0)               969D
                           PROTOTYPE
*RNF7031 JSON_SQLCOLUMNS   I(10,0)               886D
                           PROTOTYPE
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     35
*RNF7031 JSON_SQLCONNECT   *(16)                 959D
                           PROTOTYPE
         JSON_SQLDISCONNECT...
                           PROTOTYPE             965D   1028M
*RNF7031 JSON_SQLEXEC      N(1)                  907D
                           PROTOTYPE
         JSON_SQLFETCHNEXT *(16)                 879D   1033    1045
                           PROTOTYPE
*RNF7031 JSON_SQLFETCHRELATIVE...
                           *(16)                 869D
                           PROTOTYPE
*RNF7031 JSON_SQLGETINSERTID...
                           I(10,0)               950D
                           PROTOTYPE
*RNF7031 JSON_SQLGETMETA   *(16)                 954D
                           PROTOTYPE
*RNF7031 JSON_SQLINSERT    N(1)                  928D
                           PROTOTYPE
         JSON_SQLOPEN      *(16)                 860D   1019
                           PROTOTYPE
*RNF7031 JSON_SQLRESULTROW *(16)                 814D
                           PROTOTYPE
*RNF7031 JSON_SQLRESULTSET *(16)                 823D
                           PROTOTYPE
*RNF7031 JSON_SQLROWS      I(10,0)               894D
                           PROTOTYPE
*RNF7031 JSON_SQLSETOPTIONS...
                           PROTOTYPE             807D
*RNF7031 JSON_SQLUPDATE    N(1)                  916D
                           PROTOTYPE
*RNF7031 JSON_SQLUPSERT    N(1)                  938D
                           PROTOTYPE
*RNF7031 JSON_STREAM       *(16)                 628D
                           PROTOTYPE
*RNF7031 JSON_SUCCESSTRUE  *(16)                 116D
                           PROTOTYPE
*RNF7031 JSON_TOTALROWS    CONST                 848D
*RNF7031 JSON_TRACESETID   PROTOTYPE             985D
*RNF7031 JSON_UNKNOWN      CONST                  32D
*RNF7031 JSON_UPPERCASE    CONST                 850D
*RNF7031 JSON_USE_LOCALE   CONST                 505D
*RNF7031 JSON_VALUE        CONST                  37D
*RNF7031 JSON_WRITECSVSTMF PROTOTYPE             634D
*RNF7031 JSON_WRITEJSONSTMF...
                           PROTOTYPE             574D
*RNF7031 JSON_WRITEXMLSTMF PROTOTYPE             603D
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     36
*RNF7031 MO_MERGE_MATCH    CONST                  65D
*RNF7031 MO_MERGE_NEW      CONST                  63D
*RNF7031 MO_MERGE_REPLACE  CONST                  68D
         NUMBERS           S(11,2)              1001D   1036M   1042
         PRESULT           A(50)                1010D   1027M   1048M
                           BASED(_QRNL_PRM+)
         PROTOTYPE_ONLY    *(16)                 648     663
         PROW              *(16)                 997D   1033M   1034    1035
                                                1036    1038    1044    1045M
         RESULT            A(50)                1005D   1013M   1042M   1048
                           VARYING(2)
         SQLHND            *(16)                 998D   1019M   1026    1027
                                                1033    1045    1051
         TEXT              A(512)               1002D   1038M
                           VARYING(2)
         UTF8              A(1048572)             27D     83      89     110
                           VARYING(4)            111     117     118     127
                           CCSID(1208)           136     144     152     160
                           TEMPLATE              174     197     198     205
                                                 207     214     223     232
                                                 241     249     259     261
                                                 266     271     292     295
                                                 301     319     323     325
                                                 329     334     336     347
                                                 356     369     376     380
                                                 410     412     464     478
                                                 486     500     512     555
                                                 570     578     583     586
                                                 607     612     615     638
                                                 644     686     695     704
                                                 709     711     718     720
                                                 723     728     735     737
                                                 752     809     816     818
                                                 825     833     862     909
                                                 911     918     920     922
                                                 924     930     932     934
                                                 940     942     944     946
                                                 955     961     975     977
                                                 979
      Indicator References:
         Indicator                            References (D=Defined M=Modified)
         LR                                     1057M
       * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     37
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     38
                      E x t e r n a l   R e f e r e n c e s
      Statically bound procedures:
         Procedure                            References
         nox_Has                                 140
         nox_Dump                                560
         JSONSQL1                               1009
         nox_Error                                93    1026
         nox_Clear                               759
         nox_Close                               764
         nox_MapIx                               793
         nox_IsTrue                              148
         nox_IsNull                              156
         nox_isNode                              164
         nox_Stream                              628
         nox_MemUse                              777
         nox_NodeAdd                             404
         nox_ForEach                             699
         nox_MemLeak                             769
         nox_MemStat                             773
         nox_sqlRows                             894
         nox_sqlExec                             907
         nox_sqlCode                             969
         nox_NodeCopy                            383
         nox_NewArray                            454
         nox_sqlClose                            900    1051
         nox_ParseFile                            75
         nox_MessageVC                           100    1027
         nox_GetNodeVC                           123
         nox_CopyValue                           372
         nox_NodeClone                           398
         nox_NewObject                           447
         nox_ArrayPush                           460
         nox_ArraySort                           496
         nox_getLength                           522
         nox_NodeMerge                           528
         nox_AsXmlText                           615
         nox_sqlOpenVC                           860    1023
         nox_sqlUpdate                           916
         nox_sqlInsert                           928
         nox_sqlUpsert                           938
         nox_NodeRename                          170
         nox_GetValueVC                          319    1038
         nox_NodeDelete                          417     423    1044
         nox_NodeUnlink                          430
         nox_ArraySlice                          484
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     39
         nox_AsJsonText                          587
         nox_sqlColumns                          886
         nox_sqlGetMeta                          954
         nox_sqlConnect                          959
         nox_traceSetId                          985
         nox_SetDecPoint                          87
         nox_SuccessTrue                         116
         nox_GetNodeNext                         178
         nox_GetNodeType                         310
         nox_ArrayAppend                         474
         nox_lookupValue                         508
         nox_CloneFormat                         566
         nox_SetIterator                         682
         nox_GetAttrNext                         747
         nox_httpRequest                         973
         nox_GetNodeChild                        184
         nox_SetStrByName                        201
         nox_SetIntByName                        210
         nox_SetDecByName                        219
         nox_SetPtrByName                        237     246
         nox_GetStrJoinVC                        330
         ILOB_XmlGetValue                        363
         nox_NodeSanitize                        435
         nox_NodeCheckSum                        442
         nox_MergeObjects                        542
         nox_NodeMoveInto                        552
         nox_WriteXmlStmf                        603
         nox_AsXmlTextMem                        620
         nox_WriteCsvStmf                        634
         nox_SetAttrValue                        731
         nox_GetAttrFirst                        741
         nox_sqlResultRow                        814
         nox_sqlResultSet                        823
         nox_sqlFetchNext                        879    1033    1045
         nox_ParseStringVC                        81
         nox_GetNodeParent                       190
         nox_SetEvalByName                       195
         nox_SetBoolByName                       228
         nox_GetNodeNameVC                       296
         nox_GetValueNumVC                       343    1035    1036
         nox_GetValueIntVC                       352
         nox_WriteJsonStmf                       574
         nox_AsJsonTextMem                       593
         nox_GetAttrNameVC                       753
         nox_sqlSetOptions                       807
         nox_sqlDisconnect                       965    1028
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     40
         nox_SetValueByName                      255
         nox_GetNodeValueVC                      267
         nox_GetAttrValueVC                      724
         nox_SegmentDispose                      787
         nox_sqlGetInsertId                      950
         nox_GetOrCreateNode                     132
         nox_GetNodeValueNum                     275
         nox_GetNodeValueInt                     282
         nox_GetNodeValuePtr                     288
         nox_SegmentSelectNo                     782
         nox_GetMessageObject                    109
         nox_SetNodeAttrValue                    714
         nox_sqlFetchRelative                    870
         nox_GetNodeNameAsPath                   302
         nox_GetNodeAttrValueVC                  705
         nox_SetRecursiveIterator                691
      Imported fields:
         Field             Attributes         Defined
         No references in the source.
      Exported fields:
         Field             Attributes         Defined
         No references in the source.
   * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     41
                          M e s s a g e   S u m m a r y
 Msg id  Sv Number Message text
*RNF7031 00    161 The name or indicator is not referenced.
       * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
 5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB2/JSONSQL1          DKSRV133   26-11-18 17:26:20        Page     42
                            F i n a l   S u m m a r y
  Message Totals:
    Information  (00) . . . . . . . :      161
    Warning      (10) . . . . . . . :        0
    Error        (20) . . . . . . . :        0
    Severe Error (30+)  . . . . . . :        0
    ---------------------------------  -------
    Total . . . . . . . . . . . . . :      161
  Source Totals:
    Records . . . . . . . . . . . . :     1059
    Specifications  . . . . . . . . :      538
    Data records  . . . . . . . . . :        0
    Comments  . . . . . . . . . . . :      512
         * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
                 B i n d   D i a g n o s t i c   M e s s a g e s
Errors were found during the binding step. See the job log for more information.
 * * * * *   E N D   O F   B I N D   D I A G N O S T I C   M E S S A G E S    * * * * *
Program JSONSQL1 in library NOXDB2 not created.
          * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
makefile:90: recipe for target 'example' failed
