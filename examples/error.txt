  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     NLI
   Program  . . . . . . . . . . . . :   JSONSQL06A
     Library  . . . . . . . . . . . :     NOXDB
   Text 'description' . . . . . . . :   *SRCMBRTXT
   Source stream file   . . . . . . :   JSONSQL06A.RPGLE
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   23-10-18  01:56:26
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *UNREF     *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *USER
   Authority  . . . . . . . . . . . :   *LIBCRTAUT
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
                                    :   /prj/noxdb
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1                                                                                                                      000001
      2    //------------------------------------------------------------- *                                                 000002
      3                                                                                                                      000003
      4    Ctl-Opt BndDir('NOXDB') dftactgrp(*NO) ACTGRP('QILE' );                                                           000004
      5                                                                                                                      000005
      6    //------------------------------------------------------------- *                                                 000006
      7                                                                                                                      000007
      8    /include 'headers/JSONPARSER.rpgle'                                                                               000008
         *--------------------------------------------------------------------------------------------*
         * RPG member name  . . . . . :  JSONPARSE+                                                   *                     1
         * External name  . . . . . . :  ./../headers/JSONPARSER.rpgle                                *                     1
         * Last change  . . . . . . . :  23-10-18  02:00:05                                           *                     1
         *--------------------------------------------------------------------------------------------*
      9+   //---------------------------------------------------------------------- *                                       1000001
     10+   //This is the prototype for BlueSeries/IceBreak - JSON and XML parser                                            1000002
     11+   //Use the JSONXML binddir when creating your program and include this                                            1000003
     12+   //prototypes like:                                                                                               1000004
     13+                                                                                                                    1000005
     14+   //H BNDDIR('JSONPARSER')                                                                                         1000006
     15+   ///include jsonParser                                                                                            1000007
     16+                                                                                                                    1000008
     17+   //Or                                                                                                             1000009
     18+                                                                                                                    1000010
     19+   //H BNDDIR('XMLPARSER')                                                                                          1000011
     20+   ///include xmlParser                                                                                             1000012
     21+                                                                                                                    1000013
     22+   //Note: Both XMLPARSER and JSONPARSER headers are autogenerated from                                             1000014
     23+   //the JSONXML header. so please do not make any changes th there headerfi                                        1000015
     24+                                                                                                                    1000016
     25+   //Note: all binddirectories JSONPARSER, XMLPARSER and JSONXML is the same                                        1000017
     26+   //---------------------------------------------------------------------- *                                       1000018
     27+ /if defined( json_DEF)                                                                                             1000019
             LINES EXCLUDED: 1
     28+ /endif                                                                                                             1000021
     29+ /define  json_DEF                                                                                                  1000022
     30+   //---------------------------------------------------------------------- *                                       1000023
     31+   //Before starting that parser - to enshure right enterpretations of delimi                                       1000024
     32+   //Usage:                                                                                                         1000025
     33+   //jx_setDelimiters( json_DELIMITERS);                                                                            1000026
     34+   //--------------------------------------------------------------------- *                                        1000027
     35+   //get delimiter pointer                                                                                          1000028
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page      3
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *NOSRCSTMT        *
         *                                       *DEBUGIO   *UNREF            *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *USER                        *
         *  Authority  . . . . . . . . . . . :   *LIBCRTAUT                   *
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   NOXDB                        *
         *    Library  . . . . . . . . . . . :     *LIBL                      *
         *  Activation group . . . . . . . . :   QILE                         *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
         *--------------------------------------------------------------------*
     36+   Dcl-PR json_getDelimiters Pointer extproc(*CWIDEN :'jx_GetDelimiters');                                          1000029
     37+   End-PR;                                                                                                          1000030
     38+   //Set delimiter used for locate expression                                                                       1000031
     39+   Dcl-PR json_setDelimiters  extproc(*CWIDEN :'jx_SetDelimiters2');                                                1000032
     40+     //always: '/\Ø#¤ .æå' in your  local CCSID                                                                     1000033
     41+     delimiterStr   Pointer    value options(*string);                                                              1000034
     42+   End-PR;                                                                                                          1000035
     43+                                                                                                                    1000036
     44+   Dcl-C json_DELIMITERS const('/\Ø#¤ .æå''"');                                                                     1000037
     45+                                                                                                                    1000038
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page      4
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     46+   //---------------------------------------------------------------------- *                                       1000039
     47+   //Type of a node:                                                                                                1000040
     48+   //---------------------------------------------------------------------- *                                       1000041
     49+   Dcl-C json_UNKNOWN const(0);                                                                                     1000042
     50+   Dcl-C json_OBJECT  const(1);                                                                                     1000043
     51+   Dcl-C json_ARRAY   const(2);                                                                                     1000044
     52+   Dcl-C json_EVAL    const(3);                                                                                     1000045
     53+   Dcl-C json_POINTER_VALUE const(4);                                                                               1000046
     54+   Dcl-C json_VALUE   const(5);                                                                                     1000047
     55+   Dcl-C json_ROOT    const(6);                                                                                     1000048
     56+   Dcl-C json_LITERAL const(16);                                                                                    1000049
     57+   Dcl-C json_OBJLINK const(17);                                                                                    1000050
     58+   Dcl-C json_OBJREPLACE const(18);                                                                                 1000051
     59+   Dcl-C json_OBJCOPY const(18);                                                                                    1000052
     60+   Dcl-C json_BY_CONTEXT const(19);                                                                                 1000053
     61+   Dcl-C json_OBJMOVE const(2048);                                                                                  1000054
     62+                                                                                                                    1000055
     63+   //* Modifiers to "add" / "or" into "parseString" and "evaluate"                                                  1000056
     64+   //!! Type - have to be backwards compat.                                                                         1000057
     65+   //Unlink the source and move it to dest.                                                                         1000058
     66+   Dcl-C json_MOVE_MODES const(2048);                                                                               1000059
     67+   //Allow strings ints and other values to                                                                         1000060
     68+   Dcl-C json_ALLOW_PRIMITIVES const(4096);                                                                         1000061
     69+                                                                                                                    1000062
     70+   //* Combinations:                                                                                                1000063
     71+   //JX_PARSE  = json_EVAL + json_MOVE_NODES                                                                        1000064
     72+   Dcl-C json_PARSE   const(2051);                                                                                  1000065
     73+                                                                                                                    1000066
     74+   //Merge options:                                                                                                 1000067
     75+   //Modifiers to "add" / "or" into "JSON_EVAL"                                                                     1000068
     76+ /if not defined(MO_MERGE)                                                                                          1000069
     77+ /define  MO_MERGE                                                                                                  1000070
     78+   //Only new elements are merged - existing                                                                        1000071
     79+   //are left untouched                                                                                             1000072
     80+   Dcl-C MO_MERGE_NEW const(256);                                                                                   1000073
     81+   //Merge and replace only existing nodes.                                                                         1000074
     82+   Dcl-C MO_MERGE_MATCH const(512);                                                                                 1000075
     83+   //Merge all: replace if it exists and                                                                            1000076
     84+   //append new nodes if not exists                                                                                 1000077
     85+   Dcl-C MO_MERGE_REPLACE const(1024 );                                                                             1000078
     86+ /endif                                                                                                             1000079
     87+                                                                                                                    1000080
     88+   Dcl-C json_CHILD_LIST const('#0¤');                                                                              1000081
     89+                                                                                                                    1000082
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page      5
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     90+   //---------------------------------------------------------------------- *                                       1000083
     91+   //Returns node to the json_object tree                                                                           1000084
     92+   Dcl-PR json_ParseFile Pointer extproc(*CWIDEN:'jx_ParseFile');                                                   1000085
     93+     //File to parse                                                                                                1000086
     94+     FileName       Pointer    value options(*string);                                                              1000087
     95+     //Parsing options                                                                                              1000088
     96+     Options        Pointer    value options(*string:*nopass);                                                      1000089
     97+   End-PR;                                                                                                          1000090
     98+                                                                                                                    1000091
     99+   //Returns node json_object tree                                                                                  1000092
    100+   Dcl-PR json_ParseString Pointer extproc(*CWIDEN:'jx_ParseString');                                               1000093
    101+     //String to parse                                                                                              1000094
    102+     String         Pointer    value options(*string);                                                              1000095
    103+     //Parsing options                                                                                              1000096
    104+     Options        Pointer    value options(*string:*nopass);                                                      1000097
    105+   End-PR;                                                                                                          1000098
    106+                                                                                                                    1000099
    107+   //Set , or . for numeri decimal point                                                                            1000100
    108+   Dcl-PR json_setDecPoint  extproc(*CWIDEN : 'jx_SetDecPoint');                                                    1000101
    109+     //decimal point char                                                                                           1000102
    110+     decPoint       Pointer    value options(*string);                                                              1000103
    111+   End-PR;                                                                                                          1000104
    112+                                                                                                                    1000105
    113+                                                                                                                    1000106
    114+                                                                                                                    1000107
    115+   //Bool true if errors occures                                                                                    1000108
    116+   Dcl-PR json_Error Ind extproc(*CWIDEN:'jx_Error');                                                               1000109
    117+     //jx_Object  node                                                                                              1000110
    118+     pNode          Pointer    value;                                                                               1000111
    119+   End-PR;                                                                                                          1000112
    120+                                                                                                                    1000113
    121+   //Return error description                                                                                       1000114
    122+   Dcl-PR json_Message Varchar(1024) extproc(*CWIDEN:'jx_Message');                                                 1000115
    123+     //jx_Object                                                                                                    1000116
    124+     pNode          Pointer    value;                                                                               1000117
    125+   End-PR;                                                                                                          1000118
    126+                                                                                                                    1000119
    127+   //Returns pointer to node                                                                                        1000120
    128+   Dcl-PR json_Locate Pointer extproc(*CWIDEN : 'jx_GetNode');                                                      1000121
    129+     //Pointer to tree or node                                                                                      1000122
    130+     pNode          Pointer    value;                                                                               1000123
    131+     //location expression                                                                                          1000124
    132+     Expression     Pointer    value options(*string);                                                              1000125
    133+   End-PR;                                                                                                          1000126
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page      6
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    134+                                                                                                                    1000127
    135+   //Returns pointer to node                                                                                        1000128
    136+   Dcl-PR json_LocateOrCreate Pointer                                                                               1000129
    137+                            extproc(*CWIDEN : 'jx_GetOrCreateNode');                                                1000130
    138+     //Pointer to tree or node                                                                                      1000131
    139+     pNode          Pointer    value;                                                                               1000132
    140+     //location expression                                                                                          1000133
    141+     Expression     Pointer    value options(*string);                                                              1000134
    142+   End-PR;                                                                                                          1000135
    143+                                                                                                                    1000136
    144+   //Returns 'ON' if node exists                                                                                    1000137
    145+   Dcl-PR json_Has Ind extproc(*CWIDEN : 'jx_Has');                                                                 1000138
    146+     //Pointer to tree or node                                                                                      1000139
    147+     pNode          Pointer    value;                                                                               1000140
    148+     //Path to node                                                                                                 1000141
    149+     NodeName       Pointer    value options(*string);                                                              1000142
    150+   End-PR;                                                                                                          1000143
    151+                                                                                                                    1000144
    152+   //Returns 'ON' if node exists and has <> 0                                                                       1000145
    153+   Dcl-PR json_isTrue Ind extproc(*CWIDEN : 'jx_IsTrue');                                                           1000146
    154+     //Pointer to tree or node                                                                                      1000147
    155+     pNode          Pointer    value;                                                                               1000148
    156+     //Path to node                                                                                                 1000149
    157+     NodeName       Pointer    value options(*string);                                                              1000150
    158+   End-PR;                                                                                                          1000151
    159+                                                                                                                    1000152
    160+   //Returns 'ON' if node exists and has <> 0                                                                       1000153
    161+   Dcl-PR json_isNull Ind extproc(*CWIDEN : 'jx_IsNull');                                                           1000154
    162+     //Pointer to tree or node                                                                                      1000155
    163+     pNode          Pointer    value;                                                                               1000156
    164+     //Path to node                                                                                                 1000157
    165+     NodeName       Pointer    value options(*string);                                                              1000158
    166+   End-PR;                                                                                                          1000159
    167+                                                                                                                    1000160
    168+   //Returns 'ON' if it is a valid node                                                                             1000161
    169+   Dcl-PR json_isNode Ind extproc(*CWIDEN : 'jx_isNode');                                                           1000162
    170+     //a.k.a. false for strings                                                                                     1000163
    171+     pNode          Pointer    value;                                                                               1000164
    172+   End-PR;                                                                                                          1000165
    173+                                                                                                                    1000166
    174+   //renames the node name                                                                                          1000167
    175+   Dcl-PR json_NodeRename Ind extproc(*CWIDEN : 'jx_NodeRename');                                                   1000168
    176+     //Pointer to tree or node                                                                                      1000169
    177+     pNode          Pointer    value;                                                                               1000170
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page      7
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    178+     //Path to node                                                                                                 1000171
    179+     NodeName       Pointer    value options(*string);                                                              1000172
    180+   End-PR;                                                                                                          1000173
    181+                                                                                                                    1000174
    182+   //Returns pointer to next sibling (elem)                                                                         1000175
    183+   Dcl-PR json_GetNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                                 1000176
    184+     //Pointer to current node (elem)                                                                               1000177
    185+     pNode          Pointer    value;                                                                               1000178
    186+   End-PR;                                                                                                          1000179
    187+                                                                                                                    1000180
    188+   //Returns pointer to first child (elem)                                                                          1000181
    189+   Dcl-PR json_GetChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                                               1000182
    190+     //Pointer to current node (elem)                                                                               1000183
    191+     pNode          Pointer    value;                                                                               1000184
    192+   End-PR;                                                                                                          1000185
    193+                                                                                                                    1000186
    194+   //Returns pointer to parent node                                                                                 1000187
    195+   Dcl-PR json_GetParent Pointer extproc(*CWIDEN : 'jx_GetNodeParent');                                             1000188
    196+     //Pointer to current node (elem)                                                                               1000189
    197+     pNode          Pointer    value;                                                                               1000190
    198+   End-PR;                                                                                                          1000191
    199+                                                                                                                    1000192
    200+   Dcl-PR json_SetEval pointer extproc(*CWIDEN:'jx_SetEvalByName');                                                 1000193
    201+     pNode          Pointer    value;                                                                               1000194
    202+     Expresion      Pointer    value options(*string);                                                              1000195
    203+     Value          Pointer    value options(*string);                                                              1000196
    204+   End-PR;                                                                                                          1000197
    205+                                                                                                                    1000198
    206+   Dcl-PR json_SetStr Pointer extproc(*CWIDEN: 'jx_SetStrByName');                                                  1000199
    207+     //Pointer to json_ tree                                                                                        1000200
    208+     pNode          Pointer    value;                                                                               1000201
    209+     //X-path locations to node or attributes                                                                       1000202
    210+     Expresion      Pointer    value options(*string);                                                              1000203
    211+     //New value to set / pointer to object                                                                         1000204
    212+     Value          Pointer    value options(*string);                                                              1000205
    213+   End-PR;                                                                                                          1000206
    214+                                                                                                                    1000207
    215+   Dcl-PR json_SetInt Pointer extproc(*CWIDEN: 'jx_SetIntByName');                                                  1000208
    216+     //Pointer to json_ tree                                                                                        1000209
    217+     pNode          Pointer    value;                                                                               1000210
    218+     //X-path locations to node or attributes                                                                       1000211
    219+     Expresion      Pointer    value options(*string);                                                              1000212
    220+     //New value to set / pointer to object                                                                         1000213
    221+     Value          Int(10)    value;                                                                               1000214
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page      8
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    222+   End-PR;                                                                                                          1000215
    223+                                                                                                                    1000216
    224+   Dcl-PR json_SetNum Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  1000217
    225+     //Pointer to json_ tree                                                                                        1000218
    226+     pNode          Pointer    value;                                                                               1000219
    227+     //X-path locations to node or attributes                                                                       1000220
    228+     Expresion      Pointer    value options(*string);                                                              1000221
    229+     //New value to set / pointer to object                                                                         1000222
    230+     Value          Packed(30:15) value;                                                                            1000223
    231+   End-PR;                                                                                                          1000224
    232+                                                                                                                    1000225
    233+   Dcl-PR json_SetBool Pointer extproc(*CWIDEN: 'jx_SetBoolByName');                                                1000226
    234+     //Pointer to json_ tree                                                                                        1000227
    235+     pNode          Pointer    value;                                                                               1000228
    236+     //X-path locations to node or attributes                                                                       1000229
    237+     Expresion      Pointer    value options(*string);                                                              1000230
    238+     //New value to set / pointer to object                                                                         1000231
    239+     Value          Ind        value;                                                                               1000232
    240+   End-PR;                                                                                                          1000233
    241+                                                                                                                    1000234
    242+   Dcl-PR json_SetPtr Pointer extproc(*CWIDEN: 'jx_SetPtrByName');                                                  1000235
    243+     //Pointer to json_ tree                                                                                        1000236
    244+     pNode          Pointer    value;                                                                               1000237
    245+     //X-path locations to node or attributes                                                                       1000238
    246+     Expresion      Pointer    value options(*string);                                                              1000239
    247+     //Pointer to anything - You do the cleanup                                                                     1000240
    248+     Value          Pointer    value;                                                                               1000241
    249+   End-PR;                                                                                                          1000242
    250+                                                                                                                    1000243
    251+   Dcl-PR json_SetValue Pointer extproc(*CWIDEN: 'jx_SetValueByName');                                              1000244
    252+     //Pointer to json_ tree                                                                                        1000245
    253+     pNode          Pointer    value;                                                                               1000246
    254+     //X-path locations to node or attributes                                                                       1000247
    255+     Expresion      Pointer    value options(*string);                                                              1000248
    256+     //New value to set / pointer to object                                                                         1000249
    257+     Value          Pointer    value options(*string:*nopass);                                                      1000250
    258+     //Optional new type (Refer "node type"                                                                         1000251
    259+     Type           Uns(5)     value options(*nopass);                                                              1000252
    260+   End-PR;                                                                                                          1000253
    261+                                                                                                                    1000254
    262+   Dcl-PR json_GetValueStr Varchar(32767)                                                                           1000255
    263+                         extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                    1000256
    264+     //Pointer to node                                                                                              1000257
    265+     pNode          Pointer    value;                                                                               1000258
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page      9
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    266+     //If not found - default value                                                                                 1000259
    267+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000260
    268+   End-PR;                                                                                                          1000261
    269+                                                                                                                    1000262
    270+   Dcl-PR json_GetValueNum Packed(30:15)                                                                            1000263
    271+                         extproc(*CWIDEN : 'jx_GetNodeValueNum');                                                   1000264
    272+     //Pointer to node                                                                                              1000265
    273+     pNode          Pointer    value;                                                                               1000266
    274+     //If not found - default value                                                                                 1000267
    275+     Defaultvalue   Packed(30:15) value options(*NOPASS);                                                           1000268
    276+   End-PR;                                                                                                          1000269
    277+                                                                                                                    1000270
    278+   Dcl-PR json_GetValuePtr Pointer extproc(*CWIDEN : 'jx_GetNodeValuePtr');                                         1000271
    279+     //Pointer to node                                                                                              1000272
    280+     pNode          Pointer    value;                                                                               1000273
    281+     //If not found - default value                                                                                 1000274
    282+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000275
    283+   End-PR;                                                                                                          1000276
    284+                                                                                                                    1000277
    285+   Dcl-PR json_GetName Varchar(32767)                                                                               1000278
    286+                     extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                         1000279
    287+     //Pointer to node                                                                                              1000280
    288+     pNode          Pointer    value;                                                                               1000281
    289+   End-PR;                                                                                                          1000282
    290+                                                                                                                    1000283
    291+   Dcl-PR json_GetNameAsPath Varchar(32767)                                                                         1000284
    292+                           extproc(*CWIDEN : 'jx_GetNodeNameAsPath');                                               1000285
    293+     //Pointer to node                                                                                              1000286
    294+     pNode          Pointer    value;                                                                               1000287
    295+     //Delimiter like - or . or / or \                                                                              1000288
    296+     Delimiter      Char(1)    value;                                                                               1000289
    297+   End-PR;                                                                                                          1000290
    298+                                                                                                                    1000291
    299+   //* Refer to node type above                                                                                     1000292
    300+   Dcl-PR json_NodeType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                                 1000293
    301+     //Pointer to json_ tree to receive format                                                                      1000294
    302+     pNode          Pointer    value;                                                                               1000295
    303+   End-PR;                                                                                                          1000296
    304+                                                                                                                    1000297
    305+ // Get string by expresion                                                                                         1000298
    306+ //  /object/array#123¤/name                                                                                        1000299
    307+ //  .object.array#123¤.name                                                                                        1000300
    308+   Dcl-PR json_GetStr Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                            1000301
    309+     //Pointer to relative node                                                                                     1000302
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     10
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    310+     pNode          Pointer    value;                                                                               1000303
    311+     //Locations expression to node                                                                                 1000304
    312+     Expression     Pointer    value options(*string:*nopass);                                                      1000305
    313+     //If not found - default value                                                                                 1000306
    314+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000307
    315+   End-PR;                                                                                                          1000308
    316+                                                                                                                    1000309
    317+ //  will join all subsequent array nodes into one resulting string                                                 1000310
    318+   Dcl-PR json_GetStrJoin Varchar(32767)                                                                            1000311
    319+                        extproc(*CWIDEN : 'jx_GetStrJoinVC');                                                       1000312
    320+     //Pointer to relative node                                                                                     1000313
    321+     pNode          Pointer    value;                                                                               1000314
    322+     //Locations expression to node                                                                                 1000315
    323+     Expression     Pointer    value options(*string:*nopass);                                                      1000316
    324+     //If not found - default value                                                                                 1000317
    325+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000318
    326+   End-PR;                                                                                                          1000319
    327+                                                                                                                    1000320
    328+ // Get number by expresion like:                                                                                   1000321
    329+ //  /object/array#123¤/name                                                                                        1000322
    330+ //  .object.array#123¤.name                                                                                        1000323
    331+   Dcl-PR json_GetNum Packed(30:15) extproc(*CWIDEN : 'jx_GetValueNum');                                            1000324
    332+     //Pointer to relative node                                                                                     1000325
    333+     pNode          Pointer    value;                                                                               1000326
    334+     //Locations expression to node                                                                                 1000327
    335+     Expression     Pointer    value options(*string:*nopass);                                                      1000328
    336+     //If not found - default value                                                                                 1000329
    337+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           1000330
    338+   End-PR;                                                                                                          1000331
    339+                                                                                                                    1000332
    340+   Dcl-PR json_GetInt Int(20) extproc(*CWIDEN : 'jx_GetValueInt');                                                  1000333
    341+     //Pointer to relative node                                                                                     1000334
    342+     pNode          Pointer    value;                                                                               1000335
    343+     //Locations expression to node                                                                                 1000336
    344+     Expression     Pointer    value options(*string:*nopass);                                                      1000337
    345+     //If not found - default value                                                                                 1000338
    346+     Defaultvalue   Int(20)    value options(*nopass);                                                              1000339
    347+   End-PR;                                                                                                          1000340
    348+                                                                                                                    1000341
    349+   //Set an ILOB object to a value found by X                                                                       1000342
    350+   //Return *ON if found                                                                                            1000343
    351+   Dcl-PR json_GetIlobValue Ind extproc(*CWIDEN :'ILOB_XmlGetValue');                                               1000344
    352+     //Pointer to ILOB object to receive the va                                                                     1000345
    353+     pIlob          Pointer    value;                                                                               1000346
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    354+     //Pointer to tree                                                                                              1000347
    355+     pNode          Pointer    value;                                                                               1000348
    356+     //X-path locations to node or attributes                                                                       1000349
    357+     Expression     Pointer    value options(*string);                                                              1000350
    358+   End-PR;                                                                                                          1000351
    359+                                                                                                                    1000352
    360+   Dcl-PR json_CopyValue Pointer extproc(*CWIDEN : 'jx_CopyValue');                                                 1000353
    361+     //destination node                                                                                             1000354
    362+     pDest          Pointer    value;                                                                               1000355
    363+     //destiantion name (or *NULL or '')                                                                            1000356
    364+     destName       Pointer    value options(*string);                                                              1000357
    365+     //source node                                                                                                  1000358
    366+     pSource        Pointer    value;                                                                               1000359
    367+     //source name (or *NULL or '')                                                                                 1000360
    368+     sourceName     Pointer    value options(*string);                                                              1000361
    369+   End-PR;                                                                                                          1000362
    370+                                                                                                                    1000363
    371+   Dcl-PR json_NodeCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                           1000364
    372+     //node. Retrive from Locate()                                                                                  1000365
    373+     pRootNode      Pointer    value;                                                                               1000366
    374+     //node. Retrive from Locate()                                                                                  1000367
    375+     pNewChild      Pointer    value;                                                                               1000368
    376+     //Reference location to where it arrive                                                                        1000369
    377+     RefLocation    Int(10)    value;                                                                               1000370
    378+   End-PR;                                                                                                          1000371
    379+                                                                                                                    1000372
    380+   //Following constants used by json_NodeCopy:RefLocation                                                          1000373
    381+   Dcl-C json_FIRST_CHILD const(1);                                                                                 1000374
    382+   Dcl-C json_LAST_CHILD const(2);                                                                                  1000375
    383+   Dcl-C json_BEFORE_SIBLING const(3);                                                                              1000376
    384+   Dcl-C json_AFTER_SIBLING const(4);                                                                               1000377
    385+                                                                                                                    1000378
    386+   Dcl-PR json_NodeClone Pointer extproc(*CWIDEN : 'jx_NodeClone');                                                 1000379
    387+     //node. Retrive from Locate()                                                                                  1000380
    388+     pSource        Pointer    value;                                                                               1000381
    389+   End-PR;                                                                                                          1000382
    390+                                                                                                                    1000383
    391+   //returns the new node                                                                                           1000384
    392+   Dcl-PR json_NodeAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                     1000385
    393+     //node. Retrive from Locate()                                                                                  1000386
    394+     pRootNode      Pointer    value;                                                                               1000387
    395+     //Reference location to where it arrive                                                                        1000388
    396+     RefLocation    Int(10)    value;                                                                               1000389
    397+     //Name of node                                                                                                 1000390
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    398+     Name           Pointer    value options(*string);                                                              1000391
    399+     //Value or expression                                                                                          1000392
    400+     Value          Pointer    value options(*string);                                                              1000393
    401+     //New type (Refer "node type"                                                                                  1000394
    402+     Type           Uns(5)     value;                                                                               1000395
    403+   End-PR;                                                                                                          1000396
    404+                                                                                                                    1000397
    405+   Dcl-PR json_NodeDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                       1000398
    406+     //node. Retrive from Locate()                                                                                  1000399
    407+     pRootNode      Pointer    value;                                                                               1000400
    408+   End-PR;                                                                                                          1000401
    409+                                                                                                                    1000402
    410+   //Unlink the note from its previous and promote it as a new root node                                            1000403
    411+   Dcl-PR json_NodeUnlink Pointer extproc(*CWIDEN : 'jx_NodeUnlink');                                               1000404
    412+     //Targenode. Retrive from Locate(                                                                              1000405
    413+     pNode          Pointer    value;                                                                               1000406
    414+   End-PR;                                                                                                          1000407
    415+                                                                                                                    1000408
    416+   Dcl-PR json_NodeSanitize extproc(*CWIDEN : 'jx_NodeSanitize');                                                   1000409
    417+     //node. Retrive from Locate()                                                                                  1000410
    418+     pRootNode      Pointer    value;                                                                               1000411
    419+   End-PR;                                                                                                          1000412
    420+                                                                                                                    1000413
    421+   //CheckSum of all names and values                                                                               1000414
    422+   //Delete all nodes which value are null                                                                          1000415
    423+   Dcl-PR json_NodeCheckSum Uns(10) extproc(*CWIDEN : 'jx_NodeCheckSum');                                           1000416
    424+     pRootNode      Pointer    value; //node. Retrive from Locate()                                                 1000417
    425+   End-PR;                                                                                                          1000418
    426+                                                                                                                    1000419
    427+   //returns the new node                                                                                           1000420
    428+   Dcl-PR json_NewObject Pointer extproc(*CWIDEN : 'jx_NewObject');                                                 1000421
    429+     //Destination. Retrive from Locate()                                                                           1000422
    430+     pDestNode      Pointer    value options(*nopass);                                                              1000423
    431+   End-PR;                                                                                                          1000424
    432+                                                                                                                    1000425
    433+ // Array functions                                                                                                 1000426
    434+   //returns the new node                                                                                           1000427
    435+   Dcl-PR json_NewArray Pointer extproc(*CWIDEN : 'jx_NewArray');                                                   1000428
    436+     //Destination. Retrive from Locate()                                                                           1000429
    437+     pDestNode      Pointer    value options(*nopass);                                                              1000430
    438+   End-PR;                                                                                                          1000431
    439+                                                                                                                    1000432
    440+   //returns the new node added to the end of                                                                       1000433
    441+   Dcl-PR json_ArrayPush Pointer extproc(*CWIDEN : 'jx_ArrayPush');                                                 1000434
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    442+     //Destination. Retrive from Locate()                                                                           1000435
    443+     pDestArray     Pointer    value;                                                                               1000436
    444+     //source node to append                                                                                        1000437
    445+     pSourceNode    Pointer    value options(*string);                                                              1000438
    446+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000439
    447+     copy           Uns(5)     value options(*nopass);                                                              1000440
    448+   End-PR;                                                                                                          1000441
    449+                                                                                                                    1000442
    450+   //Following constants used by json_ArrayPush:copy                                                                1000443
    451+   Dcl-C json_MOVE_UNLINK const(0);                                                                                 1000444
    452+   Dcl-C json_COPY_CLONE const(1);                                                                                  1000445
    453+                                                                                                                    1000446
    454+   //returns the new node added to the end of                                                                       1000447
    455+   Dcl-PR json_ArrayAppend Pointer extproc(*CWIDEN :'jx_ArrayAppend');                                              1000448
    456+     //Destination. Retrive from Locate()                                                                           1000449
    457+     pDestArray     Pointer    value;                                                                               1000450
    458+     //source node to append                                                                                        1000451
    459+     pSourceNode    Pointer    value options(*string);                                                              1000452
    460+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000453
    461+     copy           Uns(5)     value options(*nopass);                                                              1000454
    462+   End-PR;                                                                                                          1000455
    463+                                                                                                                    1000456
    464+   //returns the new array fro source array                                                                         1000457
    465+   Dcl-PR json_ArraySlice Pointer extproc(*CWIDEN : 'jx_ArraySlice' );                                              1000458
    466+     //source node or array string                                                                                  1000459
    467+     pSourceNode    Pointer    value options(*string);                                                              1000460
    468+     //From entry ( 1=First)                                                                                        1000461
    469+     from           Int(10)    value;                                                                               1000462
    470+     //To and includ   (-1 = Until end)                                                                             1000463
    471+     to             Int(10)    value;                                                                               1000464
    472+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000465
    473+     copy           Uns(5)     value options(*nopass);                                                              1000466
    474+   End-PR;                                                                                                          1000467
    475+                                                                                                                    1000468
    476+   //returns the new node added to the end of                                                                       1000469
    477+   Dcl-PR json_ArraySort Pointer extproc(*CWIDEN : 'jx_ArraySort');                                                 1000470
    478+     //Destination. Retrive from Locate()                                                                           1000471
    479+     pArray         Pointer    value;                                                                               1000472
    480+     //nodenames if any in subobject to comapre                                                                     1000473
    481+     pkeyNames      Pointer    value options(*string) ;                                                             1000474
    482+     //0=(Dft) use json numerics, 1=Use locale                                                                      1000475
    483+     options        uns(5)     value options(*nopass);                                                              1000476
    484+   End-PR;                                                                                                          1000477
    485+                                                                                                                    1000478
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    486+   Dcl-C json_USE_LOCALE const(1);                                                                                  1000479
    487+                                                                                                                    1000480
    488+   //returns the first node with expr value                                                                         1000481
    489+   Dcl-PR json_LookupValue Pointer extproc(*CWIDEN : 'jx_lookupValue');                                             1000482
    490+     //Array/ obj to search                                                                                         1000483
    491+     pArray         Pointer    value;                                                                               1000484
    492+     //What to search for                                                                                           1000485
    493+     expr           Pointer    value options(*string);                                                              1000486
    494+     //0=(Dft) Same case, 1=ignore case                                                                             1000487
    495+     ignoreCase     Uns(5)     value options(*nopass);                                                              1000488
    496+   End-PR;                                                                                                          1000489
    497+                                                                                                                    1000490
    498+   //Following constants used by json_LookupValue:ignoreCase                                                        1000491
    499+   Dcl-C json_SAME_CASE const(0);                                                                                   1000492
    500+   Dcl-C json_IGNORE_CASE const(1);                                                                                 1000493
    501+                                                                                                                    1000494
    502+   //returns numer of element in array or obj                                                                       1000495
    503+   Dcl-PR json_GetLength Int(10) extproc(*CWIDEN : 'jx_getLength'  );                                               1000496
    504+     //Array to count length                                                                                        1000497
    505+     pArray         Pointer    value;                                                                               1000498
    506+   End-PR;                                                                                                          1000499
    507+                                                                                                                    1000500
    508+   //returns the new node                                                                                           1000501
    509+   Dcl-PR json_Merge Pointer extproc(*CWIDEN : 'jx_NodeMerge');                                                     1000502
    510+     //Destination. Retrive from Locate()                                                                           1000503
    511+     pDestNode      Pointer    value;                                                                               1000504
    512+     //Source tree  Retrive from Locate()                                                                           1000505
    513+     pSourceNode    Pointer    value;                                                                               1000506
    514+     //Optional new type                                                                                            1000507
    515+     Type           Uns(5)     value options(*nopass);                                                              1000508
    516+   End-PR;                                                                                                          1000509
    517+                                                                                                                    1000510
    518+   //Following constants used by json_Merge:Type                                                                    1000511
    519+   Dcl-C json_DONTREPLACE const(0);                                                                                 1000512
    520+   Dcl-C json_REPLACE const(1);                                                                                     1000513
    521+                                                                                                                    1000514
    522+   //returns the new node                                                                                           1000515
    523+   Dcl-PR json_MergeObjects Pointer extproc(*CWIDEN : 'jx_MergeObjects');                                           1000516
    524+     //Destination. Retrive from Locate()                                                                           1000517
    525+     pDestObj       Pointer    value;                                                                               1000518
    526+     //Source tree  Retrive from Locate()                                                                           1000519
    527+     pSourceObj     Pointer    value;                                                                               1000520
    528+     //JX_DONTREPLACE or json_OBJREPLACE                                                                            1000521
    529+     Type           Uns(5)     value;                                                                               1000522
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    530+   End-PR;                                                                                                          1000523
    531+                                                                                                                    1000524
    532+   //returns the source node                                                                                        1000525
    533+   Dcl-PR json_MoveObjectInto Pointer extproc(*CWIDEN : 'jx_NodeMoveInto');                                         1000526
    534+     //Destination. Retrive from Locate()                                                                           1000527
    535+     pDestObj       Pointer    value;                                                                               1000528
    536+     Name           Pointer    value options(*string);                                                              1000529
    537+     //Source tree  Retrive from Locate()                                                                           1000530
    538+     pSourceObj     Pointer    value;                                                                               1000531
    539+   End-PR;                                                                                                          1000532
    540+                                                                                                                    1000533
    541+   Dcl-PR json_Dump  extproc(*CWIDEN : 'jx_Dump');                                                                  1000534
    542+     //Pointer to tree                                                                                              1000535
    543+     pNode          Pointer    value;                                                                               1000536
    544+   End-PR;                                                                                                          1000537
    545+                                                                                                                    1000538
    546+                                                                                                                    1000539
    547+   Dcl-PR json_CloneFormat  extproc(*CWIDEN : 'jx_CloneFormat');                                                    1000540
    548+     //Pointer to tree to receive format                                                                            1000541
    549+     pNode          Pointer    value;                                                                               1000542
    550+     //node ptr or path with right formating                                                                        1000543
    551+     pCloneFrom     Pointer    value options(*string);                                                              1000544
    552+   End-PR;                                                                                                          1000545
    553+                                                                                                                    1000546
    554+   //**  JSON renderes ***                                                                                          1000547
    555+   Dcl-PR json_WriteJsonStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                                1000548
    556+     //node. Retrive from Locate()                                                                                  1000549
    557+     pNode          Pointer    value;                                                                               1000550
    558+     //Name of output stream file                                                                                   1000551
    559+     FileName       Pointer    value options(*string);                                                              1000552
    560+     //Ccsid of output file                                                                                         1000553
    561+     Ccsid          Int(10)    value;                                                                               1000554
    562+     Trim           Ind        value;                                                                               1000555
    563+     //Extra options                                                                                                1000556
    564+     Options        Pointer    value options(*string:*nopass);                                                      1000557
    565+   End-PR;                                                                                                          1000558
    566+                                                                                                                    1000559
    567+   Dcl-PR json_AsJsonText Varchar(32767)                                                                            1000560
    568+                        extproc(*CWIDEN : 'jx_AsJsonText');                                                         1000561
    569+     //node. Retrive from Locate()                                                                                  1000562
    570+     pNode          Pointer    value;                                                                               1000563
    571+   End-PR;                                                                                                          1000564
    572+                                                                                                                    1000565
    573+   Dcl-PR json_AsJsonTextMem Uns(10)                                                                                1000566
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    574+                           extproc(*CWIDEN : 'jx_AsJsonTextMem');                                                   1000567
    575+     //node. Retrive from Locate()                                                                                  1000568
    576+     pNode          Pointer    value;                                                                               1000569
    577+     //pointer to any memory buffer                                                                                 1000570
    578+     pBuffer        Pointer    value;                                                                               1000571
    579+     //Max number of bytes in buffer %size()                                                                        1000572
    580+     maxSize        Uns(10)    value options(*nopass);                                                              1000573
    581+   End-PR;                                                                                                          1000574
    582+                                                                                                                    1000575
    583+   //**  XML  renderes ***                                                                                          1000576
    584+   Dcl-PR json_WriteXmlStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                                  1000577
    585+     //node. Retrive from Locate()                                                                                  1000578
    586+     pNode          Pointer    value;                                                                               1000579
    587+     //Name of output stream file                                                                                   1000580
    588+     FileName       Pointer    value options(*string);                                                              1000581
    589+     //Ccsid of output file                                                                                         1000582
    590+     Ccsid          Int(10)    value;                                                                               1000583
    591+     Trim           Ind        value;                                                                               1000584
    592+     //Extra options                                                                                                1000585
    593+     Options        Pointer    value options(*string:*nopass);                                                      1000586
    594+   End-PR;                                                                                                          1000587
    595+                                                                                                                    1000588
    596+   Dcl-PR json_AsXmlText Varchar(32767) extproc(*CWIDEN : 'jx_AsXmlText');                                          1000589
    597+     //node. Retrive from Locate()                                                                                  1000590
    598+     pNode          Pointer    value;                                                                               1000591
    599+   End-PR;                                                                                                          1000592
    600+                                                                                                                    1000593
    601+   Dcl-PR json_AsXmlTextMem Uns(10) extproc(*CWIDEN : 'jx_AsXmlTextMem');                                           1000594
    602+     //node. Retrive from Locate()                                                                                  1000595
    603+     pNode          Pointer    value;                                                                               1000596
    604+     //pointer to any memory buffer                                                                                 1000597
    605+     pBuffer        Pointer    value;                                                                               1000598
    606+   End-PR;                                                                                                          1000599
    607+                                                                                                                    1000600
    608+   // Return a streamer object to be used in own serialisers                                                        1000601
    609+   Dcl-PR json_Stream pointer extproc(*CWIDEN : 'jx_Stream');                                                       1000602
    610+     //node. Retrive from Locate()                                                                                  1000603
    611+     pNode          Pointer    value;                                                                               1000604
    612+   End-PR;                                                                                                          1000605
    613+                                                                                                                    1000606
    614+   //**  CSV  renderes ***                                                                                          1000607
    615+   Dcl-PR json_WriteCsvStmf  extproc(*CWIDEN : 'jx_WriteCsvStmf');                                                  1000608
    616+     //node. Retrive from Locate()                                                                                  1000609
    617+     pNode          Pointer    value;                                                                               1000610
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    618+     //Name of output stream file                                                                                   1000611
    619+     FileName       Pointer    value options(*string);                                                              1000612
    620+     //Ccsid of output file                                                                                         1000613
    621+     Ccsid          Int(10)    value;                                                                               1000614
    622+     //*ON=Remove inter blanks                                                                                      1000615
    623+     Trim           Ind        value;                                                                               1000616
    624+     //Options: ';.' for separator and dec                                                                          1000617
    625+     Options        Pointer    value options(*string:*nopass);                                                      1000618
    626+   End-PR;                                                                                                          1000619
    627+                                                                                                                    1000620
    628+                                                                                                                    1000621
    629+   Dcl-DS json_DelimiterDS  based(prototype_only) qualified;                                                        1000622
    630+     Slash          Char(1);                                                                                        1000623
    631+     BackSlash      Char(1);                                                                                        1000624
    632+     Masterspace    Char(1);                                                                                        1000625
    633+     BraBeg         Char(1);                                                                                        1000626
    634+     BraEnd         Char(1);                                                                                        1000627
    635+     Blank          Char(1);                                                                                        1000628
    636+     Dot            Char(1);                                                                                        1000629
    637+     CurBeg         Char(1);                                                                                        1000630
    638+     CurEnd         Char(1);                                                                                        1000631
    639+     Apos           Char(1);                                                                                        1000632
    640+     Quot           Char(1);                                                                                        1000633
    641+   End-DS;                                                                                                          1000634
    642+                                                                                                                    1000635
    643+   //Iterators: First use the set the use forEach                                                                   1000636
    644+   Dcl-DS json_Iterator  based(prototype_only) qualified;                                                           1000637
    645+     root           Pointer;                                                                                        1000638
    646+     this           Pointer;                                                                                        1000639
    647+     isList         Ind;                                                                                            1000640
    648+     isFirst        Ind;                                                                                            1000641
    649+     isLast         Ind;                                                                                            1000642
    650+     isRecursive    Ind;                                                                                            1000643
    651+     comma          Varchar(1);                                                                                     1000644
    652+     count          Int(10);                                                                                        1000645
    653+     length         Int(10);                                                                                        1000646
    654+     size           Int(10);                                                                                        1000647
    655+     //Pointer to temp array of elms                                                                                1000648
    656+     listArr        Pointer;                                                                                        1000649
    657+     //Set  this to *ON to teminate loop                                                                            1000650
    658+     break          Ind;                                                                                            1000651
    659+     filler         Char(64);                                                                                       1000652
    660+   End-DS;                                                                                                          1000653
    661+                                                                                                                    1000654
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    662+   Dcl-PR json_setIterator  likeds( json_Iterator)                                                                  1000655
    663+                          extproc(*CWIDEN : 'jx_SetIterator');                                                      1000656
    664+     //node. Retrive from Locate()                                                                                  1000657
    665+     pNode          Pointer    value;                                                                               1000658
    666+     //Optional - path to node                                                                                      1000659
    667+     path           Pointer    value options(*string:*nopass);                                                      1000660
    668+   End-PR;                                                                                                          1000661
    669+                                                                                                                    1000662
    670+   Dcl-PR json_setRecursiveIterator  likeds( json_Iterator)                                                         1000663
    671+                                   extproc(*CWIDEN :                                                                1000664
    672+                                   'jx_SetRecursiveIterator');                                                      1000665
    673+     //node. Retrive from Locate()                                                                                  1000666
    674+     pNode          Pointer    value;                                                                               1000667
    675+     //Optional - path to node                                                                                      1000668
    676+     path           Pointer    value options(*string:*nopass);                                                      1000669
    677+   End-PR;                                                                                                          1000670
    678+                                                                                                                    1000671
    679+   //Iterator Structure                                                                                             1000672
    680+   Dcl-PR json_forEach Ind extproc(*CWIDEN : 'jx_ForEach');                                                         1000673
    681+     iterator                  likeds( json_Iterator);                                                              1000674
    682+   End-PR;                                                                                                          1000675
    683+                                                                                                                    1000676
    684+   //For XML attributes                                                                                             1000677
    685+   Dcl-PR json_GetNodeAttrValue Varchar(32767)                                                                      1000678
    686+                              extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                           1000679
    687+     //Pointer to exsiting element                                                                                  1000680
    688+     pNode          Pointer    value;                                                                               1000681
    689+     //Attribute Name                                                                                               1000682
    690+     AttrName       Pointer    value options(*string);                                                              1000683
    691+     //If not found - default value                                                                                 1000684
    692+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000685
    693+   End-PR;                                                                                                          1000686
    694+                                                                                                                    1000687
    695+   Dcl-PR json_SetNodeAttrValue extproc(*CWIDEN : 'jx_SetNodeAttrValue');                                           1000688
    696+     //Pointer to exsiting element                                                                                  1000689
    697+     pNode          Pointer    value;                                                                               1000690
    698+     //Attribute name                                                                                               1000691
    699+     AttrName       Pointer    value options(*string);                                                              1000692
    700+     //New value                                                                                                    1000693
    701+     Value          Pointer    value options(*string);                                                              1000694
    702+   End-PR;                                                                                                          1000695
    703+                                                                                                                    1000696
    704+   Dcl-PR json_GetAttrValue Varchar(32767)                                                                          1000697
    705+                          extproc(*CWIDEN : 'jx_GetAttrValueVC');                                                   1000698
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    706+     //Pointer Attribute                                                                                            1000699
    707+     pAttr          Pointer    value;                                                                               1000700
    708+     //If not found - default value                                                                                 1000701
    709+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000702
    710+   End-PR;                                                                                                          1000703
    711+                                                                                                                    1000704
    712+   Dcl-PR json_SetAttrValue extproc(*CWIDEN : 'jx_SetAttrValue');                                                   1000705
    713+     //Pointer Attribute                                                                                            1000706
    714+     pAttr          Pointer    value;                                                                               1000707
    715+     //New value                                                                                                    1000708
    716+     AttrName       Pointer    value options(*string);                                                              1000709
    717+     //Default value                                                                                                1000710
    718+     Value          Pointer    value options(*string);                                                              1000711
    719+   End-PR;                                                                                                          1000712
    720+                                                                                                                    1000713
    721+   //Returns pointer to attribute list                                                                              1000714
    722+   Dcl-PR json_GetAttrFirst Pointer extproc(*CWIDEN : 'jx_GetAttrFirst');                                           1000715
    723+     //Pointer to element                                                                                           1000716
    724+     pElem          Pointer    value;                                                                               1000717
    725+   End-PR;                                                                                                          1000718
    726+                                                                                                                    1000719
    727+   //Returns pointer to attribute list                                                                              1000720
    728+   Dcl-PR json_GetAttrNext Pointer extproc(*CWIDEN : 'jx_GetAttrNext');                                             1000721
    729+     //Pointer to attribute list                                                                                    1000722
    730+     pAttr          Pointer    value;                                                                               1000723
    731+   End-PR;                                                                                                          1000724
    732+                                                                                                                    1000725
    733+   Dcl-PR json_GetAttrName Varchar(32767)                                                                           1000726
    734+                         extproc(*CWIDEN : 'jx_GetAttrNameVC');                                                     1000727
    735+     //Pointer to attribute list                                                                                    1000728
    736+     pAttr          Pointer    value;                                                                               1000729
    737+   End-PR;                                                                                                          1000730
    738+                                                                                                                    1000731
    739+ // Clear the contents of an array or object / delete all children                                                  1000732
    740+   Dcl-PR json_Clear  extproc(*CWIDEN : 'jx_Clear');                                                                1000733
    741+     pNode          Pointer    value; //Pointer to tree node                                                        1000734
    742+   End-PR;                                                                                                          1000735
    743+                                                                                                                    1000736
    744+ // Close all nodes in this tree - also parent and siblings                                                         1000737
    745+   Dcl-PR json_Close  extproc(*CWIDEN : 'jx_Close');                                                                1000738
    746+     //Pointer to tree node                                                                                         1000739
    747+     pNode          Pointer  ;                                                                                      1000740
    748+   End-PR;                                                                                                          1000741
    749+ // Detect if you have a memry leak: call this when you have closed everything at i will return                     1000742
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    750+   Dcl-PR json_MemLeak Ind extproc(*CWIDEN : 'jx_MemLeak');                                                         1000743
    751+   End-PR;                                                                                                          1000744
    752+                                                                                                                    1000745
    753+ // Print memory report                                                                                             1000746
    754+   Dcl-PR json_MemStat  extproc(*CWIDEN : 'jx_MemStat');                                                            1000747
    755+   End-PR;                                                                                                          1000748
    756+                                                                                                                    1000749
    757+ // retune number of bytest used                                                                                    1000750
    758+   Dcl-PR json_MemUse Uns(20) extproc(*CWIDEN : 'jx_MemUse');                                                       1000751
    759+   End-PR;                                                                                                          1000752
    760+                                                                                                                    1000753
    761+ // Return a memory segment pointer, and build a scope where JSON/XML will be created                               1000754
    762+   Dcl-PR json_SegmentSelectNo Pointer                                                                              1000755
    763+                             extproc(*CWIDEN : 'jx_SegmentSelectNo');                                               1000756
    764+     SegmentIndex   Int(10)    value;                                                                               1000757
    765+   End-PR;                                                                                                          1000758
    766+                                                                                                                    1000759
    767+ //  Delete the segment and all JSON/XML nodes build while segment scope was active                                 1000760
    768+   Dcl-PR json_SegmentDispose  extproc(*CWIDEN : 'jx_SegmentDispose');                                              1000761
    769+     segmentPtr     Pointer    value;                                                                               1000762
    770+   End-PR;                                                                                                          1000763
    771+                                                                                                                    1000764
    772+ // Maintain at list of index numbers to database CLOB/BLOB fields since pointers can not be sh                     1000765
    773+   //Returns *ON if found                                                                                           1000766
    774+   Dcl-PR json_mapIx Ind extproc(*CWIDEN:'jx_MapIx' );                                                              1000767
    775+     //pointer to node pointer                                                                                      1000768
    776+     ppNode         Pointer;                                                                                        1000769
    777+     //index of pointer                                                                                             1000770
    778+     Index          Uns(10)    value;                                                                               1000771
    779+   End-PR;                                                                                                          1000772
    780+                                                                                                                    1000773
    781+   //------------------------------------------------------------------------                                       1000774
    782+   //SQL interface:                                                                                                 1000775
    783+   //Note: When SQL functions returns *NULL, then use  the json_Message() to re                                     1000776
    784+   //------------------------------------------------------------------------                                       1000777
    785+                                                                                                                    1000778
    786+ // If options need - then it has to be first call made.                                                            1000779
    787+ // NOTE: If a pConnection pointer is provided, it will be updated with the conection                               1000780
    788+   Dcl-PR json_sqlSetOptions  extproc(*CWIDEN: 'jx_sqlSetOptions');                                                 1000781
    789+     //json object with options ( see sample)                                                                       1000782
    790+     parms          Pointer    value options(*string:*nopass);                                                      1000783
    791+   End-PR;                                                                                                          1000784
    792+                                                                                                                    1000785
    793+ // returns a object node with one resulting row for the SQL statment                                               1000786
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    794+   //Returns one SQL row as jx Obejct                                                                               1000787
    795+   Dcl-PR json_sqlResultRow Pointer extproc(*CWIDEN: 'jx_sqlResultRow');                                            1000788
    796+     //SQL statement to run                                                                                         1000789
    797+     sqlStmt        Pointer    value options(*string);                                                              1000790
    798+     //json object template                                                                                         1000791
    799+     parms          Pointer    value options(*string:*nopass);                                                      1000792
    800+   End-PR;                                                                                                          1000793
    801+                                                                                                                    1000794
    802+ // returns an array (or object with array) of resulting rows for the SQL statment                                  1000795
    803+   //Returns SQL rows as jx Obejct                                                                                  1000796
    804+   Dcl-PR json_sqlResultSet Pointer extproc(*CWIDEN: 'jx_sqlResultSet');                                            1000797
    805+     //SQL statement to run                                                                                         1000798
    806+     sqlStmt        Pointer    value options(*string);                                                              1000799
    807+     //From row; 1=First                                                                                            1000800
    808+     start          Int(10)    value options(*nopass);                                                              1000801
    809+     //max number of rows; json_ALLROWS=all                                                                         1000802
    810+     limit          Int(10)    value options(*nopass);                                                              1000803
    811+     //resultset format:                                                                                            1000804
    812+     format         Int(10)    value options(*nopass);                                                              1000805
    813+     //json object template                                                                                         1000806
    814+     parms          Pointer    value options(*string:*nopass);                                                      1000807
    815+   End-PR;                                                                                                          1000808
    816+                                                                                                                    1000809
    817+                                                                                                                    1000810
    818+   Dcl-C json_ALLROWS const(-1);                                                                                    1000811
    819+                                                                                                                    1000812
    820+   //Following constants used by json_sqlResultSet:format                                                           1000813
    821+   //+ An array with each row as an object                                                                          1000814
    822+   Dcl-C json_ROWARRAY const(0);                                                                                    1000815
    823+   //+ Metaobject: rows, fields                                                                                     1000816
    824+   Dcl-C json_META    const(1);                                                                                     1000817
    825+   //+ Columns info                                                                                                 1000818
    826+   Dcl-C json_FIELDS  const(2);                                                                                     1000819
    827+   //+ Count all rows in the resultset                                                                              1000820
    828+   // ( Pricy so awoid it !! )                                                                                      1000821
    829+   Dcl-C json_TOTALROWS const(4);                                                                                   1000822
    830+   //+ Uppercase column names                                                                                       1000823
    831+   Dcl-C json_UPPERCASE const(8);                                                                                   1000824
    832+                                                                                                                    1000825
    833+   //+ Appoximate number of rows..                                                                                  1000826
    834+   //  ( unpresise but cheap !! prefered  )                                                                         1000827
    835+   Dcl-C json_APPROXIMATE_TOTALROWS const(16);                                                                      1000828
    836+                                                                                                                    1000829
    837+                                                                                                                    1000830
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    838+                                                                                                                    1000831
    839+ // SQL cursor processing                                                                                           1000832
    840+   //Returns handle to sql statement                                                                                1000833
    841+   Dcl-PR json_sqlOpen Pointer extproc(*CWIDEN:'jx_sqlOpen'  );                                                     1000834
    842+     //SQL statement to run                                                                                         1000835
    843+     sqlStmt        Pointer    value options(*string);                                                              1000836
    844+     //json object template                                                                                         1000837
    845+     parms          Pointer    value options(*string:*nopass);                                                      1000838
    846+   End-PR;                                                                                                          1000839
    847+                                                                                                                    1000840
    848+ // Fetch next from from that open sql handle, starting from rowNumer. 1=First row                                  1000841
    849+   //Returns a row object (or *NULL if EOF)                                                                         1000842
    850+   Dcl-PR json_sqlFetchRelative Pointer                                                                             1000843
    851+                              extproc(*CWIDEN: 'jx_sqlFetchRelative');                                              1000844
    852+     //sql statement handle ( from sqlOpen)                                                                         1000845
    853+     pSqlHndl       Pointer    value;                                                                               1000846
    854+     //row from where to start 1=First                                                                              1000847
    855+     fromRow        Int(10)    value;                                                                               1000848
    856+   End-PR;                                                                                                          1000849
    857+                                                                                                                    1000850
    858+ // Fetch next from from that open sql handle                                                                       1000851
    859+   //Returns a row object (or *NULL if EOF)                                                                         1000852
    860+   Dcl-PR json_sqlFetchNext Pointer extproc(*CWIDEN:'jx_sqlFetchNext');                                             1000853
    861+     //sql statement handle ( from sqlOpen)                                                                         1000854
    862+     pSqlHndl       Pointer    value;                                                                               1000855
    863+   End-PR;                                                                                                          1000856
    864+                                                                                                                    1000857
    865+ // Number of columns in result set ( -1 if error)                                                                  1000858
    866+   //Returns number of columns                                                                                      1000859
    867+   Dcl-PR json_sqlColumns Int(10) extproc(*CWIDEN:'jx_sqlColumns');                                                 1000860
    868+     //sql statement handle ( from sqlOpen)                                                                         1000861
    869+     pSqlHndl       Pointer    value;                                                                               1000862
    870+   End-PR;                                                                                                          1000863
    871+                                                                                                                    1000864
    872+ // Number of rows  in result set ( -1 if error)                                                                    1000865
    873+ // Note: This will run a hidden "select count(*)" which might be a little pricy                                    1000866
    874+   //Returns number of rows                                                                                         1000867
    875+   Dcl-PR json_sqlRows Int(10) extproc(*CWIDEN:'jx_sqlRows');                                                       1000868
    876+     //sql statement handle ( from sqlOpen)                                                                         1000869
    877+     pSqlHndl       Pointer    value;                                                                               1000870
    878+   End-PR;                                                                                                          1000871
    879+                                                                                                                    1000872
    880+ // Always colse the cursor after use, to release resources                                                         1000873
    881+   Dcl-PR json_sqlClose  extproc(*CWIDEN:'jx_sqlClose');                                                            1000874
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    882+     //sql statement handle ( from sqlOpen)                                                                         1000875
    883+     pSqlHndl       Pointer;                                                                                        1000876
    884+   End-PR;                                                                                                          1000877
    885+                                                                                                                    1000878
    886+ // Execute any SQL statement not involving a cursor                                                                1000879
    887+   //Returns *ON if error                                                                                           1000880
    888+   Dcl-PR json_sqlExec Ind extproc(*CWIDEN:'jx_sqlExec'  );                                                         1000881
    889+     //SQL statement to run (template)                                                                              1000882
    890+     sqlStmt        Pointer    value options(*string);                                                              1000883
    891+     //json object template data                                                                                    1000884
    892+     parms          Pointer    value options(*string:*nopass);                                                      1000885
    893+   End-PR;                                                                                                          1000886
    894+                                                                                                                    1000887
    895+ // Execute an update table where the row is defined as a json object                                               1000888
    896+   //Returns *ON if error                                                                                           1000889
    897+   Dcl-PR json_sqlUpdate Ind extproc(*CWIDEN:'jx_sqlUpdate');                                                       1000890
    898+     //table name                                                                                                   1000891
    899+     table          Pointer    value options(*string);                                                              1000892
    900+     //json object: æa:123,b:"value"å                                                                               1000893
    901+     row            Pointer    value options(*string);                                                              1000894
    902+     //where clause : 'where myKey=Åkey'                                                                            1000895
    903+     where          Pointer    value options(*string:*nopass);                                                      1000896
    904+     //where parameters: æ key:777å                                                                                 1000897
    905+     whereParms     Pointer    value options(*string:*nopass);                                                      1000898
    906+   End-PR;                                                                                                          1000899
    907+                                                                                                                    1000900
    908+   //Returns *ON if error                                                                                           1000901
    909+   Dcl-PR json_sqlInsert Ind extproc(*CWIDEN:'jx_sqlInsert');                                                       1000902
    910+     //table name                                                                                                   1000903
    911+     table          Pointer    value options(*string);                                                              1000904
    912+     //json object: æa:123,b:"value"å                                                                               1000905
    913+     row            Pointer    value options(*string);                                                              1000906
    914+     //extra parms                                                                                                  1000907
    915+     parms          Pointer    value options(*string:*nopass);                                                      1000908
    916+   End-PR;                                                                                                          1000909
    917+                                                                                                                    1000910
    918+   //Returns *ON if error                                                                                           1000911
    919+   Dcl-PR json_sqlUpsert Ind extproc(*CWIDEN:'jx_sqlUpsert');                                                       1000912
    920+     //table name                                                                                                   1000913
    921+     table          Pointer    value options(*string);                                                              1000914
    922+     //json object: æa:123,b:"value"å                                                                               1000915
    923+     row            Pointer    value options(*string);                                                              1000916
    924+     //where clause : 'where myKey=Åkey'                                                                            1000917
    925+     where          Pointer    value options(*string:*nopass);                                                      1000918
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    926+     //where parameters: æ key:777å                                                                                 1000919
    927+     whereParms     Pointer    value options(*string:*nopass);                                                      1000920
    928+   End-PR;                                                                                                          1000921
    929+                                                                                                                    1000922
    930+   //Returns id of last insert                                                                                      1000923
    931+   Dcl-PR json_sqlGetInsertId Int(10) extproc(*CWIDEN:'jx_sqlGetInsertId');                                         1000924
    932+   End-PR;                                                                                                          1000925
    933+                                                                                                                    1000926
    934+   //Returns array of column info                                                                                   1000927
    935+   Dcl-PR json_sqlGetMeta Pointer extproc(*CWIDEN:'jx_sqlGetMeta');                                                 1000928
    936+     sqlstmt        Pointer    value options(*string);                                                              1000929
    937+   End-PR;                                                                                                          1000930
    938+                                                                                                                    1000931
    939+ // Return pointer to database connection. No options => will be default local database                             1000932
    940+   Dcl-PR json_sqlConnect Pointer extproc(*CWIDEN: 'jx_sqlConnect');                                                1000933
    941+     //json object or string with options                                                                           1000934
    942+     parms          Pointer    value options(*string:*nopass);                                                      1000935
    943+   End-PR;                                                                                                          1000936
    944+                                                                                                                    1000937
    945+ // Return pointer to database connection. No options => will be default local database                             1000938
    946+   Dcl-PR json_sqlDisconnect  extproc(*CWIDEN: 'jx_sqlDisconnect');                                                 1000939
    947+   End-PR;                                                                                                          1000940
    948+                                                                                                                    1000941
    949+ // Return sql code for previous statement                                                                          1000942
    950+   Dcl-PR json_sqlCode Int(10) extproc(*CWIDEN: 'jx_sqlCode');                                                      1000943
    951+   End-PR;                                                                                                          1000944
    952+                                                                                                                    1000945
    953+ //Returns a JSON object from a REST call                                                                           1000946
    954+   Dcl-PR json_httpRequest Pointer extproc(*CWIDEN:'jx_httpRequest');                                               1000947
    955+     //Full URL to the resource                                                                                     1000948
    956+     url            Pointer    value options(*string);                                                              1000949
    957+     //json object or string                                                                                        1000950
    958+     pReqNode       Pointer    value options(*string:*nopass);                                                      1000951
    959+     //extra CURL options                                                                                           1000952
    960+     options        Pointer    value options(*string:*nopass);                                                      1000953
    961+   End-PR;                                                                                                          1000954
    962+                                                                                                                    1000955
    963+ // when the dataarea SQLTRACE is set, your SQL statements                                                          1000956
    964+ // are logged into SQLTRACE table.                                                                                 1000957
    965+ // you can supply an extr eye-catch wariable :trcid                                                                1000958
    966+   Dcl-PR json_traceSetId  extproc(*CWIDEN : 'jx_traceSetId');                                                      1000959
    967+     traceId        Int(20)    value; //Ccsid of inpur file                                                         1000960
    968+   End-PR;                                                                                                          1000961
    969+                                                                                                                    1000962
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    970+ // -------------------------------------------------------------------------------------------                     1000963
    971+ // Depricated and renamed functions :                                                                              1000964
    972+ // -------------------------------------------------------------------------------------------                     1000965
    973+ // Depricated - use  json_GetValueStr                                                                              1000966
    974+   Dcl-PR json_GetValue Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                          1000967
    975+     //Pointer to node                                                                                              1000968
    976+     pNode          Pointer    value;                                                                               1000969
    977+     //If not found - default value                                                                                 1000970
    978+     Expression     Pointer    value options(*string:*nopass);                                                      1000971
    979+     //If not found - default value                                                                                 1000972
    980+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000973
    981+   End-PR;                                                                                                          1000974
    982+                                                                                                                    1000975
    983+ // Depricated - use  json_NodeCopy                                                                                 1000976
    984+   Dcl-PR json_Copy extproc(*CWIDEN : 'jx_NodeCopy');                                                               1000977
    985+     //element. Retrive from Locate()                                                                               1000978
    986+     pRootNode      Pointer    value;                                                                               1000979
    987+     //element. Retrive from Locate()                                                                               1000980
    988+     pNewChild      Pointer    value;                                                                               1000981
    989+     //Reference location to where it arrive                                                                        1000982
    990+     RefLocation    Int(10)    value;                                                                               1000983
    991+   End-PR;                                                                                                          1000984
    992+                                                                                                                    1000985
    993+   Dcl-PR json_ElementCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                        1000986
    994+     //element. Retrive from Locate()                                                                               1000987
    995+     pRootNode      Pointer    value;                                                                               1000988
    996+     //element. Retrive from Locate()                                                                               1000989
    997+     pNewChild      Pointer    value;                                                                               1000990
    998+     //Reference location to where it arrive                                                                        1000991
    999+     RefLocation    Int(10)    value;                                                                               1000992
   1000+   End-PR;                                                                                                          1000993
   1001+                                                                                                                    1000994
   1002+ // Depricated - use  json_NodeDelete                                                                               1000995
   1003+   Dcl-PR json_Delete extproc(*CWIDEN : 'jx_NodeDelete');                                                           1000996
   1004+     //element. Retrive from Locate()                                                                               1000997
   1005+     pRootNode      Pointer    value;                                                                               1000998
   1006+   End-PR;                                                                                                          1000999
   1007+                                                                                                                    1001000
   1008+ // Depricated - use  json_NodeDelete                                                                               1001001
   1009+   Dcl-PR json_ElementDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                    1001002
   1010+     //element. Retrive from Locate()                                                                               1001003
   1011+     pRootNode      Pointer    value;                                                                               1001004
   1012+   End-PR;                                                                                                          1001005
   1013+                                                                                                                    1001006
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1014+ // Depricated - use  json_AsJsonText                                                                               1001007
   1015+   Dcl-PR json_AsText Varchar(32767) extproc(*CWIDEN : 'jx_AsJsonText');                                            1001008
   1016+     //element. Retrive from Locate()                                                                               1001009
   1017+     pNode          Pointer    value;                                                                               1001010
   1018+   End-PR;                                                                                                          1001011
   1019+                                                                                                                    1001012
   1020+                                                                                                                    1001013
   1021+ // json_XpathValue   is depricated and replaced by: json_GetStr                                                    1001014
   1022+   Dcl-PR json_XpathValue Varchar(32767)                                                                            1001015
   1023+                        extproc(*CWIDEN : 'jx_GetValueVC');                                                         1001016
   1024+     //Pointer to tree                                                                                              1001017
   1025+     pNode          Pointer    value;                                                                               1001018
   1026+     //Locations expression to node                                                                                 1001019
   1027+     Expression     Pointer    value options(*string);                                                              1001020
   1028+     //If not found - default value                                                                                 1001021
   1029+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001022
   1030+   End-PR;                                                                                                          1001023
   1031+                                                                                                                    1001024
   1032+ // json_XpathValueNum   is depricated and replaced by: json_GetNum                                                 1001025
   1033+   Dcl-PR json_XpathValueNum Packed(30:15)                                                                          1001026
   1034+                           extproc(*CWIDEN : 'jx_GetValueNum');                                                     1001027
   1035+     //Pointer to tree                                                                                              1001028
   1036+     pJsonCom       Pointer    value;                                                                               1001029
   1037+     //X-path locations to node or attributes                                                                       1001030
   1038+     Node           Pointer    value options(*string);                                                              1001031
   1039+     //If not found - default value                                                                                 1001032
   1040+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           1001033
   1041+   End-PR;                                                                                                          1001034
   1042+                                                                                                                    1001035
   1043+ // Use - json_NodeType                                                                                             1001036
   1044+   Dcl-PR json_ElementType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                              1001037
   1045+     //Pointer to tree to receive format                                                                            1001038
   1046+     pNode          Pointer    value;                                                                               1001039
   1047+   End-PR;                                                                                                          1001040
   1048+                                                                                                                    1001041
   1049+ // Use json_NodeAdd                                                                                                1001042
   1050+   //returns the new element                                                                                        1001043
   1051+   Dcl-PR json_ElementAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                  1001044
   1052+     //element. Retrive from Locate()                                                                               1001045
   1053+     pRootNode      Pointer    value;                                                                               1001046
   1054+     //Reference location to where it arrive                                                                        1001047
   1055+     RefLocation    Int(10)    value;                                                                               1001048
   1056+     //Name of element                                                                                              1001049
   1057+     Name           Pointer    value options(*string);                                                              1001050
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1058+     //Value of element                                                                                             1001051
   1059+     Value          Pointer    value options(*string);                                                              1001052
   1060+   End-PR;                                                                                                          1001053
   1061+                                                                                                                    1001054
   1062+ // Use json_GetNext                                                                                                1001055
   1063+   //Returns pointer to next sibling (elem)                                                                         1001056
   1064+   Dcl-PR json_GetElemNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                             1001057
   1065+     //Pointer to current element (elem)                                                                            1001058
   1066+     pElem          Pointer    value  ;                                                                             1001059
   1067+   End-PR;                                                                                                          1001060
   1068+                                                                                                                    1001061
   1069+ // use json_GetChild                                                                                               1001062
   1070+   //Returns pointer to next child (elem)                                                                           1001063
   1071+   Dcl-PR json_GetElemChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                                           1001064
   1072+     //Pointer to current element (elem)                                                                            1001065
   1073+     pElem          Pointer    value;                                                                               1001066
   1074+   End-PR;                                                                                                          1001067
   1075+                                                                                                                    1001068
   1076+                                                                                                                    1001069
   1077+ // use get json_GetName                                                                                            1001070
   1078+   Dcl-PR json_getElemName Varchar(32767)                                                                           1001071
   1079+                         extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                     1001072
   1080+     //Pointer to node                                                                                              1001073
   1081+     pNode          Pointer    value;                                                                               1001074
   1082+   End-PR;                                                                                                          1001075
   1083+                                                                                                                    1001076
   1084+ // use xml_GetValueStr                                                                                             1001077
   1085+   Dcl-PR json_GetElemValue Varchar(32767)                                                                          1001078
   1086+                          extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                   1001079
   1087+     //Pointer to element                                                                                           1001080
   1088+     pElem          Pointer    value;                                                                               1001081
   1089+     //If not found - default value                                                                                 1001082
   1090+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001083
   1091+   End-PR;                                                                                                          1001084
   1092+                                                                                                                    1001085
   1093+  // use json_GetAttrValue                                                                                          1001086
   1094+   Dcl-PR json_GetAttr Varchar(32767)                                                                               1001087
   1095+                     extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                                    1001088
   1096+     //Pointer to element                                                                                           1001089
   1097+     pNode          Pointer    value;                                                                               1001090
   1098+     //Attribute Name                                                                                               1001091
   1099+     AttrName       Pointer    value options(*string);                                                              1001092
   1100+     //If not found - default value                                                                                 1001093
   1101+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001094
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1102+   End-PR;                                                                                                          1001095
   1103+                                                                                                                    1001096
   1104+ // has no effect any longer                                                                                        1001097
   1105+   //Set input and output CCSID                                                                                     1001098
   1106+   Dcl-PR json_setCcsid  extproc(*CWIDEN : 'jx_SetCcsid');                                                          1001099
   1107+     //Ccsid of inpur file                                                                                          1001100
   1108+     inputCCSID     Int(10)    value;                                                                               1001101
   1109+     //Ccsid of output file                                                                                         1001102
   1110+     outputCCSID    Int(10)    value;                                                                               1001103
   1111+   End-PR;                                                                                                          1001104
   1112+                                                                                                                    1001105
   1113+ // depricated - use setNum                                                                                         1001106
   1114+   Dcl-PR json_SetDec Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  1001107
   1115+     //Pointer to json_ tree                                                                                        1001108
   1116+     pNode          Pointer    value;                                                                               1001109
   1117+     //X-path locations to node or attributes                                                                       1001110
   1118+     Expresion      Pointer    value options(*string);                                                              1001111
   1119+     //New value to set / pointer to object                                                                         1001112
   1120+     Value          Packed(30:15) value;                                                                            1001113
   1121+   End-PR;                                                                                                          1001114
   1122+                                                                                                                    1001115
   1123+ // Depricated in both JSON and XML - use  json_WriteJsonStmf /   json_WriteXmlStmf                                 1001116
   1124+ /if not defined(JSONXML_DEPRICATED)                                                                                1001117
   1125+ /define  JSONXML_DEPRICATED                                                                                        1001118
   1126+   Dcl-PR json_WriteStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                                    1001119
   1127+     //element. Retrive from Locate()                                                                               1001120
   1128+     pNode          Pointer    value;                                                                               1001121
   1129+     //Name of output stream file                                                                                   1001122
   1130+     FileName       Pointer    value options(*string);                                                              1001123
   1131+     //Ccsid of output file                                                                                         1001124
   1132+     Ccsid          Int(10)    value;                                                                               1001125
   1133+     Trim           Ind        value options(*nopass);                                                              1001126
   1134+   End-PR;                                                                                                          1001127
   1135+                                                                                                                    1001128
   1136+   Dcl-PR xml_WriteStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                                      1001129
   1137+     //element. Retrive from Locate()                                                                               1001130
   1138+     pNode          Pointer    value;                                                                               1001131
   1139+     //Name of output stream file                                                                                   1001132
   1140+     FileName       Pointer    value options(*string);                                                              1001133
   1141+     //Ccsid of output file                                                                                         1001134
   1142+     Ccsid          Int(10)    value;                                                                               1001135
   1143+     Trim           Ind        value options(*nopass);                                                              1001136
   1144+   End-PR;                                                                                                          1001137
   1145+ /endif                                                                                                             1001138
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1146    Dcl-S pRows        Pointer;                                                                                       000009
   1147    Dcl-S sql          Varchar(512);                                                                                  000010
   1148                                                                                                                      000011
   1149    //------------------------------------------------------------- *                                                 000012
   1150                                                                                                                      000013
   1151    // return an simple array with all rows                                                                           000014
   1152    sql   = 'Select * from product';                                                                                  000015
   1153    pRows = json_sqlResultSet(sql);                                                                                   000016
   1154                                                                                                                      000017
   1155    // Produce a JSON stream file in the root of the IFS                                                              000018
   1156    json_writeJsonStmf(pRows  :                                                                                       000019
   1157       '/jsonxml/json/resultset-array.json' : 1208 : *ON                                                              000020
   1158    );                                                                                                                000021
   1159                                                                                                                      000022
   1160    // Cleanup: Close the SQL cursor, dispose the rows, arrays and disconnect                                         000023
   1161    json_close(pRows);                                                                                                000024
   1162    json_sqlDisconnect();                                                                                             000025
   1163                                                                                                                      000026
   1164    // That's it..                                                                                                    000027
   1165    *inlr = *on;                                                                                                      000028
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     30
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv Number Seq     Message text
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                             / C o p y   M e m b e r s
 Line   Src  RPG name   <-------- External name -------> CCSID  <- Last change ->
 Number Id              Library    File       Member            Date     Time
      8    1 JSONPARSE+ ./../headers/JSONPARSER.rpgle     1252  23-10-18 02:00:05
          * * * * *   E N D   O F   / C O P Y   M E M B E R S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     31
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          No references in the source.
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
          *INLR             N(1)                 1165M
 *RNF7031 JSON_AFTER_SIBLING...
                            CONST                 384D
 *RNF7031 JSON_ALLOW_PRIMITIVES...
                            CONST                  68D
 *RNF7031 JSON_ALLROWS      CONST                 818D
 *RNF7031 JSON_APPROXIMATE_TOTALROWS...
                            CONST                 835D
 *RNF7031 JSON_ARRAY        CONST                  51D
 *RNF7031 JSON_ARRAYAPPEND  *(16)                 455D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYPUSH    *(16)                 441D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSLICE   *(16)                 465D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSORT    *(16)                 477D
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXT   A(32767)              567D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXTMEM...
                            U(10,0)               573D
                            PROTOTYPE
 *RNF7031 JSON_ASTEXT       A(32767)             1015D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXT    A(32767)              596D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXTMEM U(10,0)               601D
                            PROTOTYPE
 *RNF7031 JSON_BEFORE_SIBLING...
                            CONST                 383D
 *RNF7031 JSON_BY_CONTEXT   CONST                  60D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     32
 *RNF7031 JSON_CHILD_LIST   CONST                  88D
 *RNF7031 JSON_CLEAR        PROTOTYPE             740D
 *RNF7031 JSON_CLONEFORMAT  PROTOTYPE             547D
          JSON_CLOSE        PROTOTYPE             745D   1161M
 *RNF7031 JSON_COPY         PROTOTYPE             984D
 *RNF7031 JSON_COPY_CLONE   CONST                 452D
 *RNF7031 JSON_COPYVALUE    *(16)                 360D
                            PROTOTYPE
 *RNF7031 JSON_DELETE       PROTOTYPE            1003D
 *RNF7031 JSON_DELIMITERDS  DS(11)                629D
                            BASED(PROTOTYPE+)
 *RNF7031   APOS            A(1)                  639D
 *RNF7031   BACKSLASH       A(1)                  631D
 *RNF7031   BLANK           A(1)                  635D
 *RNF7031   BRABEG          A(1)                  633D
 *RNF7031   BRAEND          A(1)                  634D
 *RNF7031   CURBEG          A(1)                  637D
 *RNF7031   CUREND          A(1)                  638D
 *RNF7031   DOT             A(1)                  636D
 *RNF7031   MASTERSPACE     A(1)                  632D
 *RNF7031   QUOT            A(1)                  640D
 *RNF7031   SLASH           A(1)                  630D
 *RNF7031 JSON_DELIMITERS   CONST                  44D
 *RNF7031 JSON_DONTREPLACE  CONST                 519D
 *RNF7031 JSON_DUMP         PROTOTYPE             541D
 *RNF7031 JSON_ELEMENTADD   *(16)                1051D
                            PROTOTYPE
 *RNF7031 JSON_ELEMENTCOPY  PROTOTYPE             993D
 *RNF7031 JSON_ELEMENTDELETE...
                            PROTOTYPE            1009D
 *RNF7031 JSON_ELEMENTTYPE  I(5,0)               1044D
                            PROTOTYPE
 *RNF7031 JSON_ERROR        N(1)                  116D
                            PROTOTYPE
 *RNF7031 JSON_EVAL         CONST                  52D
 *RNF7031 JSON_FIELDS       CONST                 826D
 *RNF7031 JSON_FIRST_CHILD  CONST                 381D
 *RNF7031 JSON_FOREACH      N(1)                  680D
                            PROTOTYPE
 *RNF7031 JSON_GETATTR      A(32767)             1094D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETATTRFIRST *(16)                 722D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNAME  A(32767)              733D
                            VARYING(2)
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     33
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNEXT  *(16)                 728D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRVALUE A(32767)              704D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETCHILD     *(16)                 189D
                            PROTOTYPE
 *RNF7031 JSON_GETDELIMITERS...
                            *(16)                  36D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMCHILD *(16)                1071D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNAME  A(32767)             1078D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNEXT  *(16)                1064D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMVALUE A(32767)             1085D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETILOBVALUE N(1)                  351D
                            PROTOTYPE
 *RNF7031 JSON_GETINT       I(20,0)               340D
                            PROTOTYPE
 *RNF7031 JSON_GETLENGTH    I(10,0)               503D
                            PROTOTYPE
 *RNF7031 JSON_GETNAME      A(32767)              285D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNAMEASPATH...
                            A(32767)              291D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNEXT      *(16)                 183D
                            PROTOTYPE
 *RNF7031 JSON_GETNODEATTRVALUE...
                            A(32767)              685D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNUM       P(30,15)              331D
                            PROTOTYPE
 *RNF7031 JSON_GETPARENT    *(16)                 195D
                            PROTOTYPE
 *RNF7031 JSON_GETSTR       A(32767)              308D
                            VARYING(2)
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     34
                            PROTOTYPE
 *RNF7031 JSON_GETSTRJOIN   A(32767)              318D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUE     A(32767)              974D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUENUM  P(30,15)              270D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUEPTR  *(16)                 278D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUESTR  A(32767)              262D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_HAS          N(1)                  145D
                            PROTOTYPE
 *RNF7031 JSON_HTTPREQUEST  *(16)                 954D
                            PROTOTYPE
 *RNF7031 JSON_IGNORE_CASE  CONST                 500D
 *RNF7031 JSON_ISNODE       N(1)                  169D
                            PROTOTYPE
 *RNF7031 JSON_ISNULL       N(1)                  161D
                            PROTOTYPE
 *RNF7031 JSON_ISTRUE       N(1)                  153D
                            PROTOTYPE
          JSON_ITERATOR     DS(145)               644D    662     670     681
                            BASED(PROTOTYPE+)
 *RNF7031   BREAK           N(1)                  658D
 *RNF7031   COMMA           A(1)                  651D
                            VARYING(2)
 *RNF7031   COUNT           I(10,0)               652D
 *RNF7031   FILLER          A(64)                 659D
 *RNF7031   ISFIRST         N(1)                  648D
 *RNF7031   ISLAST          N(1)                  649D
 *RNF7031   ISLIST          N(1)                  647D
 *RNF7031   ISRECURSIVE     N(1)                  650D
 *RNF7031   LENGTH          I(10,0)               653D
 *RNF7031   LISTARR         *(16)                 656D
 *RNF7031   ROOT            *(16)                 645D
 *RNF7031   SIZE            I(10,0)               654D
 *RNF7031   THIS            *(16)                 646D
 *RNF7031 JSON_LAST_CHILD   CONST                 382D
 *RNF7031 JSON_LITERAL      CONST                  56D
 *RNF7031 JSON_LOCATE       *(16)                 128D
                            PROTOTYPE
 *RNF7031 JSON_LOCATEORCREATE...
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     35
                            *(16)                 136D
                            PROTOTYPE
 *RNF7031 JSON_LOOKUPVALUE  *(16)                 489D
                            PROTOTYPE
 *RNF7031 JSON_MAPIX        N(1)                  774D
                            PROTOTYPE
 *RNF7031 JSON_MEMLEAK      N(1)                  750D
                            PROTOTYPE
 *RNF7031 JSON_MEMSTAT      PROTOTYPE             754D
 *RNF7031 JSON_MEMUSE       U(20,0)               758D
                            PROTOTYPE
 *RNF7031 JSON_MERGE        *(16)                 509D
                            PROTOTYPE
 *RNF7031 JSON_MERGEOBJECTS *(16)                 523D
                            PROTOTYPE
 *RNF7031 JSON_MESSAGE      A(1024)               122D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_META         CONST                 824D
 *RNF7031 JSON_MOVE_MODES   CONST                  66D
 *RNF7031 JSON_MOVE_UNLINK  CONST                 451D
 *RNF7031 JSON_MOVEOBJECTINTO...
                            *(16)                 533D
                            PROTOTYPE
 *RNF7031 JSON_NEWARRAY     *(16)                 435D
                            PROTOTYPE
 *RNF7031 JSON_NEWOBJECT    *(16)                 428D
                            PROTOTYPE
 *RNF7031 JSON_NODEADD      *(16)                 392D
                            PROTOTYPE
 *RNF7031 JSON_NODECHECKSUM U(10,0)               423D
                            PROTOTYPE
 *RNF7031 JSON_NODECLONE    *(16)                 386D
                            PROTOTYPE
 *RNF7031 JSON_NODECOPY     PROTOTYPE             371D
 *RNF7031 JSON_NODEDELETE   PROTOTYPE             405D
 *RNF7031 JSON_NODERENAME   N(1)                  175D
                            PROTOTYPE
 *RNF7031 JSON_NODESANITIZE PROTOTYPE             416D
 *RNF7031 JSON_NODETYPE     I(5,0)                300D
                            PROTOTYPE
 *RNF7031 JSON_NODEUNLINK   *(16)                 411D
                            PROTOTYPE
 *RNF7031 JSON_OBJCOPY      CONST                  59D
 *RNF7031 JSON_OBJECT       CONST                  50D
 *RNF7031 JSON_OBJLINK      CONST                  57D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     36
 *RNF7031 JSON_OBJMOVE      CONST                  61D
 *RNF7031 JSON_OBJREPLACE   CONST                  58D
 *RNF7031 JSON_PARSE        CONST                  72D
 *RNF7031 JSON_PARSEFILE    *(16)                  92D
                            PROTOTYPE
 *RNF7031 JSON_PARSESTRING  *(16)                 100D
                            PROTOTYPE
 *RNF7031 JSON_POINTER_VALUE...
                            CONST                  53D
 *RNF7031 JSON_REPLACE      CONST                 520D
 *RNF7031 JSON_ROOT         CONST                  55D
 *RNF7031 JSON_ROWARRAY     CONST                 822D
 *RNF7031 JSON_SAME_CASE    CONST                 499D
 *RNF7031 JSON_SEGMENTDISPOSE...
                            PROTOTYPE             768D
 *RNF7031 JSON_SEGMENTSELECTNO...
                            *(16)                 762D
                            PROTOTYPE
 *RNF7031 JSON_SETATTRVALUE PROTOTYPE             712D
 *RNF7031 JSON_SETBOOL      *(16)                 233D
                            PROTOTYPE
 *RNF7031 JSON_SETCCSID     PROTOTYPE            1106D
 *RNF7031 JSON_SETDEC       *(16)                1114D
                            PROTOTYPE
 *RNF7031 JSON_SETDECPOINT  PROTOTYPE             108D
 *RNF7031 JSON_SETDELIMITERS...
                            PROTOTYPE              39D
 *RNF7031 JSON_SETEVAL      *(16)                 200D
                            PROTOTYPE
 *RNF7031 JSON_SETINT       *(16)                 215D
                            PROTOTYPE
 *RNF7031 JSON_SETITERATOR  DS(145)               662D
                            PROTOTYPE
 *RNF7031 JSON_SETNODEATTRVALUE...
                            PROTOTYPE             695D
 *RNF7031 JSON_SETNUM       *(16)                 224D
                            PROTOTYPE
 *RNF7031 JSON_SETPTR       *(16)                 242D
                            PROTOTYPE
 *RNF7031 JSON_SETRECURSIVEITERATOR...
                            DS(145)               670D
                            PROTOTYPE
 *RNF7031 JSON_SETSTR       *(16)                 206D
                            PROTOTYPE
 *RNF7031 JSON_SETVALUE     *(16)                 251D
                            PROTOTYPE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     37
 *RNF7031 JSON_SQLCLOSE     PROTOTYPE             881D
 *RNF7031 JSON_SQLCODE      I(10,0)               950D
                            PROTOTYPE
 *RNF7031 JSON_SQLCOLUMNS   I(10,0)               867D
                            PROTOTYPE
 *RNF7031 JSON_SQLCONNECT   *(16)                 940D
                            PROTOTYPE
          JSON_SQLDISCONNECT...
                            PROTOTYPE             946D   1162M
 *RNF7031 JSON_SQLEXEC      N(1)                  888D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHNEXT *(16)                 860D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHRELATIVE...
                            *(16)                 850D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETINSERTID...
                            I(10,0)               931D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETMETA   *(16)                 935D
                            PROTOTYPE
 *RNF7031 JSON_SQLINSERT    N(1)                  909D
                            PROTOTYPE
 *RNF7031 JSON_SQLOPEN      *(16)                 841D
                            PROTOTYPE
 *RNF7031 JSON_SQLRESULTROW *(16)                 795D
                            PROTOTYPE
          JSON_SQLRESULTSET *(16)                 804D   1153
                            PROTOTYPE
 *RNF7031 JSON_SQLROWS      I(10,0)               875D
                            PROTOTYPE
 *RNF7031 JSON_SQLSETOPTIONS...
                            PROTOTYPE             788D
 *RNF7031 JSON_SQLUPDATE    N(1)                  897D
                            PROTOTYPE
 *RNF7031 JSON_SQLUPSERT    N(1)                  919D
                            PROTOTYPE
 *RNF7031 JSON_STREAM       *(16)                 609D
                            PROTOTYPE
 *RNF7031 JSON_TOTALROWS    CONST                 829D
 *RNF7031 JSON_TRACESETID   PROTOTYPE             966D
 *RNF7031 JSON_UNKNOWN      CONST                  49D
 *RNF7031 JSON_UPPERCASE    CONST                 831D
 *RNF7031 JSON_USE_LOCALE   CONST                 486D
 *RNF7031 JSON_VALUE        CONST                  54D
 *RNF7031 JSON_WRITECSVSTMF PROTOTYPE             615D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     38
          JSON_WRITEJSONSTMF...
                            PROTOTYPE             555D   1156M
 *RNF7031 JSON_WRITESTMF    PROTOTYPE            1126D
 *RNF7031 JSON_WRITEXMLSTMF PROTOTYPE             584D
 *RNF7031 JSON_XPATHVALUE   A(32767)             1022D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_XPATHVALUENUM...
                            P(30,15)             1033D
                            PROTOTYPE
 *RNF7031 MO_MERGE_MATCH    CONST                  82D
 *RNF7031 MO_MERGE_NEW      CONST                  80D
 *RNF7031 MO_MERGE_REPLACE  CONST                  85D
          PROTOTYPE_ONLY    *(16)                 629     644
          PROWS             *(16)                1146D   1153M   1156    1161
          SQL               A(512)               1147D   1152M   1153
                            VARYING(2)
 *RNF7031 XML_WRITESTMF     PROTOTYPE            1136D
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
          LR                                     1165M
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     39
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          jx_Has                                  145
          jx_Dump                                 541
          jx_Error                                116
          jx_Clear                                740
          jx_Close                                745    1161
          jx_MapIx                                774
          jx_IsTrue                               153
          jx_IsNull                               161
          jx_isNode                               169
          jx_Stream                               609
          jx_MemUse                               758
          jx_Message                              122
          jx_GetNode                              128
          jx_NodeAdd                              392    1051
          jx_ForEach                              680
          jx_MemLeak                              750
          jx_MemStat                              754
          jx_sqlOpen                              841
          jx_sqlRows                              875
          jx_sqlExec                              888
          jx_sqlCode                              950
          jx_NodeCopy                             371     984     993
          jx_NewArray                             435
          jx_sqlClose                             881
          jx_SetCcsid                            1106
          jx_ParseFile                             92
          jx_CopyValue                            360
          jx_NodeClone                            386
          jx_NewObject                            428
          jx_ArrayPush                            441
          jx_ArraySort                            477
          jx_getLength                            503
          jx_NodeMerge                            509
          jx_AsXmlText                            596
          jx_sqlUpdate                            897
          jx_sqlInsert                            909
          jx_sqlUpsert                            919
          jx_NodeRename                           175
          jx_GetValueVC                           308     974    1023
          jx_NodeDelete                           405    1003    1009
          jx_NodeUnlink                           411
          jx_ArraySlice                           465
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     40
          jx_AsJsonText                           568    1015
          jx_sqlColumns                           867
          jx_sqlGetMeta                           935
          jx_sqlConnect                           940
          jx_traceSetId                           966
          jx_ParseString                          100
          jx_SetDecPoint                          108
          jx_GetNodeNext                          183    1064
          jx_GetNodeType                          300    1044
          jx_GetValueNum                          331    1034
          jx_GetValueInt                          340
          jx_ArrayAppend                          455
          jx_lookupValue                          489
          jx_CloneFormat                          547
          jx_SetIterator                          663
          jx_GetAttrNext                          728
          jx_httpRequest                          954
          jx_GetNodeChild                         189    1071
          jx_SetStrByName                         206
          jx_SetIntByName                         215
          jx_SetDecByName                         224    1114
          jx_SetPtrByName                         242
          jx_GetStrJoinVC                         319
          jx_NodeSanitize                         416
          jx_NodeCheckSum                         423
          jx_MergeObjects                         523
          jx_NodeMoveInto                         533
          jx_WriteXmlStmf                         584    1136
          jx_AsXmlTextMem                         601
          jx_WriteCsvStmf                         615
          jx_SetAttrValue                         712
          jx_GetAttrFirst                         722
          jx_sqlResultRow                         795
          jx_sqlResultSet                         804    1153
          jx_sqlFetchNext                         860
          jx_GetDelimiters                         36
          jx_GetNodeParent                        195
          jx_SetEvalByName                        200
          jx_SetBoolByName                        233
          jx_GetNodeNameVC                        286    1079
          ILOB_XmlGetValue                        351
          jx_WriteJsonStmf                        555    1126    1158
          jx_AsJsonTextMem                        574
          jx_GetAttrNameVC                        734
          jx_sqlSetOptions                        788
          jx_sqlDisconnect                        946    1162
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     41
          jx_SetDelimiters2                        39
          jx_SetValueByName                       251
          jx_GetNodeValueVC                       263    1086
          jx_GetAttrValueVC                       705
          jx_SegmentDispose                       768
          jx_sqlGetInsertId                       931
          jx_GetOrCreateNode                      137
          jx_GetNodeValueNum                      271
          jx_GetNodeValuePtr                      278
          jx_SegmentSelectNo                      763
          jx_SetNodeAttrValue                     695
          jx_sqlFetchRelative                     851
          jx_GetNodeNameAsPath                    292
          jx_GetNodeAttrValueVC                   686    1095
          jx_SetRecursiveIterator                 672
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     42
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF7031 00    181 The name or indicator is not referenced.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL06A         DKSRV133   23-10-18 02:00:40        Page     43
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :      181
     Warning      (10) . . . . . . . :        0
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :      181
   Source Totals:
     Records . . . . . . . . . . . . :     1165
     Specifications  . . . . . . . . :      587
     Data records  . . . . . . . . . :        0
     Comments  . . . . . . . . . . . :      410
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program JSONSQL06A placed in library NOXDB. 00 highest severity. Created on 23-10-18 at 02:00:40.
           * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
