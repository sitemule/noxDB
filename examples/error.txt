  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     DKNLI
   Program  . . . . . . . . . . . . :   JSONSQL03
     Library  . . . . . . . . . . . :     NOXDB
   Text 'description' . . . . . . . :   *SRCMBRTXT
   Source stream file   . . . . . . :   JSONSQL03.RPGLE
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   24.09.19  09:25:23
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *UNREF     *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *OWNER
   Authority  . . . . . . . . . . . :   *USE
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
                                    :   /prj/noxdb
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1                                                                                                                      000001
      2    //------------------------------------------------------------- *                                                 000002
      3                                                                                                                      000003
      4    Ctl-Opt BndDir('NOXDB') dftactgrp(*NO) ACTGRP('QILE' );                                                           000004
      5                                                                                                                      000005
      6    //------------------------------------------------------------- *                                                 000006
      7                                                                                                                      000007
      8    /include 'headers/JSONPARSER.rpgle'                                                                               000008
         *--------------------------------------------------------------------------------------------*
         * RPG member name  . . . . . :  JSONPARSE+                                                   *                     1
         * External name  . . . . . . :  ./../headers/JSONPARSER.rpgle                                *                     1
         * Last change  . . . . . . . :  24.09.19  10:26:05                                           *                     1
         *--------------------------------------------------------------------------------------------*
      9+   //---------------------------------------------------------------------- *                                       1000001
     10+   //This is the prototype for BlueSeries/IceBreak - JSON and XML parser                                            1000002
     11+   //Use the JSONXML binddir when creating your program and include this                                            1000003
     12+   //prototypes like:                                                                                               1000004
     13+                                                                                                                    1000005
     14+   //H BNDDIR('JSONPARSER')                                                                                         1000006
     15+   ///include jsonParser                                                                                            1000007
     16+                                                                                                                    1000008
     17+   //Or                                                                                                             1000009
     18+                                                                                                                    1000010
     19+   //H BNDDIR('XMLPARSER')                                                                                          1000011
     20+   ///include xmlParser                                                                                             1000012
     21+                                                                                                                    1000013
     22+   //Note: Both XMLPARSER and JSONPARSER headers are autogenerated from                                             1000014
     23+   //the JSONXML header. so please do not make any changes th there headerfi                                        1000015
     24+                                                                                                                    1000016
     25+   //Note: all binddirectories JSONPARSER, XMLPARSER and JSONXML is the same                                        1000017
     26+   //---------------------------------------------------------------------- *                                       1000018
     27+ /if defined( json_DEF)                                                                                             1000019
             LINES EXCLUDED: 1
     28+ /endif                                                                                                             1000021
     29+ /define  json_DEF                                                                                                  1000022
     30+   //---------------------------------------------------------------------- *                                       1000023
     31+   //Before starting that parser - to enshure right enterpretations of delimi                                       1000024
     32+   //Usage:                                                                                                         1000025
     33+   //jx_setDelimiters( json_DELIMITERS);                                                                            1000026
     34+   //--------------------------------------------------------------------- *                                        1000027
     35+   //get delimiter pointer                                                                                          1000028
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page      3
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *NOSRCSTMT        *
         *                                       *DEBUGIO   *UNREF            *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *OWNER                       *
         *  Authority  . . . . . . . . . . . :   *USE                         *
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   NOXDB                        *
         *    Library  . . . . . . . . . . . :     *LIBL                      *
         *  Activation group . . . . . . . . :   QILE                         *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
         *--------------------------------------------------------------------*
     36+   Dcl-PR json_getDelimiters Pointer extproc(*CWIDEN :'jx_GetDelimiters');                                          1000029
     37+   End-PR;                                                                                                          1000030
     38+   //Set delimiter used for locate expression                                                                       1000031
     39+   Dcl-PR json_setDelimiters  extproc(*CWIDEN :'jx_SetDelimiters2');                                                1000032
     40+     //always: '/\@¢! .{}' in your  local CCSID                                                                     1000033
     41+     delimiterStr   Pointer    value options(*string);                                                              1000034
     42+   End-PR;                                                                                                          1000035
     43+                                                                                                                    1000036
     44+   Dcl-C json_DELIMITERS const('/\@¢! .{}''"');                                                                     1000037
     45+                                                                                                                    1000038
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page      4
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     46+   //---------------------------------------------------------------------- *                                       1000039
     47+   //Type of a node:                                                                                                1000040
     48+   //---------------------------------------------------------------------- *                                       1000041
     49+   Dcl-C json_UNKNOWN const(0);                                                                                     1000042
     50+   Dcl-C json_OBJECT  const(1);                                                                                     1000043
     51+   Dcl-C json_ARRAY   const(2);                                                                                     1000044
     52+   Dcl-C json_EVAL    const(3);                                                                                     1000045
     53+   Dcl-C json_POINTER_VALUE const(4);                                                                               1000046
     54+   Dcl-C json_VALUE   const(5);                                                                                     1000047
     55+   Dcl-C json_ROOT    const(6);                                                                                     1000048
     56+   Dcl-C json_LITERAL const(16);                                                                                    1000049
     57+   Dcl-C json_OBJLINK const(17);                                                                                    1000050
     58+   Dcl-C json_OBJREPLACE const(18);                                                                                 1000051
     59+   Dcl-C json_OBJCOPY const(18);                                                                                    1000052
     60+   Dcl-C json_BY_CONTEXT const(19);                                                                                 1000053
     61+   Dcl-C json_OBJMOVE const(2048);                                                                                  1000054
     62+                                                                                                                    1000055
     63+   //* Modifiers to "add" / "or" into "parseString" and "evaluate"                                                  1000056
     64+   //|| Type - have to be backwards compat.                                                                         1000057
     65+   //Unlink the source and move it to dest.                                                                         1000058
     66+   Dcl-C json_MOVE_MODES const(2048);                                                                               1000059
     67+   //Allow strings ints and other values to                                                                         1000060
     68+   Dcl-C json_ALLOW_PRIMITIVES const(4096);                                                                         1000061
     69+                                                                                                                    1000062
     70+   //* Combinations:                                                                                                1000063
     71+   //JX_PARSE  = json_EVAL + json_MOVE_NODES                                                                        1000064
     72+   Dcl-C json_PARSE   const(2051);                                                                                  1000065
     73+                                                                                                                    1000066
     74+   //Merge options:                                                                                                 1000067
     75+   //Modifiers to "add" / "or" into "JSON_EVAL"                                                                     1000068
     76+ /if not defined(MO_MERGE)                                                                                          1000069
     77+ /define  MO_MERGE                                                                                                  1000070
     78+   //Only new elements are merged - existing                                                                        1000071
     79+   //are left untouched                                                                                             1000072
     80+   Dcl-C MO_MERGE_NEW const(256);                                                                                   1000073
     81+   //Merge and replace only existing nodes.                                                                         1000074
     82+   Dcl-C MO_MERGE_MATCH const(512);                                                                                 1000075
     83+   //Merge all: replace if it exists and                                                                            1000076
     84+   //append new nodes if not exists                                                                                 1000077
     85+   Dcl-C MO_MERGE_REPLACE const(1024 );                                                                             1000078
     86+ /endif                                                                                                             1000079
     87+                                                                                                                    1000080
     88+   Dcl-C json_CHILD_LIST const('¢0!');                                                                              1000081
     89+                                                                                                                    1000082
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page      5
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     90+   //---------------------------------------------------------------------- *                                       1000083
     91+   //Returns node to the json_object tree                                                                           1000084
     92+   Dcl-PR json_ParseFile Pointer extproc(*CWIDEN:'jx_ParseFile');                                                   1000085
     93+     //File to parse                                                                                                1000086
     94+     FileName       Pointer    value options(*string);                                                              1000087
     95+     //Parsing options                                                                                              1000088
     96+     Options        Pointer    value options(*string:*nopass);                                                      1000089
     97+   End-PR;                                                                                                          1000090
     98+                                                                                                                    1000091
     99+   //Returns node json_object tree                                                                                  1000092
    100+   Dcl-PR json_ParseString Pointer extproc(*CWIDEN:'jx_ParseString');                                               1000093
    101+     //String to parse                                                                                              1000094
    102+     String         Pointer    value options(*string);                                                              1000095
    103+     //Parsing options                                                                                              1000096
    104+     Options        Pointer    value options(*string:*nopass);                                                      1000097
    105+   End-PR;                                                                                                          1000098
    106+                                                                                                                    1000099
    107+   //Set , or . for numeri decimal point                                                                            1000100
    108+   Dcl-PR json_setDecPoint  extproc(*CWIDEN : 'jx_SetDecPoint');                                                    1000101
    109+     //decimal point char                                                                                           1000102
    110+     decPoint       Pointer    value options(*string);                                                              1000103
    111+   End-PR;                                                                                                          1000104
    112+                                                                                                                    1000105
    113+   //Bool true if errors occures                                                                                    1000106
    114+   Dcl-PR json_Error Ind extproc(*CWIDEN:'jx_Error');                                                               1000107
    115+     //jx_Object  node                                                                                              1000108
    116+     pNode          Pointer    value;                                                                               1000109
    117+   End-PR;                                                                                                          1000110
    118+                                                                                                                    1000111
    119+   //Return error description                                                                                       1000112
    120+   Dcl-PR json_Message Varchar(1024) extproc(*CWIDEN:'jx_Message');                                                 1000113
    121+     //jx_Object                                                                                                    1000114
    122+     pNode          Pointer    value;                                                                               1000115
    123+   End-PR;                                                                                                          1000116
    124+                                                                                                                    1000117
    125+   // Without parameters you will get the last internal error                                                       1000118
    126+   // Otherwise it will format an error object                                                                      1000119
    127+   Dcl-PR json_GetMessageObject Pointer //Return error description                                  I               1000120
    128+                              extproc(*CWIDEN:'jx_GetMessageObject');                                               1000121
    129+     MessageId      Pointer    value options(*string:*nopass);                                      I               1000122
    130+     MessageData    Pointer    value options(*string:*nopass);                                      I               1000123
    131+   End-PR;                                                                                                          1000124
    132+                                                                                                                    1000125
    133+   // simple courtesy function to return a {"success":true} object                                                  1000126
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page      6
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    134+   //Return success:true object                                                                                     1000127
    135+   Dcl-PR json_SuccessTrue Pointer extproc(*CWIDEN:'jx_SuccessTrue');                               I               1000128
    136+     MessageId      Pointer    value options(*string:*nopass);                                      I               1000129
    137+     MessageData    Pointer    value options(*string:*nopass);                                      I               1000130
    138+   End-PR;                                                                                                          1000131
    139+                                                                                                                    1000132
    140+   //Returns pointer to node                                                                                        1000133
    141+   Dcl-PR json_Locate Pointer extproc(*CWIDEN : 'jx_GetNode');                                                      1000134
    142+     //Pointer to tree or node                                                                                      1000135
    143+     pNode          Pointer    value;                                                                               1000136
    144+     //location expression                                                                                          1000137
    145+     Expression     Pointer    value options(*string);                                                              1000138
    146+   End-PR;                                                                                                          1000139
    147+                                                                                                                    1000140
    148+   //Returns pointer to node                                                                                        1000141
    149+   Dcl-PR json_LocateOrCreate Pointer                                                                               1000142
    150+                            extproc(*CWIDEN : 'jx_GetOrCreateNode');                                                1000143
    151+     //Pointer to tree or node                                                                                      1000144
    152+     pNode          Pointer    value;                                                                               1000145
    153+     //location expression                                                                                          1000146
    154+     Expression     Pointer    value options(*string);                                                              1000147
    155+   End-PR;                                                                                                          1000148
    156+                                                                                                                    1000149
    157+   //Returns 'ON' if node exists                                                                                    1000150
    158+   Dcl-PR json_Has Ind extproc(*CWIDEN : 'jx_Has');                                                                 1000151
    159+     //Pointer to tree or node                                                                                      1000152
    160+     pNode          Pointer    value;                                                                               1000153
    161+     //Path to node                                                                                                 1000154
    162+     NodeName       Pointer    value options(*string);                                                              1000155
    163+   End-PR;                                                                                                          1000156
    164+                                                                                                                    1000157
    165+   //Returns 'ON' if node exists and has <> 0                                                                       1000158
    166+   Dcl-PR json_isTrue Ind extproc(*CWIDEN : 'jx_IsTrue');                                                           1000159
    167+     //Pointer to tree or node                                                                                      1000160
    168+     pNode          Pointer    value;                                                                               1000161
    169+     //Path to node                                                                                                 1000162
    170+     NodeName       Pointer    value options(*string);                                                              1000163
    171+   End-PR;                                                                                                          1000164
    172+                                                                                                                    1000165
    173+   //Returns 'ON' if node exists and has <> 0                                                                       1000166
    174+   Dcl-PR json_isNull Ind extproc(*CWIDEN : 'jx_IsNull');                                                           1000167
    175+     //Pointer to tree or node                                                                                      1000168
    176+     pNode          Pointer    value;                                                                               1000169
    177+     //Path to node                                                                                                 1000170
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page      7
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    178+     NodeName       Pointer    value options(*string);                                                              1000171
    179+   End-PR;                                                                                                          1000172
    180+                                                                                                                    1000173
    181+   //Returns 'ON' if it is a valid node                                                                             1000174
    182+   Dcl-PR json_isNode Ind extproc(*CWIDEN : 'jx_isNode');                                                           1000175
    183+     //a.k.a. false for strings                                                                                     1000176
    184+     pNode          Pointer    value;                                                                               1000177
    185+   End-PR;                                                                                                          1000178
    186+                                                                                                                    1000179
    187+   //renames the node name                                                                                          1000180
    188+   Dcl-PR json_NodeRename Ind extproc(*CWIDEN : 'jx_NodeRename');                                                   1000181
    189+     //Pointer to tree or node                                                                                      1000182
    190+     pNode          Pointer    value;                                                                               1000183
    191+     //Path to node                                                                                                 1000184
    192+     NodeName       Pointer    value options(*string);                                                              1000185
    193+   End-PR;                                                                                                          1000186
    194+                                                                                                                    1000187
    195+   //Returns pointer to next sibling (elem)                                                                         1000188
    196+   Dcl-PR json_GetNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                                 1000189
    197+     //Pointer to current node (elem)                                                                               1000190
    198+     pNode          Pointer    value;                                                                               1000191
    199+   End-PR;                                                                                                          1000192
    200+                                                                                                                    1000193
    201+   //Returns pointer to first child (elem)                                                                          1000194
    202+   Dcl-PR json_GetChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                                               1000195
    203+     //Pointer to current node (elem)                                                                               1000196
    204+     pNode          Pointer    value;                                                                               1000197
    205+   End-PR;                                                                                                          1000198
    206+                                                                                                                    1000199
    207+   //Returns pointer to parent node                                                                                 1000200
    208+   Dcl-PR json_GetParent Pointer extproc(*CWIDEN : 'jx_GetNodeParent');                                             1000201
    209+     //Pointer to current node (elem)                                                                               1000202
    210+     pNode          Pointer    value;                                                                               1000203
    211+   End-PR;                                                                                                          1000204
    212+                                                                                                                    1000205
    213+   // Create or replace a node with no value ( null value)                                                          1000206
    214+   Dcl-PR json_SetNull Pointer extproc(*CWIDEN: 'jx_SetNullByName');                                                1000207
    215+     //Pointer to json_ tree                                                                                        1000208
    216+     pNode          Pointer    value;                                                                               1000209
    217+     //Location expression to node or attributes                                                                    1000210
    218+     Expresion      Pointer    value options(*string);                                                              1000211
    219+   End-PR;                                                                                                          1000212
    220+                                                                                                                    1000213
    221+   Dcl-PR json_SetEval pointer extproc(*CWIDEN:'jx_SetEvalByName');                                                 1000214
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page      8
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    222+     pNode          Pointer    value;                                                                               1000215
    223+     Expresion      Pointer    value options(*string);                                                              1000216
    224+     Value          Pointer    value options(*string);                                                              1000217
    225+   End-PR;                                                                                                          1000218
    226+                                                                                                                    1000219
    227+   Dcl-PR json_SetStr Pointer extproc(*CWIDEN: 'jx_SetStrByName');                                                  1000220
    228+     //Pointer to json_ tree                                                                                        1000221
    229+     pNode          Pointer    value;                                                                               1000222
    230+     //Location expression to node or attributes                                                                    1000223
    231+     Expresion      Pointer    value options(*string);                                                              1000224
    232+     //New value to set / pointer to object                                                                         1000225
    233+     Value          Pointer    value options(*string);                                                              1000226
    234+   End-PR;                                                                                                          1000227
    235+                                                                                                                    1000228
    236+   Dcl-PR json_SetInt Pointer extproc(*CWIDEN: 'jx_SetIntByName');                                                  1000229
    237+     //Pointer to json_ tree                                                                                        1000230
    238+     pNode          Pointer    value;                                                                               1000231
    239+     //Location expression to node or attributes                                                                    1000232
    240+     Expresion      Pointer    value options(*string);                                                              1000233
    241+     //New value to set / pointer to object                                                                         1000234
    242+     Value          Int(10)    value;                                                                               1000235
    243+   End-PR;                                                                                                          1000236
    244+                                                                                                                    1000237
    245+   Dcl-PR json_SetNum Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  1000238
    246+     //Pointer to json_ tree                                                                                        1000239
    247+     pNode          Pointer    value;                                                                               1000240
    248+     //Location expression to node or attributes                                                                    1000241
    249+     Expresion      Pointer    value options(*string);                                                              1000242
    250+     //New value to set / pointer to object                                                                         1000243
    251+     Value          Packed(30:15) value;                                                                            1000244
    252+   End-PR;                                                                                                          1000245
    253+                                                                                                                    1000246
    254+   Dcl-PR json_SetBool Pointer extproc(*CWIDEN: 'jx_SetBoolByName');                                                1000247
    255+     //Pointer to json_ tree                                                                                        1000248
    256+     pNode          Pointer    value;                                                                               1000249
    257+     //Location expression to node or attributes                                                                    1000250
    258+     Expresion      Pointer    value options(*string);                                                              1000251
    259+     //New value to set / pointer to object                                                                         1000252
    260+     Value          Ind        value;                                                                               1000253
    261+   End-PR;                                                                                                          1000254
    262+                                                                                                                    1000255
    263+   Dcl-PR json_SetPtr Pointer extproc(*CWIDEN: 'jx_SetPtrByName');                                                  1000256
    264+     //Pointer to json_ tree                                                                                        1000257
    265+     pNode          Pointer    value;                                                                               1000258
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page      9
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    266+     //Location expression to node or attributes                                                                    1000259
    267+     Expresion      Pointer    value options(*string);                                                              1000260
    268+     //Pointer to anything - You do the cleanup                                                                     1000261
    269+     Value          Pointer    value;                                                                               1000262
    270+   End-PR;                                                                                                          1000263
    271+                                                                                                                    1000264
    272+   Dcl-PR json_SetProcPtr Pointer extproc(*CWIDEN: 'jx_SetPtrByName');                                              1000265
    273+     pNode          Pointer    value; //Pointer to json_ tree                                                       1000266
    274+     //Location expression to node or attributes                                                                    1000267
    275+     Expresion      Pointer    value options(*string);                                                              1000268
    276+     Proc           Pointer(*Proc); //Pointer to a procedure                                                        1000269
    277+     //*ON=String escape, *OFF=If literals                                                                          1000270
    278+     isString       Ind        value options(*nopass);                                                              1000271
    279+   End-PR;                                                                                                          1000272
    280+                                                                                                                    1000273
    281+   Dcl-PR json_SetValue Pointer extproc(*CWIDEN: 'jx_SetValueByName');                                              1000274
    282+     //Pointer to json_ tree                                                                                        1000275
    283+     pNode          Pointer    value;                                                                               1000276
    284+     //Location expression to node or attributes                                                                    1000277
    285+     Expresion      Pointer    value options(*string);                                                              1000278
    286+     //New value to set / pointer to object                                                                         1000279
    287+     Value          Pointer    value options(*string:*nopass);                                                      1000280
    288+     //Optional new type (Refer "node type"                                                                         1000281
    289+     Type           Uns(5)     value options(*nopass);                                                              1000282
    290+   End-PR;                                                                                                          1000283
    291+                                                                                                                    1000284
    292+   Dcl-PR json_GetValueStr Varchar(32767)                                                                           1000285
    293+                         extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                    1000286
    294+     //Pointer to node                                                                                              1000287
    295+     pNode          Pointer    value;                                                                               1000288
    296+     //If not found - default value                                                                                 1000289
    297+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000290
    298+   End-PR;                                                                                                          1000291
    299+                                                                                                                    1000292
    300+   Dcl-PR json_GetValueNum Packed(30:15)                                                                            1000293
    301+                         extproc(*CWIDEN : 'jx_GetNodeValueNum');                                                   1000294
    302+     //Pointer to node                                                                                              1000295
    303+     pNode          Pointer    value;                                                                               1000296
    304+     //If not found - default value                                                                                 1000297
    305+     Defaultvalue   Packed(30:15) value options(*NOPASS);                                                           1000298
    306+   End-PR;                                                                                                          1000299
    307+                                                                                                                    1000300
    308+   Dcl-PR json_GetValueInt Int(20) extproc(*CWIDEN : 'jx_GetNodeValueInt');                         I               1000301
    309+     pNode          Pointer    value; //Pointer to node                                             I               1000302
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     10
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    310+     //If not found - default value                                                                                 1000303
    311+     Defaultvalue   Int(20)    value options(*NOPASS);                                              I               1000304
    312+   End-PR;                                                                                                          1000305
    313+                                                                                                                    1000306
    314+   Dcl-PR json_GetValuePtr Pointer extproc(*CWIDEN : 'jx_GetNodeValuePtr');                                         1000307
    315+     //Pointer to node                                                                                              1000308
    316+     pNode          Pointer    value;                                                                               1000309
    317+     //If not found - default value                                                                                 1000310
    318+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000311
    319+   End-PR;                                                                                                          1000312
    320+                                                                                                                    1000313
    321+   Dcl-PR json_GetName Varchar(32767)                                                                               1000314
    322+                     extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                         1000315
    323+     //Pointer to node                                                                                              1000316
    324+     pNode          Pointer    value;                                                                               1000317
    325+   End-PR;                                                                                                          1000318
    326+                                                                                                                    1000319
    327+   Dcl-PR json_GetNameAsPath Varchar(32767)                                                                         1000320
    328+                           extproc(*CWIDEN : 'jx_GetNodeNameAsPath');                                               1000321
    329+     //Pointer to node                                                                                              1000322
    330+     pNode          Pointer    value;                                                                               1000323
    331+     //Delimiter like - or . or / or \                                                                              1000324
    332+     Delimiter      Char(1)    value;                                                                               1000325
    333+   End-PR;                                                                                                          1000326
    334+                                                                                                                    1000327
    335+   //* Refer to node type above                                                                                     1000328
    336+   Dcl-PR json_NodeType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                                 1000329
    337+     //Pointer to json_ tree to receive format                                                                      1000330
    338+     pNode          Pointer    value;                                                                               1000331
    339+   End-PR;                                                                                                          1000332
    340+                                                                                                                    1000333
    341+ // Get string by expresion                                                                                         1000334
    342+ //  /object/array¢123!/name                                                                                        1000335
    343+ //  .object.array¢123!.name                                                                                        1000336
    344+   Dcl-PR json_GetStr Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                            1000337
    345+     //Pointer to relative node                                                                                     1000338
    346+     pNode          Pointer    value;                                                                               1000339
    347+     //Locations expression to node                                                                                 1000340
    348+     Expression     Pointer    value options(*string:*nopass);                                                      1000341
    349+     //If not found - default value                                                                                 1000342
    350+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000343
    351+   End-PR;                                                                                                          1000344
    352+                                                                                                                    1000345
    353+ //  will join all subsequent array nodes into one resulting string                                                 1000346
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    354+   Dcl-PR json_GetStrJoin Varchar(32767)                                                                            1000347
    355+                        extproc(*CWIDEN : 'jx_GetStrJoinVC');                                                       1000348
    356+     //Pointer to relative node                                                                                     1000349
    357+     pNode          Pointer    value;                                                                               1000350
    358+     //Locations expression to node                                                                                 1000351
    359+     Expression     Pointer    value options(*string:*nopass);                                                      1000352
    360+     //If not found - default value                                                                                 1000353
    361+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000354
    362+   End-PR;                                                                                                          1000355
    363+                                                                                                                    1000356
    364+ // Get number by expresion like:                                                                                   1000357
    365+ //  /object/array¢123!/name                                                                                        1000358
    366+ //  .object.array¢123!.name                                                                                        1000359
    367+   Dcl-PR json_GetNum Packed(30:15) extproc(*CWIDEN : 'jx_GetValueNum');                                            1000360
    368+     //Pointer to relative node                                                                                     1000361
    369+     pNode          Pointer    value;                                                                               1000362
    370+     //Locations expression to node                                                                                 1000363
    371+     Expression     Pointer    value options(*string:*nopass);                                                      1000364
    372+     //If not found - default value                                                                                 1000365
    373+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           1000366
    374+   End-PR;                                                                                                          1000367
    375+                                                                                                                    1000368
    376+   Dcl-PR json_GetInt Int(20) extproc(*CWIDEN : 'jx_GetValueInt');                                                  1000369
    377+     //Pointer to relative node                                                                                     1000370
    378+     pNode          Pointer    value;                                                                               1000371
    379+     //Locations expression to node                                                                                 1000372
    380+     Expression     Pointer    value options(*string:*nopass);                                                      1000373
    381+     //If not found - default value                                                                                 1000374
    382+     Defaultvalue   Int(20)    value options(*nopass);                                                              1000375
    383+   End-PR;                                                                                                          1000376
    384+                                                                                                                    1000377
    385+   //Set an ILOB object to a value found by X                                                                       1000378
    386+   //Return *ON if found                                                                                            1000379
    387+   Dcl-PR json_GetIlobValue Ind extproc(*CWIDEN :'ILOB_XmlGetValue');                                               1000380
    388+     //Pointer to ILOB object to receive the va                                                                     1000381
    389+     pIlob          Pointer    value;                                                                               1000382
    390+     //Pointer to tree                                                                                              1000383
    391+     pNode          Pointer    value;                                                                               1000384
    392+     //Location expression to node or attributes                                                                    1000385
    393+     Expression     Pointer    value options(*string);                                                              1000386
    394+   End-PR;                                                                                                          1000387
    395+                                                                                                                    1000388
    396+   Dcl-PR json_CopyValue Pointer extproc(*CWIDEN : 'jx_CopyValue');                                                 1000389
    397+     //destination node                                                                                             1000390
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    398+     pDest          Pointer    value;                                                                               1000391
    399+     //destiantion name (or *NULL or '')                                                                            1000392
    400+     destName       Pointer    value options(*string);                                                              1000393
    401+     //source node                                                                                                  1000394
    402+     pSource        Pointer    value;                                                                               1000395
    403+     //source name (or *NULL or '')                                                                                 1000396
    404+     sourceName     Pointer    value options(*string);                                                              1000397
    405+   End-PR;                                                                                                          1000398
    406+                                                                                                                    1000399
    407+   Dcl-PR json_NodeCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                           1000400
    408+     //node. Retrive from Locate()                                                                                  1000401
    409+     pRootNode      Pointer    value;                                                                               1000402
    410+     //node. Retrive from Locate()                                                                                  1000403
    411+     pNewChild      Pointer    value;                                                                               1000404
    412+     //Reference location to where it arrive                                                                        1000405
    413+     RefLocation    Int(10)    value;                                                                               1000406
    414+   End-PR;                                                                                                          1000407
    415+                                                                                                                    1000408
    416+   //Following constants used by json_NodeCopy:RefLocation                                                          1000409
    417+   Dcl-C json_FIRST_CHILD const(1);                                                                                 1000410
    418+   Dcl-C json_LAST_CHILD const(2);                                                                                  1000411
    419+   Dcl-C json_BEFORE_SIBLING const(3);                                                                              1000412
    420+   Dcl-C json_AFTER_SIBLING const(4);                                                                               1000413
    421+                                                                                                                    1000414
    422+   Dcl-PR json_NodeClone Pointer extproc(*CWIDEN : 'jx_NodeClone');                                                 1000415
    423+     //node. Retrive from Locate()                                                                                  1000416
    424+     pSource        Pointer    value;                                                                               1000417
    425+   End-PR;                                                                                                          1000418
    426+                                                                                                                    1000419
    427+   //returns the new node                                                                                           1000420
    428+   Dcl-PR json_NodeAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                     1000421
    429+     //node. Retrive from Locate()                                                                                  1000422
    430+     pRootNode      Pointer    value;                                                                               1000423
    431+     //Reference location to where it arrive                                                                        1000424
    432+     RefLocation    Int(10)    value;                                                                               1000425
    433+     //Name of node                                                                                                 1000426
    434+     Name           Pointer    value options(*string);                                                              1000427
    435+     //Value or expression                                                                                          1000428
    436+     Value          Pointer    value options(*string);                                                              1000429
    437+     //New type (Refer "node type"                                                                                  1000430
    438+     Type           Uns(5)     value;                                                                               1000431
    439+   End-PR;                                                                                                          1000432
    440+                                                                                                                    1000433
    441+   Dcl-PR json_NodeDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                       1000434
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    442+     //node. Retrive from Locate()                                                                                  1000435
    443+     pRootNode      Pointer    value;                                                                               1000436
    444+   End-PR;                                                                                                          1000437
    445+                                                                                                                    1000438
    446+   //Unlink the note from its previous and promote it as a new root node                                            1000439
    447+   Dcl-PR json_NodeUnlink Pointer extproc(*CWIDEN : 'jx_NodeUnlink');                                               1000440
    448+     //Targenode. Retrive from Locate(                                                                              1000441
    449+     pNode          Pointer    value;                                                                               1000442
    450+   End-PR;                                                                                                          1000443
    451+                                                                                                                    1000444
    452+   Dcl-PR json_NodeSanitize extproc(*CWIDEN : 'jx_NodeSanitize');                                                   1000445
    453+     //node. Retrive from Locate()                                                                                  1000446
    454+     pRootNode      Pointer    value;                                                                               1000447
    455+   End-PR;                                                                                                          1000448
    456+                                                                                                                    1000449
    457+   //CheckSum of all names and values                                                                               1000450
    458+   //Delete all nodes which value are null                                                                          1000451
    459+   Dcl-PR json_NodeCheckSum Uns(10) extproc(*CWIDEN : 'jx_NodeCheckSum');                                           1000452
    460+     pRootNode      Pointer    value; //node. Retrive from Locate()                                                 1000453
    461+   End-PR;                                                                                                          1000454
    462+                                                                                                                    1000455
    463+   //returns the new node                                                                                           1000456
    464+   Dcl-PR json_NewObject Pointer extproc(*CWIDEN : 'jx_NewObject');                                                 1000457
    465+     //Destination. Retrive from Locate()                                                                           1000458
    466+     pDestNode      Pointer    value options(*nopass);                                                              1000459
    467+   End-PR;                                                                                                          1000460
    468+                                                                                                                    1000461
    469+ // Array functions                                                                                                 1000462
    470+   //returns the new node                                                                                           1000463
    471+   Dcl-PR json_NewArray Pointer extproc(*CWIDEN : 'jx_NewArray');                                                   1000464
    472+     //Destination. Retrive from Locate()                                                                           1000465
    473+     pDestNode      Pointer    value options(*nopass);                                                              1000466
    474+   End-PR;                                                                                                          1000467
    475+                                                                                                                    1000468
    476+   //returns the new node added to the end of                                                                       1000469
    477+   Dcl-PR json_ArrayPush Pointer extproc(*CWIDEN : 'jx_ArrayPush');                                                 1000470
    478+     //Destination. Retrive from Locate()                                                                           1000471
    479+     pDestArray     Pointer    value;                                                                               1000472
    480+     //source node to append                                                                                        1000473
    481+     pSourceNode    Pointer    value options(*string);                                                              1000474
    482+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000475
    483+     copy           Uns(5)     value options(*nopass);                                                              1000476
    484+   End-PR;                                                                                                          1000477
    485+                                                                                                                    1000478
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    486+   //Following constants used by json_ArrayPush:copy                                                                1000479
    487+   Dcl-C json_MOVE_UNLINK const(0);                                                                                 1000480
    488+   Dcl-C json_COPY_CLONE const(1);                                                                                  1000481
    489+                                                                                                                    1000482
    490+   //returns the new node added to the end of                                                                       1000483
    491+   Dcl-PR json_ArrayAppend Pointer extproc(*CWIDEN :'jx_ArrayAppend');                                              1000484
    492+     //Destination. Retrive from Locate()                                                                           1000485
    493+     pDestArray     Pointer    value;                                                                               1000486
    494+     //source node to append                                                                                        1000487
    495+     pSourceNode    Pointer    value options(*string);                                                              1000488
    496+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000489
    497+     copy           Uns(5)     value options(*nopass);                                                              1000490
    498+   End-PR;                                                                                                          1000491
    499+                                                                                                                    1000492
    500+   //returns the new array fro source array                                                                         1000493
    501+   Dcl-PR json_ArraySlice Pointer extproc(*CWIDEN : 'jx_ArraySlice' );                                              1000494
    502+     //source node or array string                                                                                  1000495
    503+     pSourceNode    Pointer    value options(*string);                                                              1000496
    504+     //From entry ( 1=First)                                                                                        1000497
    505+     from           Int(10)    value;                                                                               1000498
    506+     //To and includ   (-1 = Until end)                                                                             1000499
    507+     to             Int(10)    value;                                                                               1000500
    508+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000501
    509+     copy           Uns(5)     value options(*nopass);                                                              1000502
    510+   End-PR;                                                                                                          1000503
    511+                                                                                                                    1000504
    512+   //returns the new node added to the end of                                                                       1000505
    513+   Dcl-PR json_ArraySort Pointer extproc(*CWIDEN : 'jx_ArraySort');                                                 1000506
    514+     //Destination. Retrive from Locate()                                                                           1000507
    515+     pArray         Pointer    value;                                                                               1000508
    516+     //nodenames if any in subobject to comapre                                                                     1000509
    517+     pkeyNames      Pointer    value options(*string) ;                                                             1000510
    518+     //0=(Dft) use json numerics, 1=Use locale                                                                      1000511
    519+     options        uns(5)     value options(*nopass);                                                              1000512
    520+   End-PR;                                                                                                          1000513
    521+                                                                                                                    1000514
    522+   Dcl-C json_USE_LOCALE const(1);                                                                                  1000515
    523+                                                                                                                    1000516
    524+   //returns the first node with expr value                                                                         1000517
    525+   Dcl-PR json_LookupValue Pointer extproc(*CWIDEN : 'jx_lookupValue');                                             1000518
    526+     //Array/ obj to search                                                                                         1000519
    527+     pArray         Pointer    value;                                                                               1000520
    528+     //What to search for                                                                                           1000521
    529+     expr           Pointer    value options(*string);                                                              1000522
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    530+     //0=(Dft) Same case, 1=ignore case                                                                             1000523
    531+     ignoreCase     Uns(5)     value options(*nopass);                                                              1000524
    532+   End-PR;                                                                                                          1000525
    533+                                                                                                                    1000526
    534+   //Following constants used by json_LookupValue:ignoreCase                                                        1000527
    535+   Dcl-C json_SAME_CASE const(0);                                                                                   1000528
    536+   Dcl-C json_IGNORE_CASE const(1);                                                                                 1000529
    537+                                                                                                                    1000530
    538+   //returns numer of element in array or obj                                                                       1000531
    539+   Dcl-PR json_GetLength Int(10) extproc(*CWIDEN : 'jx_getLength'  );                                               1000532
    540+     //Array to count length                                                                                        1000533
    541+     pArray         Pointer    value;                                                                               1000534
    542+   End-PR;                                                                                                          1000535
    543+                                                                                                                    1000536
    544+   //returns the new node                                                                                           1000537
    545+   Dcl-PR json_Merge Pointer extproc(*CWIDEN : 'jx_NodeMerge');                                                     1000538
    546+     //Destination. Retrive from Locate()                                                                           1000539
    547+     pDestNode      Pointer    value;                                                                               1000540
    548+     //Source tree  Retrive from Locate()                                                                           1000541
    549+     pSourceNode    Pointer    value;                                                                               1000542
    550+     //Optional new type                                                                                            1000543
    551+     Type           Uns(5)     value options(*nopass);                                                              1000544
    552+   End-PR;                                                                                                          1000545
    553+                                                                                                                    1000546
    554+   //Following constants used by json_Merge:Type                                                                    1000547
    555+   Dcl-C json_DONTREPLACE const(0);                                                                                 1000548
    556+   Dcl-C json_REPLACE const(1);                                                                                     1000549
    557+                                                                                                                    1000550
    558+   //returns the new node                                                                                           1000551
    559+   Dcl-PR json_MergeObjects Pointer extproc(*CWIDEN : 'jx_MergeObjects');                                           1000552
    560+     //Destination. Retrive from Locate()                                                                           1000553
    561+     pDestObj       Pointer    value;                                                                               1000554
    562+     //Source tree  Retrive from Locate()                                                                           1000555
    563+     pSourceObj     Pointer    value;                                                                               1000556
    564+     //JX_DONTREPLACE or json_OBJREPLACE                                                                            1000557
    565+     Type           Uns(5)     value;                                                                               1000558
    566+   End-PR;                                                                                                          1000559
    567+                                                                                                                    1000560
    568+   //returns the source node                                                                                        1000561
    569+   Dcl-PR json_MoveObjectInto Pointer extproc(*CWIDEN : 'jx_NodeMoveInto');                                         1000562
    570+     //Destination. Retrive from Locate()                                                                           1000563
    571+     pDestObj       Pointer    value;                                                                               1000564
    572+     Name           Pointer    value options(*string);                                                              1000565
    573+     //Source tree  Retrive from Locate()                                                                           1000566
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    574+     pSourceObj     Pointer    value;                                                                               1000567
    575+   End-PR;                                                                                                          1000568
    576+                                                                                                                    1000569
    577+   Dcl-PR json_Dump  extproc(*CWIDEN : 'jx_Dump');                                                                  1000570
    578+     //Pointer to tree                                                                                              1000571
    579+     pNode          Pointer    value;                                                                               1000572
    580+   End-PR;                                                                                                          1000573
    581+                                                                                                                    1000574
    582+                                                                                                                    1000575
    583+   Dcl-PR json_CloneFormat  extproc(*CWIDEN : 'jx_CloneFormat');                                                    1000576
    584+     //Pointer to tree to receive format                                                                            1000577
    585+     pNode          Pointer    value;                                                                               1000578
    586+     //node ptr or path with right formating                                                                        1000579
    587+     pCloneFrom     Pointer    value options(*string);                                                              1000580
    588+   End-PR;                                                                                                          1000581
    589+                                                                                                                    1000582
    590+   //**  JSON renderes ***                                                                                          1000583
    591+   Dcl-PR json_WriteJsonStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                                1000584
    592+     //node. Retrive from Locate()                                                                                  1000585
    593+     pNode          Pointer    value;                                                                               1000586
    594+     //Name of output stream file                                                                                   1000587
    595+     FileName       Pointer    value options(*string);                                                              1000588
    596+     //Ccsid of output file                                                                                         1000589
    597+     Ccsid          Int(10)    value;                                                                               1000590
    598+     Trim           Ind        value;                                                                               1000591
    599+     //Extra options                                                                                                1000592
    600+     Options        Pointer    value options(*string:*nopass);                                                      1000593
    601+   End-PR;                                                                                                          1000594
    602+                                                                                                                    1000595
    603+   Dcl-PR json_AsJsonText Varchar(32767)                                                                            1000596
    604+                        extproc(*CWIDEN : 'jx_AsJsonText');                                                         1000597
    605+     //node. Retrive from Locate()                                                                                  1000598
    606+     pNode          Pointer    value;                                                                               1000599
    607+   End-PR;                                                                                                          1000600
    608+                                                                                                                    1000601
    609+   Dcl-PR json_AsJsonTextMem Uns(10)                                                                                1000602
    610+                           extproc(*CWIDEN : 'jx_AsJsonTextMem');                                                   1000603
    611+     //node. Retrive from Locate()                                                                                  1000604
    612+     pNode          Pointer    value;                                                                               1000605
    613+     //pointer to any memory buffer                                                                                 1000606
    614+     pBuffer        Pointer    value;                                                                               1000607
    615+     //Max number of bytes in buffer %size()                                                                        1000608
    616+     maxSize        Uns(10)    value options(*nopass);                                                              1000609
    617+   End-PR;                                                                                                          1000610
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    618+                                                                                                                    1000611
    619+   //**  XML  renderes ***                                                                                          1000612
    620+   Dcl-PR json_WriteXmlStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                                  1000613
    621+     //node. Retrive from Locate()                                                                                  1000614
    622+     pNode          Pointer    value;                                                                               1000615
    623+     //Name of output stream file                                                                                   1000616
    624+     FileName       Pointer    value options(*string);                                                              1000617
    625+     //Ccsid of output file                                                                                         1000618
    626+     Ccsid          Int(10)    value;                                                                               1000619
    627+     Trim           Ind        value;                                                                               1000620
    628+     //Extra options                                                                                                1000621
    629+     Options        Pointer    value options(*string:*nopass);                                                      1000622
    630+   End-PR;                                                                                                          1000623
    631+                                                                                                                    1000624
    632+   Dcl-PR json_AsXmlText Varchar(32767) extproc(*CWIDEN : 'jx_AsXmlText');                                          1000625
    633+     //node. Retrive from Locate()                                                                                  1000626
    634+     pNode          Pointer    value;                                                                               1000627
    635+   End-PR;                                                                                                          1000628
    636+                                                                                                                    1000629
    637+   Dcl-PR json_AsXmlTextMem Uns(10) extproc(*CWIDEN : 'jx_AsXmlTextMem');                                           1000630
    638+     //node. Retrive from Locate()                                                                                  1000631
    639+     pNode          Pointer    value;                                                                               1000632
    640+     //pointer to any memory buffer                                                                                 1000633
    641+     pBuffer        Pointer    value;                                                                               1000634
    642+   End-PR;                                                                                                          1000635
    643+                                                                                                                    1000636
    644+   // Return a streamer object to be used in own serialisers                                                        1000637
    645+   Dcl-PR json_Stream pointer extproc(*CWIDEN : 'jx_Stream');                                                       1000638
    646+     //node. Retrive from Locate()                                                                                  1000639
    647+     pNode          Pointer    value;                                                                               1000640
    648+   End-PR;                                                                                                          1000641
    649+                                                                                                                    1000642
    650+   //**  CSV  renderes ***                                                                                          1000643
    651+   Dcl-PR json_WriteCsvStmf  extproc(*CWIDEN : 'jx_WriteCsvStmf');                                                  1000644
    652+     //node. Retrive from Locate()                                                                                  1000645
    653+     pNode          Pointer    value;                                                                               1000646
    654+     //Name of output stream file                                                                                   1000647
    655+     FileName       Pointer    value options(*string);                                                              1000648
    656+     //Ccsid of output file                                                                                         1000649
    657+     Ccsid          Int(10)    value;                                                                               1000650
    658+     //*ON=Remove inter blanks                                                                                      1000651
    659+     Trim           Ind        value;                                                                               1000652
    660+     //Options: ';.' for separator and dec                                                                          1000653
    661+     Options        Pointer    value options(*string:*nopass);                                                      1000654
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    662+   End-PR;                                                                                                          1000655
    663+                                                                                                                    1000656
    664+                                                                                                                    1000657
    665+   Dcl-DS json_DelimiterDS  based(prototype_only) qualified;                                                        1000658
    666+     Slash          Char(1);                                                                                        1000659
    667+     BackSlash      Char(1);                                                                                        1000660
    668+     Masterspace    Char(1);                                                                                        1000661
    669+     BraBeg         Char(1);                                                                                        1000662
    670+     BraEnd         Char(1);                                                                                        1000663
    671+     Blank          Char(1);                                                                                        1000664
    672+     Dot            Char(1);                                                                                        1000665
    673+     CurBeg         Char(1);                                                                                        1000666
    674+     CurEnd         Char(1);                                                                                        1000667
    675+     Apos           Char(1);                                                                                        1000668
    676+     Quot           Char(1);                                                                                        1000669
    677+   End-DS;                                                                                                          1000670
    678+                                                                                                                    1000671
    679+   //Iterators: First use the set the use forEach                                                                   1000672
    680+   Dcl-DS json_Iterator  based(prototype_only) qualified;                                                           1000673
    681+     root           Pointer;                                                                                        1000674
    682+     this           Pointer;                                                                                        1000675
    683+     isList         Ind;                                                                                            1000676
    684+     isFirst        Ind;                                                                                            1000677
    685+     isLast         Ind;                                                                                            1000678
    686+     isRecursive    Ind;                                                                                            1000679
    687+     comma          Varchar(1);                                                                                     1000680
    688+     count          Int(10);                                                                                        1000681
    689+     length         Int(10);                                                                                        1000682
    690+     size           Int(10);                                                                                        1000683
    691+     //Pointer to temp array of elms                                                                                1000684
    692+     listArr        Pointer;                                                                                        1000685
    693+     //Set  this to *ON to teminate loop                                                                            1000686
    694+     break          Ind;                                                                                            1000687
    695+     filler         Char(64);                                                                                       1000688
    696+   End-DS;                                                                                                          1000689
    697+                                                                                                                    1000690
    698+   Dcl-PR json_setIterator  likeds( json_Iterator)                                                                  1000691
    699+                          extproc(*CWIDEN : 'jx_SetIterator');                                                      1000692
    700+     //node. Retrive from Locate()                                                                                  1000693
    701+     pNode          Pointer    value;                                                                               1000694
    702+     //Optional - path to node                                                                                      1000695
    703+     path           Pointer    value options(*string:*nopass);                                                      1000696
    704+   End-PR;                                                                                                          1000697
    705+                                                                                                                    1000698
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    706+   Dcl-PR json_setRecursiveIterator  likeds( json_Iterator)                                                         1000699
    707+                                   extproc(*CWIDEN :                                                                1000700
    708+                                   'jx_SetRecursiveIterator');                                                      1000701
    709+     //node. Retrive from Locate()                                                                                  1000702
    710+     pNode          Pointer    value;                                                                               1000703
    711+     //Optional - path to node                                                                                      1000704
    712+     path           Pointer    value options(*string:*nopass);                                                      1000705
    713+   End-PR;                                                                                                          1000706
    714+                                                                                                                    1000707
    715+   //Iterator Structure                                                                                             1000708
    716+   Dcl-PR json_forEach Ind extproc(*CWIDEN : 'jx_ForEach');                                                         1000709
    717+     iterator                  likeds( json_Iterator);                                                              1000710
    718+   End-PR;                                                                                                          1000711
    719+                                                                                                                    1000712
    720+   //For XML attributes                                                                                             1000713
    721+   Dcl-PR json_GetNodeAttrValue Varchar(32767)                                                                      1000714
    722+                              extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                           1000715
    723+     //Pointer to exsiting element                                                                                  1000716
    724+     pNode          Pointer    value;                                                                               1000717
    725+     //Attribute Name                                                                                               1000718
    726+     AttrName       Pointer    value options(*string);                                                              1000719
    727+     //If not found - default value                                                                                 1000720
    728+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000721
    729+   End-PR;                                                                                                          1000722
    730+                                                                                                                    1000723
    731+   Dcl-PR json_SetNodeAttrValue extproc(*CWIDEN : 'jx_SetNodeAttrValue');                                           1000724
    732+     //Pointer to exsiting element                                                                                  1000725
    733+     pNode          Pointer    value;                                                                               1000726
    734+     //Attribute name                                                                                               1000727
    735+     AttrName       Pointer    value options(*string);                                                              1000728
    736+     //New value                                                                                                    1000729
    737+     Value          Pointer    value options(*string);                                                              1000730
    738+   End-PR;                                                                                                          1000731
    739+                                                                                                                    1000732
    740+   Dcl-PR json_GetAttrValue Varchar(32767)                                                                          1000733
    741+                          extproc(*CWIDEN : 'jx_GetAttrValueVC');                                                   1000734
    742+     //Pointer Attribute                                                                                            1000735
    743+     pAttr          Pointer    value;                                                                               1000736
    744+     //If not found - default value                                                                                 1000737
    745+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000738
    746+   End-PR;                                                                                                          1000739
    747+                                                                                                                    1000740
    748+   Dcl-PR json_SetAttrValue extproc(*CWIDEN : 'jx_SetAttrValue');                                                   1000741
    749+     //Pointer Attribute                                                                                            1000742
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    750+     pAttr          Pointer    value;                                                                               1000743
    751+     //New value                                                                                                    1000744
    752+     AttrName       Pointer    value options(*string);                                                              1000745
    753+     //Default value                                                                                                1000746
    754+     Value          Pointer    value options(*string);                                                              1000747
    755+   End-PR;                                                                                                          1000748
    756+                                                                                                                    1000749
    757+   //Returns pointer to attribute list                                                                              1000750
    758+   Dcl-PR json_GetAttrFirst Pointer extproc(*CWIDEN : 'jx_GetAttrFirst');                                           1000751
    759+     //Pointer to element                                                                                           1000752
    760+     pElem          Pointer    value;                                                                               1000753
    761+   End-PR;                                                                                                          1000754
    762+                                                                                                                    1000755
    763+   //Returns pointer to attribute list                                                                              1000756
    764+   Dcl-PR json_GetAttrNext Pointer extproc(*CWIDEN : 'jx_GetAttrNext');                                             1000757
    765+     //Pointer to attribute list                                                                                    1000758
    766+     pAttr          Pointer    value;                                                                               1000759
    767+   End-PR;                                                                                                          1000760
    768+                                                                                                                    1000761
    769+   Dcl-PR json_GetAttrName Varchar(32767)                                                                           1000762
    770+                         extproc(*CWIDEN : 'jx_GetAttrNameVC');                                                     1000763
    771+     //Pointer to attribute list                                                                                    1000764
    772+     pAttr          Pointer    value;                                                                               1000765
    773+   End-PR;                                                                                                          1000766
    774+                                                                                                                    1000767
    775+ // Clear the contents of an array or object / delete all children                                                  1000768
    776+   Dcl-PR json_Clear  extproc(*CWIDEN : 'jx_Clear');                                                                1000769
    777+     pNode          Pointer    value; //Pointer to tree node                                                        1000770
    778+   End-PR;                                                                                                          1000771
    779+                                                                                                                    1000772
    780+ // Close all nodes in this tree - also parent and siblings                                                         1000773
    781+   Dcl-PR json_Close  extproc(*CWIDEN : 'jx_Close');                                                                1000774
    782+     //Pointer to tree node                                                                                         1000775
    783+     pNode          Pointer  ;                                                                                      1000776
    784+   End-PR;                                                                                                          1000777
    785+ // Detect if you have a memry leak: call this when you have closed everything at i will return                     1000778
    786+   Dcl-PR json_MemLeak Ind extproc(*CWIDEN : 'jx_MemLeak');                                                         1000779
    787+   End-PR;                                                                                                          1000780
    788+                                                                                                                    1000781
    789+ // Print memory report                                                                                             1000782
    790+   Dcl-PR json_MemStat  extproc(*CWIDEN : 'jx_MemStat');                                                            1000783
    791+   End-PR;                                                                                                          1000784
    792+                                                                                                                    1000785
    793+ // retune number of bytest used                                                                                    1000786
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    794+   Dcl-PR json_MemUse Uns(20) extproc(*CWIDEN : 'jx_MemUse');                                                       1000787
    795+   End-PR;                                                                                                          1000788
    796+                                                                                                                    1000789
    797+ // Return a memory segment pointer, and build a scope where JSON/XML will be created                               1000790
    798+   Dcl-PR json_SegmentSelectNo Pointer                                                                              1000791
    799+                             extproc(*CWIDEN : 'jx_SegmentSelectNo');                                               1000792
    800+     SegmentIndex   Int(10)    value;                                                                               1000793
    801+   End-PR;                                                                                                          1000794
    802+                                                                                                                    1000795
    803+ //  Delete the segment and all JSON/XML nodes build while segment scope was active                                 1000796
    804+   Dcl-PR json_SegmentDispose  extproc(*CWIDEN : 'jx_SegmentDispose');                                              1000797
    805+     segmentPtr     Pointer    value;                                                                               1000798
    806+   End-PR;                                                                                                          1000799
    807+                                                                                                                    1000800
    808+ // Maintain at list of index numbers to database CLOB/BLOB fields since pointers can not be sh                     1000801
    809+   //Returns *ON if found                                                                                           1000802
    810+   Dcl-PR json_mapIx Ind extproc(*CWIDEN:'jx_MapIx' );                                                              1000803
    811+     //pointer to node pointer                                                                                      1000804
    812+     ppNode         Pointer;                                                                                        1000805
    813+     //index of pointer                                                                                             1000806
    814+     Index          Uns(10)    value;                                                                               1000807
    815+   End-PR;                                                                                                          1000808
    816+                                                                                                                    1000809
    817+   //------------------------------------------------------------------------                                       1000810
    818+   //SQL interface:                                                                                                 1000811
    819+   //Note: When SQL functions returns *NULL, then use  the json_Message() to re                                     1000812
    820+   //------------------------------------------------------------------------                                       1000813
    821+                                                                                                                    1000814
    822+ // If options need - then it has to be first call made.                                                            1000815
    823+ // NOTE: If a pConnection pointer is provided, it will be updated with the conection                               1000816
    824+   Dcl-PR json_sqlSetOptions  extproc(*CWIDEN: 'jx_sqlSetOptions');                                                 1000817
    825+     //json object with options ( see sample)                                                                       1000818
    826+     parms          Pointer    value options(*string:*nopass);                                                      1000819
    827+   End-PR;                                                                                                          1000820
    828+                                                                                                                    1000821
    829+ // returns a object node with one resulting row for the SQL statment                                               1000822
    830+   //Returns one SQL row as jx Obejct                                                                               1000823
    831+   Dcl-PR json_sqlResultRow Pointer extproc(*CWIDEN: 'jx_sqlResultRow');                                            1000824
    832+     //SQL statement to run                                                                                         1000825
    833+     sqlStmt        Pointer    value options(*string);                                                              1000826
    834+     //json object template                                                                                         1000827
    835+     parms          Pointer    value options(*string:*nopass);                                                      1000828
    836+   End-PR;                                                                                                          1000829
    837+                                                                                                                    1000830
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    838+ // returns an array (or object with array) of resulting rows for the SQL statment                                  1000831
    839+   //Returns SQL rows as jx Obejct                                                                                  1000832
    840+   Dcl-PR json_sqlResultSet Pointer extproc(*CWIDEN: 'jx_sqlResultSet');                                            1000833
    841+     //SQL statement to run                                                                                         1000834
    842+     sqlStmt        Pointer    value options(*string);                                                              1000835
    843+     //From row; 1=First                                                                                            1000836
    844+     start          Int(10)    value options(*nopass);                                                              1000837
    845+     //max number of rows; json_ALLROWS=all                                                                         1000838
    846+     limit          Int(10)    value options(*nopass);                                                              1000839
    847+     //resultset format:                                                                                            1000840
    848+     format         Int(10)    value options(*nopass);                                                              1000841
    849+     //json object template                                                                                         1000842
    850+     parms          Pointer    value options(*string:*nopass);                                                      1000843
    851+   End-PR;                                                                                                          1000844
    852+                                                                                                                    1000845
    853+                                                                                                                    1000846
    854+   Dcl-C json_ALLROWS const(-1);                                                                                    1000847
    855+                                                                                                                    1000848
    856+   //Following constants used by json_sqlResultSet:format                                                           1000849
    857+   //+ An array with each row as an object                                                                          1000850
    858+   Dcl-C json_ROWARRAY const(0);                                                                                    1000851
    859+   //+ Metaobject: rows, fields                                                                                     1000852
    860+   Dcl-C json_META    const(1);                                                                                     1000853
    861+   //+ Columns info                                                                                                 1000854
    862+   Dcl-C json_FIELDS  const(2);                                                                                     1000855
    863+   //+ Count all rows in the resultset                                                                              1000856
    864+   // ( Pricy so awoid it || )                                                                                      1000857
    865+   Dcl-C json_TOTALROWS const(4);                                                                                   1000858
    866+   //+ Uppercase column names                                                                                       1000859
    867+   Dcl-C json_UPPERCASE const(8);                                                                                   1000860
    868+                                                                                                                    1000861
    869+   //+ Appoximate number of rows..                                                                                  1000862
    870+   //  ( unpresise but cheap || prefered  )                                                                         1000863
    871+   Dcl-C json_APPROXIMATE_TOTALROWS const(16);                                                                      1000864
    872+                                                                                                                    1000865
    873+                                                                                                                    1000866
    874+                                                                                                                    1000867
    875+ // SQL cursor processing                                                                                           1000868
    876+   //Returns handle to sql statement                                                                                1000869
    877+   Dcl-PR json_sqlOpen Pointer extproc(*CWIDEN:'jx_sqlOpen'  );                                                     1000870
    878+     //SQL statement to run                                                                                         1000871
    879+     sqlStmt        Pointer    value options(*string);                                                              1000872
    880+     //json object template                                                                                         1000873
    881+     parms          Pointer    value options(*string:*nopass);                                                      1000874
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    882+   End-PR;                                                                                                          1000875
    883+                                                                                                                    1000876
    884+ // Fetch next from from that open sql handle, starting from rowNumer. 1=First row                                  1000877
    885+   //Returns a row object (or *NULL if EOF)                                                                         1000878
    886+   Dcl-PR json_sqlFetchRelative Pointer                                                                             1000879
    887+                              extproc(*CWIDEN: 'jx_sqlFetchRelative');                                              1000880
    888+     //sql statement handle ( from sqlOpen)                                                                         1000881
    889+     pSqlHndl       Pointer    value;                                                                               1000882
    890+     //row from where to start 1=First                                                                              1000883
    891+     fromRow        Int(10)    value;                                                                               1000884
    892+   End-PR;                                                                                                          1000885
    893+                                                                                                                    1000886
    894+ // Fetch next from from that open sql handle                                                                       1000887
    895+   //Returns a row object (or *NULL if EOF)                                                                         1000888
    896+   Dcl-PR json_sqlFetchNext Pointer extproc(*CWIDEN:'jx_sqlFetchNext');                                             1000889
    897+     //sql statement handle ( from sqlOpen)                                                                         1000890
    898+     pSqlHndl       Pointer    value;                                                                               1000891
    899+   End-PR;                                                                                                          1000892
    900+                                                                                                                    1000893
    901+ // Number of columns in result set ( -1 if error)                                                                  1000894
    902+   //Returns number of columns                                                                                      1000895
    903+   Dcl-PR json_sqlColumns Int(10) extproc(*CWIDEN:'jx_sqlColumns');                                                 1000896
    904+     //sql statement handle ( from sqlOpen)                                                                         1000897
    905+     pSqlHndl       Pointer    value;                                                                               1000898
    906+   End-PR;                                                                                                          1000899
    907+                                                                                                                    1000900
    908+ // Number of rows  in result set ( -1 if error)                                                                    1000901
    909+ // Note: This will run a hidden "select count(*)" which might be a little pricy                                    1000902
    910+   //Returns number of rows                                                                                         1000903
    911+   Dcl-PR json_sqlRows Int(10) extproc(*CWIDEN:'jx_sqlRows');                                                       1000904
    912+     //sql statement handle ( from sqlOpen)                                                                         1000905
    913+     pSqlHndl       Pointer    value;                                                                               1000906
    914+   End-PR;                                                                                                          1000907
    915+                                                                                                                    1000908
    916+ // Always colse the cursor after use, to release resources                                                         1000909
    917+   Dcl-PR json_sqlClose  extproc(*CWIDEN:'jx_sqlClose');                                                            1000910
    918+     //sql statement handle ( from sqlOpen)                                                                         1000911
    919+     pSqlHndl       Pointer;                                                                                        1000912
    920+   End-PR;                                                                                                          1000913
    921+                                                                                                                    1000914
    922+ // Execute any SQL statement not involving a cursor                                                                1000915
    923+   //Returns *ON if error                                                                                           1000916
    924+   Dcl-PR json_sqlExec Ind extproc(*CWIDEN:'jx_sqlExec'  );                                                         1000917
    925+     //SQL statement to run (template)                                                                              1000918
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    926+     sqlStmt        Pointer    value options(*string);                                                              1000919
    927+     //json object template data                                                                                    1000920
    928+     parms          Pointer    value options(*string:*nopass);                                                      1000921
    929+   End-PR;                                                                                                          1000922
    930+                                                                                                                    1000923
    931+ // Execute an update table where the row is defined as a json object                                               1000924
    932+   //Returns *ON if error                                                                                           1000925
    933+   Dcl-PR json_sqlUpdate Ind extproc(*CWIDEN:'jx_sqlUpdate');                                                       1000926
    934+     //table name                                                                                                   1000927
    935+     table          Pointer    value options(*string);                                                              1000928
    936+     //json object: {a:123,b:"value"}                                                                               1000929
    937+     row            Pointer    value options(*string);                                                              1000930
    938+     //where clause : 'where myKey=$key'                                                                            1000931
    939+     where          Pointer    value options(*string:*nopass);                                                      1000932
    940+     //where parameters: { key:777}                                                                                 1000933
    941+     whereParms     Pointer    value options(*string:*nopass);                                                      1000934
    942+   End-PR;                                                                                                          1000935
    943+                                                                                                                    1000936
    944+   //Returns *ON if error                                                                                           1000937
    945+   Dcl-PR json_sqlInsert Ind extproc(*CWIDEN:'jx_sqlInsert');                                                       1000938
    946+     //table name                                                                                                   1000939
    947+     table          Pointer    value options(*string);                                                              1000940
    948+     //json object: {a:123,b:"value"}                                                                               1000941
    949+     row            Pointer    value options(*string);                                                              1000942
    950+     //extra parms                                                                                                  1000943
    951+     parms          Pointer    value options(*string:*nopass);                                                      1000944
    952+   End-PR;                                                                                                          1000945
    953+                                                                                                                    1000946
    954+   //Returns *ON if error                                                                                           1000947
    955+   Dcl-PR json_sqlUpsert Ind extproc(*CWIDEN:'jx_sqlUpsert');                                                       1000948
    956+     //table name                                                                                                   1000949
    957+     table          Pointer    value options(*string);                                                              1000950
    958+     //json object: {a:123,b:"value"}                                                                               1000951
    959+     row            Pointer    value options(*string);                                                              1000952
    960+     //where clause : 'where myKey=$key'                                                                            1000953
    961+     where          Pointer    value options(*string:*nopass);                                                      1000954
    962+     //where parameters: { key:777}                                                                                 1000955
    963+     whereParms     Pointer    value options(*string:*nopass);                                                      1000956
    964+   End-PR;                                                                                                          1000957
    965+                                                                                                                    1000958
    966+   //Returns id of last insert                                                                                      1000959
    967+   Dcl-PR json_sqlGetInsertId Int(10) extproc(*CWIDEN:'jx_sqlGetInsertId');                                         1000960
    968+   End-PR;                                                                                                          1000961
    969+                                                                                                                    1000962
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    970+   //Returns array of column info                                                                                   1000963
    971+   Dcl-PR json_sqlGetMeta Pointer extproc(*CWIDEN:'jx_sqlGetMeta');                                                 1000964
    972+     sqlstmt        Pointer    value options(*string);                                                              1000965
    973+   End-PR;                                                                                                          1000966
    974+                                                                                                                    1000967
    975+ // Return pointer to database connection. No options => will be default local database                             1000968
    976+   Dcl-PR json_sqlConnect Pointer extproc(*CWIDEN: 'jx_sqlConnect');                                                1000969
    977+     //json object or string with options                                                                           1000970
    978+     parms          Pointer    value options(*string:*nopass);                                                      1000971
    979+   End-PR;                                                                                                          1000972
    980+                                                                                                                    1000973
    981+ // Return pointer to database connection. No options => will be default local database                             1000974
    982+   Dcl-PR json_sqlDisconnect  extproc(*CWIDEN: 'jx_sqlDisconnect');                                                 1000975
    983+   End-PR;                                                                                                          1000976
    984+                                                                                                                    1000977
    985+ // Return sql code for previous statement                                                                          1000978
    986+   Dcl-PR json_sqlCode Int(10) extproc(*CWIDEN: 'jx_sqlCode');                                                      1000979
    987+   End-PR;                                                                                                          1000980
    988+                                                                                                                    1000981
    989+ //Returns a JSON object from a REST call                                                                           1000982
    990+   Dcl-PR json_httpRequest Pointer extproc(*CWIDEN:'jx_httpRequest');                                               1000983
    991+     //Full URL to the resource                                                                                     1000984
    992+     url            Pointer    value options(*string);                                                              1000985
    993+     //json object or string                                                                                        1000986
    994+     pReqNode       Pointer    value options(*string:*nopass);                                                      1000987
    995+     //extra CURL options                                                                                           1000988
    996+     options        Pointer    value options(*string:*nopass);                                                      1000989
    997+   End-PR;                                                                                                          1000990
    998+                                                                                                                    1000991
    999+ // when the dataarea SQLTRACE is set, your SQL statements                                                          1000992
   1000+ // are logged into SQLTRACE table.                                                                                 1000993
   1001+ // you can supply an extr eye-catch wariable :trcid                                                                1000994
   1002+   Dcl-PR json_traceSetId  extproc(*CWIDEN : 'jx_traceSetId');                                                      1000995
   1003+     traceId        Int(20)    value; //Ccsid of inpur file                                                         1000996
   1004+   End-PR;                                                                                                          1000997
   1005+                                                                                                                    1000998
   1006+ // -------------------------------------------------------------------------------------------                     1000999
   1007+ // Depricated and renamed functions :                                                                              1001000
   1008+ // -------------------------------------------------------------------------------------------                     1001001
   1009+ // Depricated - use  json_GetValueStr                                                                              1001002
   1010+   Dcl-PR json_GetValue Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                          1001003
   1011+     //Pointer to node                                                                                              1001004
   1012+     pNode          Pointer    value;                                                                               1001005
   1013+     //If not found - default value                                                                                 1001006
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1014+     Expression     Pointer    value options(*string:*nopass);                                                      1001007
   1015+     //If not found - default value                                                                                 1001008
   1016+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001009
   1017+   End-PR;                                                                                                          1001010
   1018+                                                                                                                    1001011
   1019+ // Depricated - use  json_NodeCopy                                                                                 1001012
   1020+   Dcl-PR json_Copy extproc(*CWIDEN : 'jx_NodeCopy');                                                               1001013
   1021+     //element. Retrive from Locate()                                                                               1001014
   1022+     pRootNode      Pointer    value;                                                                               1001015
   1023+     //element. Retrive from Locate()                                                                               1001016
   1024+     pNewChild      Pointer    value;                                                                               1001017
   1025+     //Reference location to where it arrive                                                                        1001018
   1026+     RefLocation    Int(10)    value;                                                                               1001019
   1027+   End-PR;                                                                                                          1001020
   1028+                                                                                                                    1001021
   1029+   Dcl-PR json_ElementCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                        1001022
   1030+     //element. Retrive from Locate()                                                                               1001023
   1031+     pRootNode      Pointer    value;                                                                               1001024
   1032+     //element. Retrive from Locate()                                                                               1001025
   1033+     pNewChild      Pointer    value;                                                                               1001026
   1034+     //Reference location to where it arrive                                                                        1001027
   1035+     RefLocation    Int(10)    value;                                                                               1001028
   1036+   End-PR;                                                                                                          1001029
   1037+                                                                                                                    1001030
   1038+ // Depricated - use  json_NodeDelete                                                                               1001031
   1039+   Dcl-PR json_Delete extproc(*CWIDEN : 'jx_NodeDelete');                                                           1001032
   1040+     //element. Retrive from Locate()                                                                               1001033
   1041+     pRootNode      Pointer    value;                                                                               1001034
   1042+   End-PR;                                                                                                          1001035
   1043+                                                                                                                    1001036
   1044+ // Depricated - use  json_NodeDelete                                                                               1001037
   1045+   Dcl-PR json_ElementDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                    1001038
   1046+     //element. Retrive from Locate()                                                                               1001039
   1047+     pRootNode      Pointer    value;                                                                               1001040
   1048+   End-PR;                                                                                                          1001041
   1049+                                                                                                                    1001042
   1050+ // Depricated - use  json_AsJsonText                                                                               1001043
   1051+   Dcl-PR json_AsText Varchar(32767) extproc(*CWIDEN : 'jx_AsJsonText');                                            1001044
   1052+     //element. Retrive from Locate()                                                                               1001045
   1053+     pNode          Pointer    value;                                                                               1001046
   1054+   End-PR;                                                                                                          1001047
   1055+                                                                                                                    1001048
   1056+                                                                                                                    1001049
   1057+ // json_XpathValue   is depricated and replaced by: json_GetStr                                                    1001050
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1058+   Dcl-PR json_XpathValue Varchar(32767)                                                                            1001051
   1059+                        extproc(*CWIDEN : 'jx_GetValueVC');                                                         1001052
   1060+     //Pointer to tree                                                                                              1001053
   1061+     pNode          Pointer    value;                                                                               1001054
   1062+     //Locations expression to node                                                                                 1001055
   1063+     Expression     Pointer    value options(*string);                                                              1001056
   1064+     //If not found - default value                                                                                 1001057
   1065+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001058
   1066+   End-PR;                                                                                                          1001059
   1067+                                                                                                                    1001060
   1068+ // json_XpathValueNum   is depricated and replaced by: json_GetNum                                                 1001061
   1069+   Dcl-PR json_XpathValueNum Packed(30:15)                                                                          1001062
   1070+                           extproc(*CWIDEN : 'jx_GetValueNum');                                                     1001063
   1071+     //Pointer to tree                                                                                              1001064
   1072+     pJsonCom       Pointer    value;                                                                               1001065
   1073+     //Location expression to node or attributes                                                                    1001066
   1074+     Node           Pointer    value options(*string);                                                              1001067
   1075+     //If not found - default value                                                                                 1001068
   1076+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           1001069
   1077+   End-PR;                                                                                                          1001070
   1078+                                                                                                                    1001071
   1079+ // Use - json_NodeType                                                                                             1001072
   1080+   Dcl-PR json_ElementType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                              1001073
   1081+     //Pointer to tree to receive format                                                                            1001074
   1082+     pNode          Pointer    value;                                                                               1001075
   1083+   End-PR;                                                                                                          1001076
   1084+                                                                                                                    1001077
   1085+ // Use json_NodeAdd                                                                                                1001078
   1086+   //returns the new element                                                                                        1001079
   1087+   Dcl-PR json_ElementAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                  1001080
   1088+     //element. Retrive from Locate()                                                                               1001081
   1089+     pRootNode      Pointer    value;                                                                               1001082
   1090+     //Reference location to where it arrive                                                                        1001083
   1091+     RefLocation    Int(10)    value;                                                                               1001084
   1092+     //Name of element                                                                                              1001085
   1093+     Name           Pointer    value options(*string);                                                              1001086
   1094+     //Value of element                                                                                             1001087
   1095+     Value          Pointer    value options(*string);                                                              1001088
   1096+   End-PR;                                                                                                          1001089
   1097+                                                                                                                    1001090
   1098+ // Use json_GetNext                                                                                                1001091
   1099+   //Returns pointer to next sibling (elem)                                                                         1001092
   1100+   Dcl-PR json_GetElemNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                             1001093
   1101+     //Pointer to current element (elem)                                                                            1001094
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1102+     pElem          Pointer    value  ;                                                                             1001095
   1103+   End-PR;                                                                                                          1001096
   1104+                                                                                                                    1001097
   1105+ // use json_GetChild                                                                                               1001098
   1106+   //Returns pointer to next child (elem)                                                                           1001099
   1107+   Dcl-PR json_GetElemChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                                           1001100
   1108+     //Pointer to current element (elem)                                                                            1001101
   1109+     pElem          Pointer    value;                                                                               1001102
   1110+   End-PR;                                                                                                          1001103
   1111+                                                                                                                    1001104
   1112+                                                                                                                    1001105
   1113+ // use get json_GetName                                                                                            1001106
   1114+   Dcl-PR json_getElemName Varchar(32767)                                                                           1001107
   1115+                         extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                     1001108
   1116+     //Pointer to node                                                                                              1001109
   1117+     pNode          Pointer    value;                                                                               1001110
   1118+   End-PR;                                                                                                          1001111
   1119+                                                                                                                    1001112
   1120+ // use xml_GetValueStr                                                                                             1001113
   1121+   Dcl-PR json_GetElemValue Varchar(32767)                                                                          1001114
   1122+                          extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                   1001115
   1123+     //Pointer to element                                                                                           1001116
   1124+     pElem          Pointer    value;                                                                               1001117
   1125+     //If not found - default value                                                                                 1001118
   1126+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001119
   1127+   End-PR;                                                                                                          1001120
   1128+                                                                                                                    1001121
   1129+  // use json_GetAttrValue                                                                                          1001122
   1130+   Dcl-PR json_GetAttr Varchar(32767)                                                                               1001123
   1131+                     extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                                    1001124
   1132+     //Pointer to element                                                                                           1001125
   1133+     pNode          Pointer    value;                                                                               1001126
   1134+     //Attribute Name                                                                                               1001127
   1135+     AttrName       Pointer    value options(*string);                                                              1001128
   1136+     //If not found - default value                                                                                 1001129
   1137+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001130
   1138+   End-PR;                                                                                                          1001131
   1139+                                                                                                                    1001132
   1140+ // has no effect any longer                                                                                        1001133
   1141+   //Set input and output CCSID                                                                                     1001134
   1142+   Dcl-PR json_setCcsid  extproc(*CWIDEN : 'jx_SetCcsid');                                                          1001135
   1143+     //Ccsid of inpur file                                                                                          1001136
   1144+     inputCCSID     Int(10)    value;                                                                               1001137
   1145+     //Ccsid of output file                                                                                         1001138
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1146+     outputCCSID    Int(10)    value;                                                                               1001139
   1147+   End-PR;                                                                                                          1001140
   1148+                                                                                                                    1001141
   1149+ // depricated - use setNum                                                                                         1001142
   1150+   Dcl-PR json_SetDec Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  1001143
   1151+     //Pointer to json_ tree                                                                                        1001144
   1152+     pNode          Pointer    value;                                                                               1001145
   1153+     //Location expression to node or attributes                                                                    1001146
   1154+     Expresion      Pointer    value options(*string);                                                              1001147
   1155+     //New value to set / pointer to object                                                                         1001148
   1156+     Value          Packed(30:15) value;                                                                            1001149
   1157+   End-PR;                                                                                                          1001150
   1158+                                                                                                                    1001151
   1159+ // Depricated in both JSON and XML - use  json_WriteJsonStmf /   json_WriteXmlStmf                                 1001152
   1160+ /if not defined(JSONXML_DEPRICATED)                                                                                1001153
   1161+ /define  JSONXML_DEPRICATED                                                                                        1001154
   1162+   Dcl-PR json_WriteStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                                    1001155
   1163+     //element. Retrive from Locate()                                                                               1001156
   1164+     pNode          Pointer    value;                                                                               1001157
   1165+     //Name of output stream file                                                                                   1001158
   1166+     FileName       Pointer    value options(*string);                                                              1001159
   1167+     //Ccsid of output file                                                                                         1001160
   1168+     Ccsid          Int(10)    value;                                                                               1001161
   1169+     Trim           Ind        value options(*nopass);                                                              1001162
   1170+   End-PR;                                                                                                          1001163
   1171+                                                                                                                    1001164
   1172+   Dcl-PR xml_WriteStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                                      1001165
   1173+     //element. Retrive from Locate()                                                                               1001166
   1174+     pNode          Pointer    value;                                                                               1001167
   1175+     //Name of output stream file                                                                                   1001168
   1176+     FileName       Pointer    value options(*string);                                                              1001169
   1177+     //Ccsid of output file                                                                                         1001170
   1178+     Ccsid          Int(10)    value;                                                                               1001171
   1179+     Trim           Ind        value options(*nopass);                                                              1001172
   1180+   End-PR;                                                                                                          1001173
   1181+ /endif                                                                                                             1001174
   1182    Dcl-S pRow         Pointer;                                                                                       000009
   1183    Dcl-S rows         Pointer;                                                                                       000010
   1184    Dcl-S sqlHnd       Pointer;                                                                                       000011
   1185    Dcl-S sql          Varchar(512);                                                                                  000012
   1186                                                                                                                      000013
   1187    //------------------------------------------------------------- *                                                 000014
   1188                                                                                                                      000015
   1189    // The destination object for our SQL result row                                                                  000016
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     30
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1190    // and the array to contain the rows                                                                              000017
   1191    rows    = json_newArray ();                                                                                       000018
   1192                                                                                                                      000019
   1193    // Open our SQL cursor. Use a simple select                                                                       000020
   1194    sql = 'Select * from product';                                                                                    000021
   1195    sqlhnd  = json_sqlOpen(sql);                                                                                      000022
   1196                                                                                                                      000023
   1197    // Now iterate on each row in the resultset                                                                       000024
   1198    pRow = json_sqlFetchNext(sqlhnd) ;                                                                                000025
   1199    dow (pRow <> *NULL );                                                                        B01                  000026
   1200       // Append the row to the end of the result array. Note ArrayPush will                                          000027
   1201       // by default move the object ( not copy) to the bottom of the array.                                          000028
   1202       json_ArrayPush(rows : pRow);                                                               01                  000029
   1203       pRow = json_sqlFetchNext(sqlhnd) ;                                                         01                  000030
   1204    enddo;                                                                                       E01                  000031
   1205                                                                                                                      000032
   1206    // Produce a JSON stream file in the root of the IFS                                                              000033
   1207    json_writeJsonStmf(rows : '/jsonxml/json/demo.json' : 1208 : *ON);                                                000034
   1208                                                                                                                      000035
   1209    // Cleanup: Close the SQL cursor, dispose the row and the array                                                   000036
   1210    json_close(rows);                                                                                                 000037
   1211    json_sqlClose(sqlhnd);                                                                                            000038
   1212    json_sqlDisconnect();                                                                                             000039
   1213                                                                                                                      000040
   1214    // That's it..                                                                                                    000041
   1215    *inlr = *on;                                                                                                      000042
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     31
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv Number Seq     Message text
 *RNF5409 00   1202 000029  The prototyped call returns a value which is lost when
                            CALLP is used.
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                             / C o p y   M e m b e r s
 Line   Src  RPG name   <-------- External name -------> CCSID  <- Last change ->
 Number Id              Library    File       Member            Date     Time
      8    1 JSONPARSE+ ./../headers/JSONPARSER.rpgle      819  24.09.19 10:26:05
          * * * * *   E N D   O F   / C O P Y   M E M B E R S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     32
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          No references in the source.
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
          *INLR             N(1)                 1215M
 *RNF7031 JSON_AFTER_SIBLING...
                            CONST                 420D
 *RNF7031 JSON_ALLOW_PRIMITIVES...
                            CONST                  68D
 *RNF7031 JSON_ALLROWS      CONST                 854D
 *RNF7031 JSON_APPROXIMATE_TOTALROWS...
                            CONST                 871D
 *RNF7031 JSON_ARRAY        CONST                  51D
 *RNF7031 JSON_ARRAYAPPEND  *(16)                 491D
                            PROTOTYPE
          JSON_ARRAYPUSH    *(16)                 477D   1202M
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSLICE   *(16)                 501D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSORT    *(16)                 513D
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXT   A(32767)              603D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXTMEM...
                            U(10,0)               609D
                            PROTOTYPE
 *RNF7031 JSON_ASTEXT       A(32767)             1051D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXT    A(32767)              632D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXTMEM U(10,0)               637D
                            PROTOTYPE
 *RNF7031 JSON_BEFORE_SIBLING...
                            CONST                 419D
 *RNF7031 JSON_BY_CONTEXT   CONST                  60D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     33
 *RNF7031 JSON_CHILD_LIST   CONST                  88D
 *RNF7031 JSON_CLEAR        PROTOTYPE             776D
 *RNF7031 JSON_CLONEFORMAT  PROTOTYPE             583D
          JSON_CLOSE        PROTOTYPE             781D   1210M
 *RNF7031 JSON_COPY         PROTOTYPE            1020D
 *RNF7031 JSON_COPY_CLONE   CONST                 488D
 *RNF7031 JSON_COPYVALUE    *(16)                 396D
                            PROTOTYPE
 *RNF7031 JSON_DELETE       PROTOTYPE            1039D
 *RNF7031 JSON_DELIMITERDS  DS(11)                665D
                            BASED(PROTOTYPE+)
 *RNF7031   APOS            A(1)                  675D
 *RNF7031   BACKSLASH       A(1)                  667D
 *RNF7031   BLANK           A(1)                  671D
 *RNF7031   BRABEG          A(1)                  669D
 *RNF7031   BRAEND          A(1)                  670D
 *RNF7031   CURBEG          A(1)                  673D
 *RNF7031   CUREND          A(1)                  674D
 *RNF7031   DOT             A(1)                  672D
 *RNF7031   MASTERSPACE     A(1)                  668D
 *RNF7031   QUOT            A(1)                  676D
 *RNF7031   SLASH           A(1)                  666D
 *RNF7031 JSON_DELIMITERS   CONST                  44D
 *RNF7031 JSON_DONTREPLACE  CONST                 555D
 *RNF7031 JSON_DUMP         PROTOTYPE             577D
 *RNF7031 JSON_ELEMENTADD   *(16)                1087D
                            PROTOTYPE
 *RNF7031 JSON_ELEMENTCOPY  PROTOTYPE            1029D
 *RNF7031 JSON_ELEMENTDELETE...
                            PROTOTYPE            1045D
 *RNF7031 JSON_ELEMENTTYPE  I(5,0)               1080D
                            PROTOTYPE
 *RNF7031 JSON_ERROR        N(1)                  114D
                            PROTOTYPE
 *RNF7031 JSON_EVAL         CONST                  52D
 *RNF7031 JSON_FIELDS       CONST                 862D
 *RNF7031 JSON_FIRST_CHILD  CONST                 417D
 *RNF7031 JSON_FOREACH      N(1)                  716D
                            PROTOTYPE
 *RNF7031 JSON_GETATTR      A(32767)             1130D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETATTRFIRST *(16)                 758D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNAME  A(32767)              769D
                            VARYING(2)
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     34
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNEXT  *(16)                 764D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRVALUE A(32767)              740D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETCHILD     *(16)                 202D
                            PROTOTYPE
 *RNF7031 JSON_GETDELIMITERS...
                            *(16)                  36D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMCHILD *(16)                1107D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNAME  A(32767)             1114D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNEXT  *(16)                1100D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMVALUE A(32767)             1121D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETILOBVALUE N(1)                  387D
                            PROTOTYPE
 *RNF7031 JSON_GETINT       I(20,0)               376D
                            PROTOTYPE
 *RNF7031 JSON_GETLENGTH    I(10,0)               539D
                            PROTOTYPE
 *RNF7031 JSON_GETMESSAGEOBJECT...
                            *(16)                 127D
                            PROTOTYPE
 *RNF7031 JSON_GETNAME      A(32767)              321D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNAMEASPATH...
                            A(32767)              327D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNEXT      *(16)                 196D
                            PROTOTYPE
 *RNF7031 JSON_GETNODEATTRVALUE...
                            A(32767)              721D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNUM       P(30,15)              367D
                            PROTOTYPE
 *RNF7031 JSON_GETPARENT    *(16)                 208D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     35
                            PROTOTYPE
 *RNF7031 JSON_GETSTR       A(32767)              344D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETSTRJOIN   A(32767)              354D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUE     A(32767)             1010D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUEINT  I(20,0)               308D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUENUM  P(30,15)              300D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUEPTR  *(16)                 314D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUESTR  A(32767)              292D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_HAS          N(1)                  158D
                            PROTOTYPE
 *RNF7031 JSON_HTTPREQUEST  *(16)                 990D
                            PROTOTYPE
 *RNF7031 JSON_IGNORE_CASE  CONST                 536D
 *RNF7031 JSON_ISNODE       N(1)                  182D
                            PROTOTYPE
 *RNF7031 JSON_ISNULL       N(1)                  174D
                            PROTOTYPE
 *RNF7031 JSON_ISTRUE       N(1)                  166D
                            PROTOTYPE
          JSON_ITERATOR     DS(145)               680D    698     706     717
                            BASED(PROTOTYPE+)
 *RNF7031   BREAK           N(1)                  694D
 *RNF7031   COMMA           A(1)                  687D
                            VARYING(2)
 *RNF7031   COUNT           I(10,0)               688D
 *RNF7031   FILLER          A(64)                 695D
 *RNF7031   ISFIRST         N(1)                  684D
 *RNF7031   ISLAST          N(1)                  685D
 *RNF7031   ISLIST          N(1)                  683D
 *RNF7031   ISRECURSIVE     N(1)                  686D
 *RNF7031   LENGTH          I(10,0)               689D
 *RNF7031   LISTARR         *(16)                 692D
 *RNF7031   ROOT            *(16)                 681D
 *RNF7031   SIZE            I(10,0)               690D
 *RNF7031   THIS            *(16)                 682D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     36
 *RNF7031 JSON_LAST_CHILD   CONST                 418D
 *RNF7031 JSON_LITERAL      CONST                  56D
 *RNF7031 JSON_LOCATE       *(16)                 141D
                            PROTOTYPE
 *RNF7031 JSON_LOCATEORCREATE...
                            *(16)                 149D
                            PROTOTYPE
 *RNF7031 JSON_LOOKUPVALUE  *(16)                 525D
                            PROTOTYPE
 *RNF7031 JSON_MAPIX        N(1)                  810D
                            PROTOTYPE
 *RNF7031 JSON_MEMLEAK      N(1)                  786D
                            PROTOTYPE
 *RNF7031 JSON_MEMSTAT      PROTOTYPE             790D
 *RNF7031 JSON_MEMUSE       U(20,0)               794D
                            PROTOTYPE
 *RNF7031 JSON_MERGE        *(16)                 545D
                            PROTOTYPE
 *RNF7031 JSON_MERGEOBJECTS *(16)                 559D
                            PROTOTYPE
 *RNF7031 JSON_MESSAGE      A(1024)               120D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_META         CONST                 860D
 *RNF7031 JSON_MOVE_MODES   CONST                  66D
 *RNF7031 JSON_MOVE_UNLINK  CONST                 487D
 *RNF7031 JSON_MOVEOBJECTINTO...
                            *(16)                 569D
                            PROTOTYPE
          JSON_NEWARRAY     *(16)                 471D   1191
                            PROTOTYPE
 *RNF7031 JSON_NEWOBJECT    *(16)                 464D
                            PROTOTYPE
 *RNF7031 JSON_NODEADD      *(16)                 428D
                            PROTOTYPE
 *RNF7031 JSON_NODECHECKSUM U(10,0)               459D
                            PROTOTYPE
 *RNF7031 JSON_NODECLONE    *(16)                 422D
                            PROTOTYPE
 *RNF7031 JSON_NODECOPY     PROTOTYPE             407D
 *RNF7031 JSON_NODEDELETE   PROTOTYPE             441D
 *RNF7031 JSON_NODERENAME   N(1)                  188D
                            PROTOTYPE
 *RNF7031 JSON_NODESANITIZE PROTOTYPE             452D
 *RNF7031 JSON_NODETYPE     I(5,0)                336D
                            PROTOTYPE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     37
 *RNF7031 JSON_NODEUNLINK   *(16)                 447D
                            PROTOTYPE
 *RNF7031 JSON_OBJCOPY      CONST                  59D
 *RNF7031 JSON_OBJECT       CONST                  50D
 *RNF7031 JSON_OBJLINK      CONST                  57D
 *RNF7031 JSON_OBJMOVE      CONST                  61D
 *RNF7031 JSON_OBJREPLACE   CONST                  58D
 *RNF7031 JSON_PARSE        CONST                  72D
 *RNF7031 JSON_PARSEFILE    *(16)                  92D
                            PROTOTYPE
 *RNF7031 JSON_PARSESTRING  *(16)                 100D
                            PROTOTYPE
 *RNF7031 JSON_POINTER_VALUE...
                            CONST                  53D
 *RNF7031 JSON_REPLACE      CONST                 556D
 *RNF7031 JSON_ROOT         CONST                  55D
 *RNF7031 JSON_ROWARRAY     CONST                 858D
 *RNF7031 JSON_SAME_CASE    CONST                 535D
 *RNF7031 JSON_SEGMENTDISPOSE...
                            PROTOTYPE             804D
 *RNF7031 JSON_SEGMENTSELECTNO...
                            *(16)                 798D
                            PROTOTYPE
 *RNF7031 JSON_SETATTRVALUE PROTOTYPE             748D
 *RNF7031 JSON_SETBOOL      *(16)                 254D
                            PROTOTYPE
 *RNF7031 JSON_SETCCSID     PROTOTYPE            1142D
 *RNF7031 JSON_SETDEC       *(16)                1150D
                            PROTOTYPE
 *RNF7031 JSON_SETDECPOINT  PROTOTYPE             108D
 *RNF7031 JSON_SETDELIMITERS...
                            PROTOTYPE              39D
 *RNF7031 JSON_SETEVAL      *(16)                 221D
                            PROTOTYPE
 *RNF7031 JSON_SETINT       *(16)                 236D
                            PROTOTYPE
 *RNF7031 JSON_SETITERATOR  DS(145)               698D
                            PROTOTYPE
 *RNF7031 JSON_SETNODEATTRVALUE...
                            PROTOTYPE             731D
 *RNF7031 JSON_SETNULL      *(16)                 214D
                            PROTOTYPE
 *RNF7031 JSON_SETNUM       *(16)                 245D
                            PROTOTYPE
 *RNF7031 JSON_SETPROCPTR   *(16)                 272D
                            PROTOTYPE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     38
 *RNF7031 JSON_SETPTR       *(16)                 263D
                            PROTOTYPE
 *RNF7031 JSON_SETRECURSIVEITERATOR...
                            DS(145)               706D
                            PROTOTYPE
 *RNF7031 JSON_SETSTR       *(16)                 227D
                            PROTOTYPE
 *RNF7031 JSON_SETVALUE     *(16)                 281D
                            PROTOTYPE
          JSON_SQLCLOSE     PROTOTYPE             917D   1211M
 *RNF7031 JSON_SQLCODE      I(10,0)               986D
                            PROTOTYPE
 *RNF7031 JSON_SQLCOLUMNS   I(10,0)               903D
                            PROTOTYPE
 *RNF7031 JSON_SQLCONNECT   *(16)                 976D
                            PROTOTYPE
          JSON_SQLDISCONNECT...
                            PROTOTYPE             982D   1212M
 *RNF7031 JSON_SQLEXEC      N(1)                  924D
                            PROTOTYPE
          JSON_SQLFETCHNEXT *(16)                 896D   1198    1203
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHRELATIVE...
                            *(16)                 886D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETINSERTID...
                            I(10,0)               967D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETMETA   *(16)                 971D
                            PROTOTYPE
 *RNF7031 JSON_SQLINSERT    N(1)                  945D
                            PROTOTYPE
          JSON_SQLOPEN      *(16)                 877D   1195
                            PROTOTYPE
 *RNF7031 JSON_SQLRESULTROW *(16)                 831D
                            PROTOTYPE
 *RNF7031 JSON_SQLRESULTSET *(16)                 840D
                            PROTOTYPE
 *RNF7031 JSON_SQLROWS      I(10,0)               911D
                            PROTOTYPE
 *RNF7031 JSON_SQLSETOPTIONS...
                            PROTOTYPE             824D
 *RNF7031 JSON_SQLUPDATE    N(1)                  933D
                            PROTOTYPE
 *RNF7031 JSON_SQLUPSERT    N(1)                  955D
                            PROTOTYPE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     39
 *RNF7031 JSON_STREAM       *(16)                 645D
                            PROTOTYPE
 *RNF7031 JSON_SUCCESSTRUE  *(16)                 135D
                            PROTOTYPE
 *RNF7031 JSON_TOTALROWS    CONST                 865D
 *RNF7031 JSON_TRACESETID   PROTOTYPE            1002D
 *RNF7031 JSON_UNKNOWN      CONST                  49D
 *RNF7031 JSON_UPPERCASE    CONST                 867D
 *RNF7031 JSON_USE_LOCALE   CONST                 522D
 *RNF7031 JSON_VALUE        CONST                  54D
 *RNF7031 JSON_WRITECSVSTMF PROTOTYPE             651D
          JSON_WRITEJSONSTMF...
                            PROTOTYPE             591D   1207M
 *RNF7031 JSON_WRITESTMF    PROTOTYPE            1162D
 *RNF7031 JSON_WRITEXMLSTMF PROTOTYPE             620D
 *RNF7031 JSON_XPATHVALUE   A(32767)             1058D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_XPATHVALUENUM...
                            P(30,15)             1069D
                            PROTOTYPE
 *RNF7031 MO_MERGE_MATCH    CONST                  82D
 *RNF7031 MO_MERGE_NEW      CONST                  80D
 *RNF7031 MO_MERGE_REPLACE  CONST                  85D
          PROTOTYPE_ONLY    *(16)                 665     680
          PROW              *(16)                1182D   1198M   1199    1202
                                                 1203M
          ROWS              *(16)                1183D   1191M   1202    1207
                                                 1210
          SQL               A(512)               1185D   1194M   1195
                            VARYING(2)
          SQLHND            *(16)                1184D   1195M   1198    1203
                                                 1211
 *RNF7031 XML_WRITESTMF     PROTOTYPE            1172D
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
          LR                                     1215M
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     40
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          jx_Has                                  158
          jx_Dump                                 577
          jx_Error                                114
          jx_Clear                                776
          jx_Close                                781    1210
          jx_MapIx                                810
          jx_IsTrue                               166
          jx_IsNull                               174
          jx_isNode                               182
          jx_Stream                               645
          jx_MemUse                               794
          jx_Message                              120
          jx_GetNode                              141
          jx_NodeAdd                              428    1087
          jx_ForEach                              716
          jx_MemLeak                              786
          jx_MemStat                              790
          jx_sqlOpen                              877    1195
          jx_sqlRows                              911
          jx_sqlExec                              924
          jx_sqlCode                              986
          jx_NodeCopy                             407    1020    1029
          jx_NewArray                             471    1191
          jx_sqlClose                             917    1211
          jx_SetCcsid                            1142
          jx_ParseFile                             92
          jx_CopyValue                            396
          jx_NodeClone                            422
          jx_NewObject                            464
          jx_ArrayPush                            477    1202
          jx_ArraySort                            513
          jx_getLength                            539
          jx_NodeMerge                            545
          jx_AsXmlText                            632
          jx_sqlUpdate                            933
          jx_sqlInsert                            945
          jx_sqlUpsert                            955
          jx_NodeRename                           188
          jx_GetValueVC                           344    1010    1059
          jx_NodeDelete                           441    1039    1045
          jx_NodeUnlink                           447
          jx_ArraySlice                           501
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     41
          jx_AsJsonText                           604    1051
          jx_sqlColumns                           903
          jx_sqlGetMeta                           971
          jx_sqlConnect                           976
          jx_traceSetId                          1002
          jx_ParseString                          100
          jx_SetDecPoint                          108
          jx_SuccessTrue                          135
          jx_GetNodeNext                          196    1100
          jx_GetNodeType                          336    1080
          jx_GetValueNum                          367    1070
          jx_GetValueInt                          376
          jx_ArrayAppend                          491
          jx_lookupValue                          525
          jx_CloneFormat                          583
          jx_SetIterator                          699
          jx_GetAttrNext                          764
          jx_httpRequest                          990
          jx_GetNodeChild                         202    1107
          jx_SetStrByName                         227
          jx_SetIntByName                         236
          jx_SetDecByName                         245    1150
          jx_SetPtrByName                         263     272
          jx_GetStrJoinVC                         355
          jx_NodeSanitize                         452
          jx_NodeCheckSum                         459
          jx_MergeObjects                         559
          jx_NodeMoveInto                         569
          jx_WriteXmlStmf                         620    1172
          jx_AsXmlTextMem                         637
          jx_WriteCsvStmf                         651
          jx_SetAttrValue                         748
          jx_GetAttrFirst                         758
          jx_sqlResultRow                         831
          jx_sqlResultSet                         840
          jx_sqlFetchNext                         896    1198    1203
          jx_GetDelimiters                         36
          jx_GetNodeParent                        208
          jx_SetNullByName                        214
          jx_SetEvalByName                        221
          jx_SetBoolByName                        254
          jx_GetNodeNameVC                        322    1115
          ILOB_XmlGetValue                        387
          jx_WriteJsonStmf                        591    1162    1207
          jx_AsJsonTextMem                        610
          jx_GetAttrNameVC                        770
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     42
          jx_sqlSetOptions                        824
          jx_sqlDisconnect                        982    1212
          jx_SetDelimiters2                        39
          jx_SetValueByName                       281
          jx_GetNodeValueVC                       293    1122
          jx_GetAttrValueVC                       741
          jx_SegmentDispose                       804
          jx_sqlGetInsertId                       967
          jx_GetOrCreateNode                      150
          jx_GetNodeValueNum                      301
          jx_GetNodeValueInt                      308
          jx_GetNodeValuePtr                      314
          jx_SegmentSelectNo                      799
          jx_GetMessageObject                     128
          jx_SetNodeAttrValue                     731
          jx_sqlFetchRelative                     887
          jx_GetNodeNameAsPath                    328
          jx_GetNodeAttrValueVC                   722    1131
          jx_SetRecursiveIterator                 708
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     43
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF5409 00      1 The prototyped call returns a value which is lost when CALLP
                    is used.
 *RNF7031 00    182 The name or indicator is not referenced.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONSQL03          D1EDPAS4   24.09.19 10:27:15        Page     44
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :      183
     Warning      (10) . . . . . . . :        0
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :      183
   Source Totals:
     Records . . . . . . . . . . . . :     1215
     Specifications  . . . . . . . . :      617
     Data records  . . . . . . . . . :        0
     Comments  . . . . . . . . . . . :      425
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program JSONSQL03 placed in library NOXDB. 00 highest severity. Created on 24.09.19 at 10:27:15.
           * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
