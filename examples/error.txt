  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     DKNLI
   Program  . . . . . . . . . . . . :   JSONPARS6A
     Library  . . . . . . . . . . . :     NOXDB
   Text 'description' . . . . . . . :   *SRCMBRTXT
   Source stream file   . . . . . . :   JSONPARS6A.RPGLE
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   17.09.19  12:01:58
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *UNREF     *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *OWNER
   Authority  . . . . . . . . . . . :   *USE
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
                                    :   /prj/noxdb
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1                                                                                                                      000001
      2    //------------------------------------------------------------- *                                                 000002
      3                                                                                                                      000003
      4    Ctl-Opt BndDir('NOXDB') dftactgrp(*NO) ACTGRP('QILE' );                                                           000004
      5                                                                                                                      000005
      6    //Sample:                                                                                                         000006
      7    //Build a json object with primitive types and write                                                              000007
      8    //is as astream file to the IFS in UTF-8 format                                                                   000008
      9                                                                                                                      000009
     10    //------------------------------------------------------------- *                                                 000010
     11                                                                                                                      000011
     12    /include 'headers/JSONPARSER.rpgle'                                                                               000012
         *--------------------------------------------------------------------------------------------*
         * RPG member name  . . . . . :  JSONPARSE+                                                   *                     1
         * External name  . . . . . . :  ./../headers/JSONPARSER.rpgle                                *                     1
         * Last change  . . . . . . . :  17.09.19  12:51:32                                           *                     1
         *--------------------------------------------------------------------------------------------*
     13+   //---------------------------------------------------------------------- *                                       1000001
     14+   //This is the prototype for BlueSeries/IceBreak - JSON and XML parser                                            1000002
     15+   //Use the JSONXML binddir when creating your program and include this                                            1000003
     16+   //prototypes like:                                                                                               1000004
     17+                                                                                                                    1000005
     18+   //H BNDDIR('JSONPARSER')                                                                                         1000006
     19+   ///include jsonParser                                                                                            1000007
     20+                                                                                                                    1000008
     21+   //Or                                                                                                             1000009
     22+                                                                                                                    1000010
     23+   //H BNDDIR('XMLPARSER')                                                                                          1000011
     24+   ///include xmlParser                                                                                             1000012
     25+                                                                                                                    1000013
     26+   //Note: Both XMLPARSER and JSONPARSER headers are autogenerated from                                             1000014
     27+   //the JSONXML header. so please do not make any changes th there headerfi                                        1000015
     28+                                                                                                                    1000016
     29+   //Note: all binddirectories JSONPARSER, XMLPARSER and JSONXML is the same                                        1000017
     30+   //---------------------------------------------------------------------- *                                       1000018
     31+ /if defined( json_DEF)                                                                                             1000019
             LINES EXCLUDED: 1
     32+ /endif                                                                                                             1000021
     33+ /define  json_DEF                                                                                                  1000022
     34+   //---------------------------------------------------------------------- *                                       1000023
     35+   //Before starting that parser - to enshure right enterpretations of delimi                                       1000024
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page      3
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     36+   //Usage:                                                                                                         1000025
     37+   //jx_setDelimiters( json_DELIMITERS);                                                                            1000026
     38+   //--------------------------------------------------------------------- *                                        1000027
     39+   //get delimiter pointer                                                                                          1000028
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *NOSRCSTMT        *
         *                                       *DEBUGIO   *UNREF            *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *OWNER                       *
         *  Authority  . . . . . . . . . . . :   *USE                         *
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   NOXDB                        *
         *    Library  . . . . . . . . . . . :     *LIBL                      *
         *  Activation group . . . . . . . . :   QILE                         *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
         *--------------------------------------------------------------------*
     40+   Dcl-PR json_getDelimiters Pointer extproc(*CWIDEN :'jx_GetDelimiters');                                          1000029
     41+   End-PR;                                                                                                          1000030
     42+   //Set delimiter used for locate expression                                                                       1000031
     43+   Dcl-PR json_setDelimiters  extproc(*CWIDEN :'jx_SetDelimiters2');                                                1000032
     44+     //always: '/\@¢! .{}' in your  local CCSID                                                                     1000033
     45+     delimiterStr   Pointer    value options(*string);                                                              1000034
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page      4
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     46+   End-PR;                                                                                                          1000035
     47+                                                                                                                    1000036
     48+   Dcl-C json_DELIMITERS const('/\@¢! .{}''"');                                                                     1000037
     49+                                                                                                                    1000038
     50+   //---------------------------------------------------------------------- *                                       1000039
     51+   //Type of a node:                                                                                                1000040
     52+   //---------------------------------------------------------------------- *                                       1000041
     53+   Dcl-C json_UNKNOWN const(0);                                                                                     1000042
     54+   Dcl-C json_OBJECT  const(1);                                                                                     1000043
     55+   Dcl-C json_ARRAY   const(2);                                                                                     1000044
     56+   Dcl-C json_EVAL    const(3);                                                                                     1000045
     57+   Dcl-C json_POINTER_VALUE const(4);                                                                               1000046
     58+   Dcl-C json_VALUE   const(5);                                                                                     1000047
     59+   Dcl-C json_ROOT    const(6);                                                                                     1000048
     60+   Dcl-C json_LITERAL const(16);                                                                                    1000049
     61+   Dcl-C json_OBJLINK const(17);                                                                                    1000050
     62+   Dcl-C json_OBJREPLACE const(18);                                                                                 1000051
     63+   Dcl-C json_OBJCOPY const(18);                                                                                    1000052
     64+   Dcl-C json_BY_CONTEXT const(19);                                                                                 1000053
     65+   Dcl-C json_OBJMOVE const(2048);                                                                                  1000054
     66+                                                                                                                    1000055
     67+   //* Modifiers to "add" / "or" into "parseString" and "evaluate"                                                  1000056
     68+   //|| Type - have to be backwards compat.                                                                         1000057
     69+   //Unlink the source and move it to dest.                                                                         1000058
     70+   Dcl-C json_MOVE_MODES const(2048);                                                                               1000059
     71+   //Allow strings ints and other values to                                                                         1000060
     72+   Dcl-C json_ALLOW_PRIMITIVES const(4096);                                                                         1000061
     73+                                                                                                                    1000062
     74+   //* Combinations:                                                                                                1000063
     75+   //JX_PARSE  = json_EVAL + json_MOVE_NODES                                                                        1000064
     76+   Dcl-C json_PARSE   const(2051);                                                                                  1000065
     77+                                                                                                                    1000066
     78+   //Merge options:                                                                                                 1000067
     79+   //Modifiers to "add" / "or" into "JSON_EVAL"                                                                     1000068
     80+ /if not defined(MO_MERGE)                                                                                          1000069
     81+ /define  MO_MERGE                                                                                                  1000070
     82+   //Only new elements are merged - existing                                                                        1000071
     83+   //are left untouched                                                                                             1000072
     84+   Dcl-C MO_MERGE_NEW const(256);                                                                                   1000073
     85+   //Merge and replace only existing nodes.                                                                         1000074
     86+   Dcl-C MO_MERGE_MATCH const(512);                                                                                 1000075
     87+   //Merge all: replace if it exists and                                                                            1000076
     88+   //append new nodes if not exists                                                                                 1000077
     89+   Dcl-C MO_MERGE_REPLACE const(1024 );                                                                             1000078
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page      5
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
     90+ /endif                                                                                                             1000079
     91+                                                                                                                    1000080
     92+   Dcl-C json_CHILD_LIST const('¢0!');                                                                              1000081
     93+                                                                                                                    1000082
     94+   //---------------------------------------------------------------------- *                                       1000083
     95+   //Returns node to the json_object tree                                                                           1000084
     96+   Dcl-PR json_ParseFile Pointer extproc(*CWIDEN:'jx_ParseFile');                                                   1000085
     97+     //File to parse                                                                                                1000086
     98+     FileName       Pointer    value options(*string);                                                              1000087
     99+     //Parsing options                                                                                              1000088
    100+     Options        Pointer    value options(*string:*nopass);                                                      1000089
    101+   End-PR;                                                                                                          1000090
    102+                                                                                                                    1000091
    103+   //Returns node json_object tree                                                                                  1000092
    104+   Dcl-PR json_ParseString Pointer extproc(*CWIDEN:'jx_ParseString');                                               1000093
    105+     //String to parse                                                                                              1000094
    106+     String         Pointer    value options(*string);                                                              1000095
    107+     //Parsing options                                                                                              1000096
    108+     Options        Pointer    value options(*string:*nopass);                                                      1000097
    109+   End-PR;                                                                                                          1000098
    110+                                                                                                                    1000099
    111+   //Set , or . for numeri decimal point                                                                            1000100
    112+   Dcl-PR json_setDecPoint  extproc(*CWIDEN : 'jx_SetDecPoint');                                                    1000101
    113+     //decimal point char                                                                                           1000102
    114+     decPoint       Pointer    value options(*string);                                                              1000103
    115+   End-PR;                                                                                                          1000104
    116+                                                                                                                    1000105
    117+   //Bool true if errors occures                                                                                    1000106
    118+   Dcl-PR json_Error Ind extproc(*CWIDEN:'jx_Error');                                                               1000107
    119+     //jx_Object  node                                                                                              1000108
    120+     pNode          Pointer    value;                                                                               1000109
    121+   End-PR;                                                                                                          1000110
    122+                                                                                                                    1000111
    123+   //Return error description                                                                                       1000112
    124+   Dcl-PR json_Message Varchar(1024) extproc(*CWIDEN:'jx_Message');                                                 1000113
    125+     //jx_Object                                                                                                    1000114
    126+     pNode          Pointer    value;                                                                               1000115
    127+   End-PR;                                                                                                          1000116
    128+                                                                                                                    1000117
    129+   // Without parameters you will get the last internal error                                                       1000118
    130+   // Otherwise it will format an error object                                                                      1000119
    131+   Dcl-PR json_GetMessageObject Pointer //Return error description                                  I               1000120
    132+                              extproc(*CWIDEN:'jx_GetMessageObject');                                               1000121
    133+     MessageId      Pointer    value options(*string:*nopass);                                      I               1000122
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page      6
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    134+     MessageData    Pointer    value options(*string:*nopass);                                      I               1000123
    135+   End-PR;                                                                                                          1000124
    136+                                                                                                                    1000125
    137+   // simple courtesy function to return a {"success":true} object                                                  1000126
    138+   //Return success:true object                                                                                     1000127
    139+   Dcl-PR json_SuccessTrue Pointer extproc(*CWIDEN:'jx_SuccessTrue');                               I               1000128
    140+     MessageId      Pointer    value options(*string:*nopass);                                      I               1000129
    141+     MessageData    Pointer    value options(*string:*nopass);                                      I               1000130
    142+   End-PR;                                                                                                          1000131
    143+                                                                                                                    1000132
    144+   //Returns pointer to node                                                                                        1000133
    145+   Dcl-PR json_Locate Pointer extproc(*CWIDEN : 'jx_GetNode');                                                      1000134
    146+     //Pointer to tree or node                                                                                      1000135
    147+     pNode          Pointer    value;                                                                               1000136
    148+     //location expression                                                                                          1000137
    149+     Expression     Pointer    value options(*string);                                                              1000138
    150+   End-PR;                                                                                                          1000139
    151+                                                                                                                    1000140
    152+   //Returns pointer to node                                                                                        1000141
    153+   Dcl-PR json_LocateOrCreate Pointer                                                                               1000142
    154+                            extproc(*CWIDEN : 'jx_GetOrCreateNode');                                                1000143
    155+     //Pointer to tree or node                                                                                      1000144
    156+     pNode          Pointer    value;                                                                               1000145
    157+     //location expression                                                                                          1000146
    158+     Expression     Pointer    value options(*string);                                                              1000147
    159+   End-PR;                                                                                                          1000148
    160+                                                                                                                    1000149
    161+   //Returns 'ON' if node exists                                                                                    1000150
    162+   Dcl-PR json_Has Ind extproc(*CWIDEN : 'jx_Has');                                                                 1000151
    163+     //Pointer to tree or node                                                                                      1000152
    164+     pNode          Pointer    value;                                                                               1000153
    165+     //Path to node                                                                                                 1000154
    166+     NodeName       Pointer    value options(*string);                                                              1000155
    167+   End-PR;                                                                                                          1000156
    168+                                                                                                                    1000157
    169+   //Returns 'ON' if node exists and has <> 0                                                                       1000158
    170+   Dcl-PR json_isTrue Ind extproc(*CWIDEN : 'jx_IsTrue');                                                           1000159
    171+     //Pointer to tree or node                                                                                      1000160
    172+     pNode          Pointer    value;                                                                               1000161
    173+     //Path to node                                                                                                 1000162
    174+     NodeName       Pointer    value options(*string);                                                              1000163
    175+   End-PR;                                                                                                          1000164
    176+                                                                                                                    1000165
    177+   //Returns 'ON' if node exists and has <> 0                                                                       1000166
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page      7
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    178+   Dcl-PR json_isNull Ind extproc(*CWIDEN : 'jx_IsNull');                                                           1000167
    179+     //Pointer to tree or node                                                                                      1000168
    180+     pNode          Pointer    value;                                                                               1000169
    181+     //Path to node                                                                                                 1000170
    182+     NodeName       Pointer    value options(*string);                                                              1000171
    183+   End-PR;                                                                                                          1000172
    184+                                                                                                                    1000173
    185+   //Returns 'ON' if it is a valid node                                                                             1000174
    186+   Dcl-PR json_isNode Ind extproc(*CWIDEN : 'jx_isNode');                                                           1000175
    187+     //a.k.a. false for strings                                                                                     1000176
    188+     pNode          Pointer    value;                                                                               1000177
    189+   End-PR;                                                                                                          1000178
    190+                                                                                                                    1000179
    191+   //renames the node name                                                                                          1000180
    192+   Dcl-PR json_NodeRename Ind extproc(*CWIDEN : 'jx_NodeRename');                                                   1000181
    193+     //Pointer to tree or node                                                                                      1000182
    194+     pNode          Pointer    value;                                                                               1000183
    195+     //Path to node                                                                                                 1000184
    196+     NodeName       Pointer    value options(*string);                                                              1000185
    197+   End-PR;                                                                                                          1000186
    198+                                                                                                                    1000187
    199+   //Returns pointer to next sibling (elem)                                                                         1000188
    200+   Dcl-PR json_GetNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                                 1000189
    201+     //Pointer to current node (elem)                                                                               1000190
    202+     pNode          Pointer    value;                                                                               1000191
    203+   End-PR;                                                                                                          1000192
    204+                                                                                                                    1000193
    205+   //Returns pointer to first child (elem)                                                                          1000194
    206+   Dcl-PR json_GetChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                                               1000195
    207+     //Pointer to current node (elem)                                                                               1000196
    208+     pNode          Pointer    value;                                                                               1000197
    209+   End-PR;                                                                                                          1000198
    210+                                                                                                                    1000199
    211+   //Returns pointer to parent node                                                                                 1000200
    212+   Dcl-PR json_GetParent Pointer extproc(*CWIDEN : 'jx_GetNodeParent');                                             1000201
    213+     //Pointer to current node (elem)                                                                               1000202
    214+     pNode          Pointer    value;                                                                               1000203
    215+   End-PR;                                                                                                          1000204
    216+                                                                                                                    1000205
    217+   // Create or replace a node with no value ( null value)                                                          1000206
    218+   Dcl-PR json_SetNull Pointer extproc(*CWIDEN: 'jx_SetNullByName');                                                1000207
    219+     //Pointer to json_ tree                                                                                        1000208
    220+     pNode          Pointer    value;                                                                               1000209
    221+     //Location expression to node or attributes                                                                    1000210
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page      8
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    222+     Expresion      Pointer    value options(*string);                                                              1000211
    223+   End-PR;                                                                                                          1000212
    224+                                                                                                                    1000213
    225+   Dcl-PR json_SetEval pointer extproc(*CWIDEN:'jx_SetEvalByName');                                                 1000214
    226+     pNode          Pointer    value;                                                                               1000215
    227+     Expresion      Pointer    value options(*string);                                                              1000216
    228+     Value          Pointer    value options(*string);                                                              1000217
    229+   End-PR;                                                                                                          1000218
    230+                                                                                                                    1000219
    231+   Dcl-PR json_SetStr Pointer extproc(*CWIDEN: 'jx_SetStrByName');                                                  1000220
    232+     //Pointer to json_ tree                                                                                        1000221
    233+     pNode          Pointer    value;                                                                               1000222
    234+     //Location expression to node or attributes                                                                    1000223
    235+     Expresion      Pointer    value options(*string);                                                              1000224
    236+     //New value to set / pointer to object                                                                         1000225
    237+     Value          Pointer    value options(*string);                                                              1000226
    238+   End-PR;                                                                                                          1000227
    239+                                                                                                                    1000228
    240+   Dcl-PR json_SetInt Pointer extproc(*CWIDEN: 'jx_SetIntByName');                                                  1000229
    241+     //Pointer to json_ tree                                                                                        1000230
    242+     pNode          Pointer    value;                                                                               1000231
    243+     //Location expression to node or attributes                                                                    1000232
    244+     Expresion      Pointer    value options(*string);                                                              1000233
    245+     //New value to set / pointer to object                                                                         1000234
    246+     Value          Int(10)    value;                                                                               1000235
    247+   End-PR;                                                                                                          1000236
    248+                                                                                                                    1000237
    249+   Dcl-PR json_SetNum Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  1000238
    250+     //Pointer to json_ tree                                                                                        1000239
    251+     pNode          Pointer    value;                                                                               1000240
    252+     //Location expression to node or attributes                                                                    1000241
    253+     Expresion      Pointer    value options(*string);                                                              1000242
    254+     //New value to set / pointer to object                                                                         1000243
    255+     Value          Packed(30:15) value;                                                                            1000244
    256+   End-PR;                                                                                                          1000245
    257+                                                                                                                    1000246
    258+   Dcl-PR json_SetBool Pointer extproc(*CWIDEN: 'jx_SetBoolByName');                                                1000247
    259+     //Pointer to json_ tree                                                                                        1000248
    260+     pNode          Pointer    value;                                                                               1000249
    261+     //Location expression to node or attributes                                                                    1000250
    262+     Expresion      Pointer    value options(*string);                                                              1000251
    263+     //New value to set / pointer to object                                                                         1000252
    264+     Value          Ind        value;                                                                               1000253
    265+   End-PR;                                                                                                          1000254
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page      9
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    266+                                                                                                                    1000255
    267+   Dcl-PR json_SetPtr Pointer extproc(*CWIDEN: 'jx_SetPtrByName');                                                  1000256
    268+     //Pointer to json_ tree                                                                                        1000257
    269+     pNode          Pointer    value;                                                                               1000258
    270+     //Location expression to node or attributes                                                                    1000259
    271+     Expresion      Pointer    value options(*string);                                                              1000260
    272+     //Pointer to anything - You do the cleanup                                                                     1000261
    273+     Value          Pointer    value;                                                                               1000262
    274+   End-PR;                                                                                                          1000263
    275+                                                                                                                    1000264
    276+   Dcl-PR json_SetProcPtr Pointer extproc(*CWIDEN: 'jx_SetPtrByName');                                              1000265
    277+     pNode          Pointer    value; //Pointer to json_ tree                                                       1000266
    278+     //Location expression to node or attributes                                                                    1000267
    279+     Expresion      Pointer    value options(*string);                                                              1000268
    280+     Proc           Pointer(*Proc); //Pointer to a procedure                                                        1000269
    281+     //*ON=String escape, *OFF=If literals                                                                          1000270
    282+     isString       Ind        value options(*nopass);                                                              1000271
    283+   End-PR;                                                                                                          1000272
    284+                                                                                                                    1000273
    285+   Dcl-PR json_SetValue Pointer extproc(*CWIDEN: 'jx_SetValueByName');                                              1000274
    286+     //Pointer to json_ tree                                                                                        1000275
    287+     pNode          Pointer    value;                                                                               1000276
    288+     //Location expression to node or attributes                                                                    1000277
    289+     Expresion      Pointer    value options(*string);                                                              1000278
    290+     //New value to set / pointer to object                                                                         1000279
    291+     Value          Pointer    value options(*string:*nopass);                                                      1000280
    292+     //Optional new type (Refer "node type"                                                                         1000281
    293+     Type           Uns(5)     value options(*nopass);                                                              1000282
    294+   End-PR;                                                                                                          1000283
    295+                                                                                                                    1000284
    296+   Dcl-PR json_GetValueStr Varchar(32767)                                                                           1000285
    297+                         extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                    1000286
    298+     //Pointer to node                                                                                              1000287
    299+     pNode          Pointer    value;                                                                               1000288
    300+     //If not found - default value                                                                                 1000289
    301+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000290
    302+   End-PR;                                                                                                          1000291
    303+                                                                                                                    1000292
    304+   Dcl-PR json_GetValueNum Packed(30:15)                                                                            1000293
    305+                         extproc(*CWIDEN : 'jx_GetNodeValueNum');                                                   1000294
    306+     //Pointer to node                                                                                              1000295
    307+     pNode          Pointer    value;                                                                               1000296
    308+     //If not found - default value                                                                                 1000297
    309+     Defaultvalue   Packed(30:15) value options(*NOPASS);                                                           1000298
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     10
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    310+   End-PR;                                                                                                          1000299
    311+                                                                                                                    1000300
    312+   Dcl-PR json_GetValueInt Int(20) extproc(*CWIDEN : 'jx_GetNodeValueInt');                         I               1000301
    313+     pNode          Pointer    value; //Pointer to node                                             I               1000302
    314+     //If not found - default value                                                                                 1000303
    315+     Defaultvalue   Int(20)    value options(*NOPASS);                                              I               1000304
    316+   End-PR;                                                                                                          1000305
    317+                                                                                                                    1000306
    318+   Dcl-PR json_GetValuePtr Pointer extproc(*CWIDEN : 'jx_GetNodeValuePtr');                                         1000307
    319+     //Pointer to node                                                                                              1000308
    320+     pNode          Pointer    value;                                                                               1000309
    321+     //If not found - default value                                                                                 1000310
    322+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000311
    323+   End-PR;                                                                                                          1000312
    324+                                                                                                                    1000313
    325+   Dcl-PR json_GetName Varchar(32767)                                                                               1000314
    326+                     extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                         1000315
    327+     //Pointer to node                                                                                              1000316
    328+     pNode          Pointer    value;                                                                               1000317
    329+   End-PR;                                                                                                          1000318
    330+                                                                                                                    1000319
    331+   Dcl-PR json_GetNameAsPath Varchar(32767)                                                                         1000320
    332+                           extproc(*CWIDEN : 'jx_GetNodeNameAsPath');                                               1000321
    333+     //Pointer to node                                                                                              1000322
    334+     pNode          Pointer    value;                                                                               1000323
    335+     //Delimiter like - or . or / or \                                                                              1000324
    336+     Delimiter      Char(1)    value;                                                                               1000325
    337+   End-PR;                                                                                                          1000326
    338+                                                                                                                    1000327
    339+   //* Refer to node type above                                                                                     1000328
    340+   Dcl-PR json_NodeType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                                 1000329
    341+     //Pointer to json_ tree to receive format                                                                      1000330
    342+     pNode          Pointer    value;                                                                               1000331
    343+   End-PR;                                                                                                          1000332
    344+                                                                                                                    1000333
    345+ // Get string by expresion                                                                                         1000334
    346+ //  /object/array¢123!/name                                                                                        1000335
    347+ //  .object.array¢123!.name                                                                                        1000336
    348+   Dcl-PR json_GetStr Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                            1000337
    349+     //Pointer to relative node                                                                                     1000338
    350+     pNode          Pointer    value;                                                                               1000339
    351+     //Locations expression to node                                                                                 1000340
    352+     Expression     Pointer    value options(*string:*nopass);                                                      1000341
    353+     //If not found - default value                                                                                 1000342
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    354+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000343
    355+   End-PR;                                                                                                          1000344
    356+                                                                                                                    1000345
    357+ //  will join all subsequent array nodes into one resulting string                                                 1000346
    358+   Dcl-PR json_GetStrJoin Varchar(32767)                                                                            1000347
    359+                        extproc(*CWIDEN : 'jx_GetStrJoinVC');                                                       1000348
    360+     //Pointer to relative node                                                                                     1000349
    361+     pNode          Pointer    value;                                                                               1000350
    362+     //Locations expression to node                                                                                 1000351
    363+     Expression     Pointer    value options(*string:*nopass);                                                      1000352
    364+     //If not found - default value                                                                                 1000353
    365+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000354
    366+   End-PR;                                                                                                          1000355
    367+                                                                                                                    1000356
    368+ // Get number by expresion like:                                                                                   1000357
    369+ //  /object/array¢123!/name                                                                                        1000358
    370+ //  .object.array¢123!.name                                                                                        1000359
    371+   Dcl-PR json_GetNum Packed(30:15) extproc(*CWIDEN : 'jx_GetValueNum');                                            1000360
    372+     //Pointer to relative node                                                                                     1000361
    373+     pNode          Pointer    value;                                                                               1000362
    374+     //Locations expression to node                                                                                 1000363
    375+     Expression     Pointer    value options(*string:*nopass);                                                      1000364
    376+     //If not found - default value                                                                                 1000365
    377+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           1000366
    378+   End-PR;                                                                                                          1000367
    379+                                                                                                                    1000368
    380+   Dcl-PR json_GetInt Int(20) extproc(*CWIDEN : 'jx_GetValueInt');                                                  1000369
    381+     //Pointer to relative node                                                                                     1000370
    382+     pNode          Pointer    value;                                                                               1000371
    383+     //Locations expression to node                                                                                 1000372
    384+     Expression     Pointer    value options(*string:*nopass);                                                      1000373
    385+     //If not found - default value                                                                                 1000374
    386+     Defaultvalue   Int(20)    value options(*nopass);                                                              1000375
    387+   End-PR;                                                                                                          1000376
    388+                                                                                                                    1000377
    389+   //Set an ILOB object to a value found by X                                                                       1000378
    390+   //Return *ON if found                                                                                            1000379
    391+   Dcl-PR json_GetIlobValue Ind extproc(*CWIDEN :'ILOB_XmlGetValue');                                               1000380
    392+     //Pointer to ILOB object to receive the va                                                                     1000381
    393+     pIlob          Pointer    value;                                                                               1000382
    394+     //Pointer to tree                                                                                              1000383
    395+     pNode          Pointer    value;                                                                               1000384
    396+     //Location expression to node or attributes                                                                    1000385
    397+     Expression     Pointer    value options(*string);                                                              1000386
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    398+   End-PR;                                                                                                          1000387
    399+                                                                                                                    1000388
    400+   Dcl-PR json_CopyValue Pointer extproc(*CWIDEN : 'jx_CopyValue');                                                 1000389
    401+     //destination node                                                                                             1000390
    402+     pDest          Pointer    value;                                                                               1000391
    403+     //destiantion name (or *NULL or '')                                                                            1000392
    404+     destName       Pointer    value options(*string);                                                              1000393
    405+     //source node                                                                                                  1000394
    406+     pSource        Pointer    value;                                                                               1000395
    407+     //source name (or *NULL or '')                                                                                 1000396
    408+     sourceName     Pointer    value options(*string);                                                              1000397
    409+   End-PR;                                                                                                          1000398
    410+                                                                                                                    1000399
    411+   Dcl-PR json_NodeCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                           1000400
    412+     //node. Retrive from Locate()                                                                                  1000401
    413+     pRootNode      Pointer    value;                                                                               1000402
    414+     //node. Retrive from Locate()                                                                                  1000403
    415+     pNewChild      Pointer    value;                                                                               1000404
    416+     //Reference location to where it arrive                                                                        1000405
    417+     RefLocation    Int(10)    value;                                                                               1000406
    418+   End-PR;                                                                                                          1000407
    419+                                                                                                                    1000408
    420+   //Following constants used by json_NodeCopy:RefLocation                                                          1000409
    421+   Dcl-C json_FIRST_CHILD const(1);                                                                                 1000410
    422+   Dcl-C json_LAST_CHILD const(2);                                                                                  1000411
    423+   Dcl-C json_BEFORE_SIBLING const(3);                                                                              1000412
    424+   Dcl-C json_AFTER_SIBLING const(4);                                                                               1000413
    425+                                                                                                                    1000414
    426+   Dcl-PR json_NodeClone Pointer extproc(*CWIDEN : 'jx_NodeClone');                                                 1000415
    427+     //node. Retrive from Locate()                                                                                  1000416
    428+     pSource        Pointer    value;                                                                               1000417
    429+   End-PR;                                                                                                          1000418
    430+                                                                                                                    1000419
    431+   //returns the new node                                                                                           1000420
    432+   Dcl-PR json_NodeAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                     1000421
    433+     //node. Retrive from Locate()                                                                                  1000422
    434+     pRootNode      Pointer    value;                                                                               1000423
    435+     //Reference location to where it arrive                                                                        1000424
    436+     RefLocation    Int(10)    value;                                                                               1000425
    437+     //Name of node                                                                                                 1000426
    438+     Name           Pointer    value options(*string);                                                              1000427
    439+     //Value or expression                                                                                          1000428
    440+     Value          Pointer    value options(*string);                                                              1000429
    441+     //New type (Refer "node type"                                                                                  1000430
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    442+     Type           Uns(5)     value;                                                                               1000431
    443+   End-PR;                                                                                                          1000432
    444+                                                                                                                    1000433
    445+   Dcl-PR json_NodeDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                       1000434
    446+     //node. Retrive from Locate()                                                                                  1000435
    447+     pRootNode      Pointer    value;                                                                               1000436
    448+   End-PR;                                                                                                          1000437
    449+                                                                                                                    1000438
    450+   //Unlink the note from its previous and promote it as a new root node                                            1000439
    451+   Dcl-PR json_NodeUnlink Pointer extproc(*CWIDEN : 'jx_NodeUnlink');                                               1000440
    452+     //Targenode. Retrive from Locate(                                                                              1000441
    453+     pNode          Pointer    value;                                                                               1000442
    454+   End-PR;                                                                                                          1000443
    455+                                                                                                                    1000444
    456+   Dcl-PR json_NodeSanitize extproc(*CWIDEN : 'jx_NodeSanitize');                                                   1000445
    457+     //node. Retrive from Locate()                                                                                  1000446
    458+     pRootNode      Pointer    value;                                                                               1000447
    459+   End-PR;                                                                                                          1000448
    460+                                                                                                                    1000449
    461+   //CheckSum of all names and values                                                                               1000450
    462+   //Delete all nodes which value are null                                                                          1000451
    463+   Dcl-PR json_NodeCheckSum Uns(10) extproc(*CWIDEN : 'jx_NodeCheckSum');                                           1000452
    464+     pRootNode      Pointer    value; //node. Retrive from Locate()                                                 1000453
    465+   End-PR;                                                                                                          1000454
    466+                                                                                                                    1000455
    467+   //returns the new node                                                                                           1000456
    468+   Dcl-PR json_NewObject Pointer extproc(*CWIDEN : 'jx_NewObject');                                                 1000457
    469+     //Destination. Retrive from Locate()                                                                           1000458
    470+     pDestNode      Pointer    value options(*nopass);                                                              1000459
    471+   End-PR;                                                                                                          1000460
    472+                                                                                                                    1000461
    473+ // Array functions                                                                                                 1000462
    474+   //returns the new node                                                                                           1000463
    475+   Dcl-PR json_NewArray Pointer extproc(*CWIDEN : 'jx_NewArray');                                                   1000464
    476+     //Destination. Retrive from Locate()                                                                           1000465
    477+     pDestNode      Pointer    value options(*nopass);                                                              1000466
    478+   End-PR;                                                                                                          1000467
    479+                                                                                                                    1000468
    480+   //returns the new node added to the end of                                                                       1000469
    481+   Dcl-PR json_ArrayPush Pointer extproc(*CWIDEN : 'jx_ArrayPush');                                                 1000470
    482+     //Destination. Retrive from Locate()                                                                           1000471
    483+     pDestArray     Pointer    value;                                                                               1000472
    484+     //source node to append                                                                                        1000473
    485+     pSourceNode    Pointer    value options(*string);                                                              1000474
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    486+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000475
    487+     copy           Uns(5)     value options(*nopass);                                                              1000476
    488+   End-PR;                                                                                                          1000477
    489+                                                                                                                    1000478
    490+   //Following constants used by json_ArrayPush:copy                                                                1000479
    491+   Dcl-C json_MOVE_UNLINK const(0);                                                                                 1000480
    492+   Dcl-C json_COPY_CLONE const(1);                                                                                  1000481
    493+                                                                                                                    1000482
    494+   //returns the new node added to the end of                                                                       1000483
    495+   Dcl-PR json_ArrayAppend Pointer extproc(*CWIDEN :'jx_ArrayAppend');                                              1000484
    496+     //Destination. Retrive from Locate()                                                                           1000485
    497+     pDestArray     Pointer    value;                                                                               1000486
    498+     //source node to append                                                                                        1000487
    499+     pSourceNode    Pointer    value options(*string);                                                              1000488
    500+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000489
    501+     copy           Uns(5)     value options(*nopass);                                                              1000490
    502+   End-PR;                                                                                                          1000491
    503+                                                                                                                    1000492
    504+   //returns the new array fro source array                                                                         1000493
    505+   Dcl-PR json_ArraySlice Pointer extproc(*CWIDEN : 'jx_ArraySlice' );                                              1000494
    506+     //source node or array string                                                                                  1000495
    507+     pSourceNode    Pointer    value options(*string);                                                              1000496
    508+     //From entry ( 1=First)                                                                                        1000497
    509+     from           Int(10)    value;                                                                               1000498
    510+     //To and includ   (-1 = Until end)                                                                             1000499
    511+     to             Int(10)    value;                                                                               1000500
    512+     //0=(Dft) Unlink and move, 1=copy a clone                                                                      1000501
    513+     copy           Uns(5)     value options(*nopass);                                                              1000502
    514+   End-PR;                                                                                                          1000503
    515+                                                                                                                    1000504
    516+   //returns the new node added to the end of                                                                       1000505
    517+   Dcl-PR json_ArraySort Pointer extproc(*CWIDEN : 'jx_ArraySort');                                                 1000506
    518+     //Destination. Retrive from Locate()                                                                           1000507
    519+     pArray         Pointer    value;                                                                               1000508
    520+     //nodenames if any in subobject to comapre                                                                     1000509
    521+     pkeyNames      Pointer    value options(*string) ;                                                             1000510
    522+     //0=(Dft) use json numerics, 1=Use locale                                                                      1000511
    523+     options        uns(5)     value options(*nopass);                                                              1000512
    524+   End-PR;                                                                                                          1000513
    525+                                                                                                                    1000514
    526+   Dcl-C json_USE_LOCALE const(1);                                                                                  1000515
    527+                                                                                                                    1000516
    528+   //returns the first node with expr value                                                                         1000517
    529+   Dcl-PR json_LookupValue Pointer extproc(*CWIDEN : 'jx_lookupValue');                                             1000518
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    530+     //Array/ obj to search                                                                                         1000519
    531+     pArray         Pointer    value;                                                                               1000520
    532+     //What to search for                                                                                           1000521
    533+     expr           Pointer    value options(*string);                                                              1000522
    534+     //0=(Dft) Same case, 1=ignore case                                                                             1000523
    535+     ignoreCase     Uns(5)     value options(*nopass);                                                              1000524
    536+   End-PR;                                                                                                          1000525
    537+                                                                                                                    1000526
    538+   //Following constants used by json_LookupValue:ignoreCase                                                        1000527
    539+   Dcl-C json_SAME_CASE const(0);                                                                                   1000528
    540+   Dcl-C json_IGNORE_CASE const(1);                                                                                 1000529
    541+                                                                                                                    1000530
    542+   //returns numer of element in array or obj                                                                       1000531
    543+   Dcl-PR json_GetLength Int(10) extproc(*CWIDEN : 'jx_getLength'  );                                               1000532
    544+     //Array to count length                                                                                        1000533
    545+     pArray         Pointer    value;                                                                               1000534
    546+   End-PR;                                                                                                          1000535
    547+                                                                                                                    1000536
    548+   //returns the new node                                                                                           1000537
    549+   Dcl-PR json_Merge Pointer extproc(*CWIDEN : 'jx_NodeMerge');                                                     1000538
    550+     //Destination. Retrive from Locate()                                                                           1000539
    551+     pDestNode      Pointer    value;                                                                               1000540
    552+     //Source tree  Retrive from Locate()                                                                           1000541
    553+     pSourceNode    Pointer    value;                                                                               1000542
    554+     //Optional new type                                                                                            1000543
    555+     Type           Uns(5)     value options(*nopass);                                                              1000544
    556+   End-PR;                                                                                                          1000545
    557+                                                                                                                    1000546
    558+   //Following constants used by json_Merge:Type                                                                    1000547
    559+   Dcl-C json_DONTREPLACE const(0);                                                                                 1000548
    560+   Dcl-C json_REPLACE const(1);                                                                                     1000549
    561+                                                                                                                    1000550
    562+   //returns the new node                                                                                           1000551
    563+   Dcl-PR json_MergeObjects Pointer extproc(*CWIDEN : 'jx_MergeObjects');                                           1000552
    564+     //Destination. Retrive from Locate()                                                                           1000553
    565+     pDestObj       Pointer    value;                                                                               1000554
    566+     //Source tree  Retrive from Locate()                                                                           1000555
    567+     pSourceObj     Pointer    value;                                                                               1000556
    568+     //JX_DONTREPLACE or json_OBJREPLACE                                                                            1000557
    569+     Type           Uns(5)     value;                                                                               1000558
    570+   End-PR;                                                                                                          1000559
    571+                                                                                                                    1000560
    572+   //returns the source node                                                                                        1000561
    573+   Dcl-PR json_MoveObjectInto Pointer extproc(*CWIDEN : 'jx_NodeMoveInto');                                         1000562
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    574+     //Destination. Retrive from Locate()                                                                           1000563
    575+     pDestObj       Pointer    value;                                                                               1000564
    576+     Name           Pointer    value options(*string);                                                              1000565
    577+     //Source tree  Retrive from Locate()                                                                           1000566
    578+     pSourceObj     Pointer    value;                                                                               1000567
    579+   End-PR;                                                                                                          1000568
    580+                                                                                                                    1000569
    581+   Dcl-PR json_Dump  extproc(*CWIDEN : 'jx_Dump');                                                                  1000570
    582+     //Pointer to tree                                                                                              1000571
    583+     pNode          Pointer    value;                                                                               1000572
    584+   End-PR;                                                                                                          1000573
    585+                                                                                                                    1000574
    586+                                                                                                                    1000575
    587+   Dcl-PR json_CloneFormat  extproc(*CWIDEN : 'jx_CloneFormat');                                                    1000576
    588+     //Pointer to tree to receive format                                                                            1000577
    589+     pNode          Pointer    value;                                                                               1000578
    590+     //node ptr or path with right formating                                                                        1000579
    591+     pCloneFrom     Pointer    value options(*string);                                                              1000580
    592+   End-PR;                                                                                                          1000581
    593+                                                                                                                    1000582
    594+   //**  JSON renderes ***                                                                                          1000583
    595+   Dcl-PR json_WriteJsonStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                                1000584
    596+     //node. Retrive from Locate()                                                                                  1000585
    597+     pNode          Pointer    value;                                                                               1000586
    598+     //Name of output stream file                                                                                   1000587
    599+     FileName       Pointer    value options(*string);                                                              1000588
    600+     //Ccsid of output file                                                                                         1000589
    601+     Ccsid          Int(10)    value;                                                                               1000590
    602+     Trim           Ind        value;                                                                               1000591
    603+     //Extra options                                                                                                1000592
    604+     Options        Pointer    value options(*string:*nopass);                                                      1000593
    605+   End-PR;                                                                                                          1000594
    606+                                                                                                                    1000595
    607+   Dcl-PR json_AsJsonText Varchar(32767)                                                                            1000596
    608+                        extproc(*CWIDEN : 'jx_AsJsonText');                                                         1000597
    609+     //node. Retrive from Locate()                                                                                  1000598
    610+     pNode          Pointer    value;                                                                               1000599
    611+   End-PR;                                                                                                          1000600
    612+                                                                                                                    1000601
    613+   Dcl-PR json_AsJsonTextMem Uns(10)                                                                                1000602
    614+                           extproc(*CWIDEN : 'jx_AsJsonTextMem');                                                   1000603
    615+     //node. Retrive from Locate()                                                                                  1000604
    616+     pNode          Pointer    value;                                                                               1000605
    617+     //pointer to any memory buffer                                                                                 1000606
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    618+     pBuffer        Pointer    value;                                                                               1000607
    619+     //Max number of bytes in buffer %size()                                                                        1000608
    620+     maxSize        Uns(10)    value options(*nopass);                                                              1000609
    621+   End-PR;                                                                                                          1000610
    622+                                                                                                                    1000611
    623+   //**  XML  renderes ***                                                                                          1000612
    624+   Dcl-PR json_WriteXmlStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                                  1000613
    625+     //node. Retrive from Locate()                                                                                  1000614
    626+     pNode          Pointer    value;                                                                               1000615
    627+     //Name of output stream file                                                                                   1000616
    628+     FileName       Pointer    value options(*string);                                                              1000617
    629+     //Ccsid of output file                                                                                         1000618
    630+     Ccsid          Int(10)    value;                                                                               1000619
    631+     Trim           Ind        value;                                                                               1000620
    632+     //Extra options                                                                                                1000621
    633+     Options        Pointer    value options(*string:*nopass);                                                      1000622
    634+   End-PR;                                                                                                          1000623
    635+                                                                                                                    1000624
    636+   Dcl-PR json_AsXmlText Varchar(32767) extproc(*CWIDEN : 'jx_AsXmlText');                                          1000625
    637+     //node. Retrive from Locate()                                                                                  1000626
    638+     pNode          Pointer    value;                                                                               1000627
    639+   End-PR;                                                                                                          1000628
    640+                                                                                                                    1000629
    641+   Dcl-PR json_AsXmlTextMem Uns(10) extproc(*CWIDEN : 'jx_AsXmlTextMem');                                           1000630
    642+     //node. Retrive from Locate()                                                                                  1000631
    643+     pNode          Pointer    value;                                                                               1000632
    644+     //pointer to any memory buffer                                                                                 1000633
    645+     pBuffer        Pointer    value;                                                                               1000634
    646+   End-PR;                                                                                                          1000635
    647+                                                                                                                    1000636
    648+   // Return a streamer object to be used in own serialisers                                                        1000637
    649+   Dcl-PR json_Stream pointer extproc(*CWIDEN : 'jx_Stream');                                                       1000638
    650+     //node. Retrive from Locate()                                                                                  1000639
    651+     pNode          Pointer    value;                                                                               1000640
    652+   End-PR;                                                                                                          1000641
    653+                                                                                                                    1000642
    654+   //**  CSV  renderes ***                                                                                          1000643
    655+   Dcl-PR json_WriteCsvStmf  extproc(*CWIDEN : 'jx_WriteCsvStmf');                                                  1000644
    656+     //node. Retrive from Locate()                                                                                  1000645
    657+     pNode          Pointer    value;                                                                               1000646
    658+     //Name of output stream file                                                                                   1000647
    659+     FileName       Pointer    value options(*string);                                                              1000648
    660+     //Ccsid of output file                                                                                         1000649
    661+     Ccsid          Int(10)    value;                                                                               1000650
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    662+     //*ON=Remove inter blanks                                                                                      1000651
    663+     Trim           Ind        value;                                                                               1000652
    664+     //Options: ';.' for separator and dec                                                                          1000653
    665+     Options        Pointer    value options(*string:*nopass);                                                      1000654
    666+   End-PR;                                                                                                          1000655
    667+                                                                                                                    1000656
    668+                                                                                                                    1000657
    669+   Dcl-DS json_DelimiterDS  based(prototype_only) qualified;                                                        1000658
    670+     Slash          Char(1);                                                                                        1000659
    671+     BackSlash      Char(1);                                                                                        1000660
    672+     Masterspace    Char(1);                                                                                        1000661
    673+     BraBeg         Char(1);                                                                                        1000662
    674+     BraEnd         Char(1);                                                                                        1000663
    675+     Blank          Char(1);                                                                                        1000664
    676+     Dot            Char(1);                                                                                        1000665
    677+     CurBeg         Char(1);                                                                                        1000666
    678+     CurEnd         Char(1);                                                                                        1000667
    679+     Apos           Char(1);                                                                                        1000668
    680+     Quot           Char(1);                                                                                        1000669
    681+   End-DS;                                                                                                          1000670
    682+                                                                                                                    1000671
    683+   //Iterators: First use the set the use forEach                                                                   1000672
    684+   Dcl-DS json_Iterator  based(prototype_only) qualified;                                                           1000673
    685+     root           Pointer;                                                                                        1000674
    686+     this           Pointer;                                                                                        1000675
    687+     isList         Ind;                                                                                            1000676
    688+     isFirst        Ind;                                                                                            1000677
    689+     isLast         Ind;                                                                                            1000678
    690+     isRecursive    Ind;                                                                                            1000679
    691+     comma          Varchar(1);                                                                                     1000680
    692+     count          Int(10);                                                                                        1000681
    693+     length         Int(10);                                                                                        1000682
    694+     size           Int(10);                                                                                        1000683
    695+     //Pointer to temp array of elms                                                                                1000684
    696+     listArr        Pointer;                                                                                        1000685
    697+     //Set  this to *ON to teminate loop                                                                            1000686
    698+     break          Ind;                                                                                            1000687
    699+     filler         Char(64);                                                                                       1000688
    700+   End-DS;                                                                                                          1000689
    701+                                                                                                                    1000690
    702+   Dcl-PR json_setIterator  likeds( json_Iterator)                                                                  1000691
    703+                          extproc(*CWIDEN : 'jx_SetIterator');                                                      1000692
    704+     //node. Retrive from Locate()                                                                                  1000693
    705+     pNode          Pointer    value;                                                                               1000694
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    706+     //Optional - path to node                                                                                      1000695
    707+     path           Pointer    value options(*string:*nopass);                                                      1000696
    708+   End-PR;                                                                                                          1000697
    709+                                                                                                                    1000698
    710+   Dcl-PR json_setRecursiveIterator  likeds( json_Iterator)                                                         1000699
    711+                                   extproc(*CWIDEN :                                                                1000700
    712+                                   'jx_SetRecursiveIterator');                                                      1000701
    713+     //node. Retrive from Locate()                                                                                  1000702
    714+     pNode          Pointer    value;                                                                               1000703
    715+     //Optional - path to node                                                                                      1000704
    716+     path           Pointer    value options(*string:*nopass);                                                      1000705
    717+   End-PR;                                                                                                          1000706
    718+                                                                                                                    1000707
    719+   //Iterator Structure                                                                                             1000708
    720+   Dcl-PR json_forEach Ind extproc(*CWIDEN : 'jx_ForEach');                                                         1000709
    721+     iterator                  likeds( json_Iterator);                                                              1000710
    722+   End-PR;                                                                                                          1000711
    723+                                                                                                                    1000712
    724+   //For XML attributes                                                                                             1000713
    725+   Dcl-PR json_GetNodeAttrValue Varchar(32767)                                                                      1000714
    726+                              extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                           1000715
    727+     //Pointer to exsiting element                                                                                  1000716
    728+     pNode          Pointer    value;                                                                               1000717
    729+     //Attribute Name                                                                                               1000718
    730+     AttrName       Pointer    value options(*string);                                                              1000719
    731+     //If not found - default value                                                                                 1000720
    732+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000721
    733+   End-PR;                                                                                                          1000722
    734+                                                                                                                    1000723
    735+   Dcl-PR json_SetNodeAttrValue extproc(*CWIDEN : 'jx_SetNodeAttrValue');                                           1000724
    736+     //Pointer to exsiting element                                                                                  1000725
    737+     pNode          Pointer    value;                                                                               1000726
    738+     //Attribute name                                                                                               1000727
    739+     AttrName       Pointer    value options(*string);                                                              1000728
    740+     //New value                                                                                                    1000729
    741+     Value          Pointer    value options(*string);                                                              1000730
    742+   End-PR;                                                                                                          1000731
    743+                                                                                                                    1000732
    744+   Dcl-PR json_GetAttrValue Varchar(32767)                                                                          1000733
    745+                          extproc(*CWIDEN : 'jx_GetAttrValueVC');                                                   1000734
    746+     //Pointer Attribute                                                                                            1000735
    747+     pAttr          Pointer    value;                                                                               1000736
    748+     //If not found - default value                                                                                 1000737
    749+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1000738
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    750+   End-PR;                                                                                                          1000739
    751+                                                                                                                    1000740
    752+   Dcl-PR json_SetAttrValue extproc(*CWIDEN : 'jx_SetAttrValue');                                                   1000741
    753+     //Pointer Attribute                                                                                            1000742
    754+     pAttr          Pointer    value;                                                                               1000743
    755+     //New value                                                                                                    1000744
    756+     AttrName       Pointer    value options(*string);                                                              1000745
    757+     //Default value                                                                                                1000746
    758+     Value          Pointer    value options(*string);                                                              1000747
    759+   End-PR;                                                                                                          1000748
    760+                                                                                                                    1000749
    761+   //Returns pointer to attribute list                                                                              1000750
    762+   Dcl-PR json_GetAttrFirst Pointer extproc(*CWIDEN : 'jx_GetAttrFirst');                                           1000751
    763+     //Pointer to element                                                                                           1000752
    764+     pElem          Pointer    value;                                                                               1000753
    765+   End-PR;                                                                                                          1000754
    766+                                                                                                                    1000755
    767+   //Returns pointer to attribute list                                                                              1000756
    768+   Dcl-PR json_GetAttrNext Pointer extproc(*CWIDEN : 'jx_GetAttrNext');                                             1000757
    769+     //Pointer to attribute list                                                                                    1000758
    770+     pAttr          Pointer    value;                                                                               1000759
    771+   End-PR;                                                                                                          1000760
    772+                                                                                                                    1000761
    773+   Dcl-PR json_GetAttrName Varchar(32767)                                                                           1000762
    774+                         extproc(*CWIDEN : 'jx_GetAttrNameVC');                                                     1000763
    775+     //Pointer to attribute list                                                                                    1000764
    776+     pAttr          Pointer    value;                                                                               1000765
    777+   End-PR;                                                                                                          1000766
    778+                                                                                                                    1000767
    779+ // Clear the contents of an array or object / delete all children                                                  1000768
    780+   Dcl-PR json_Clear  extproc(*CWIDEN : 'jx_Clear');                                                                1000769
    781+     pNode          Pointer    value; //Pointer to tree node                                                        1000770
    782+   End-PR;                                                                                                          1000771
    783+                                                                                                                    1000772
    784+ // Close all nodes in this tree - also parent and siblings                                                         1000773
    785+   Dcl-PR json_Close  extproc(*CWIDEN : 'jx_Close');                                                                1000774
    786+     //Pointer to tree node                                                                                         1000775
    787+     pNode          Pointer  ;                                                                                      1000776
    788+   End-PR;                                                                                                          1000777
    789+ // Detect if you have a memry leak: call this when you have closed everything at i will return                     1000778
    790+   Dcl-PR json_MemLeak Ind extproc(*CWIDEN : 'jx_MemLeak');                                                         1000779
    791+   End-PR;                                                                                                          1000780
    792+                                                                                                                    1000781
    793+ // Print memory report                                                                                             1000782
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    794+   Dcl-PR json_MemStat  extproc(*CWIDEN : 'jx_MemStat');                                                            1000783
    795+   End-PR;                                                                                                          1000784
    796+                                                                                                                    1000785
    797+ // retune number of bytest used                                                                                    1000786
    798+   Dcl-PR json_MemUse Uns(20) extproc(*CWIDEN : 'jx_MemUse');                                                       1000787
    799+   End-PR;                                                                                                          1000788
    800+                                                                                                                    1000789
    801+ // Return a memory segment pointer, and build a scope where JSON/XML will be created                               1000790
    802+   Dcl-PR json_SegmentSelectNo Pointer                                                                              1000791
    803+                             extproc(*CWIDEN : 'jx_SegmentSelectNo');                                               1000792
    804+     SegmentIndex   Int(10)    value;                                                                               1000793
    805+   End-PR;                                                                                                          1000794
    806+                                                                                                                    1000795
    807+ //  Delete the segment and all JSON/XML nodes build while segment scope was active                                 1000796
    808+   Dcl-PR json_SegmentDispose  extproc(*CWIDEN : 'jx_SegmentDispose');                                              1000797
    809+     segmentPtr     Pointer    value;                                                                               1000798
    810+   End-PR;                                                                                                          1000799
    811+                                                                                                                    1000800
    812+ // Maintain at list of index numbers to database CLOB/BLOB fields since pointers can not be sh                     1000801
    813+   //Returns *ON if found                                                                                           1000802
    814+   Dcl-PR json_mapIx Ind extproc(*CWIDEN:'jx_MapIx' );                                                              1000803
    815+     //pointer to node pointer                                                                                      1000804
    816+     ppNode         Pointer;                                                                                        1000805
    817+     //index of pointer                                                                                             1000806
    818+     Index          Uns(10)    value;                                                                               1000807
    819+   End-PR;                                                                                                          1000808
    820+                                                                                                                    1000809
    821+   //------------------------------------------------------------------------                                       1000810
    822+   //SQL interface:                                                                                                 1000811
    823+   //Note: When SQL functions returns *NULL, then use  the json_Message() to re                                     1000812
    824+   //------------------------------------------------------------------------                                       1000813
    825+                                                                                                                    1000814
    826+ // If options need - then it has to be first call made.                                                            1000815
    827+ // NOTE: If a pConnection pointer is provided, it will be updated with the conection                               1000816
    828+   Dcl-PR json_sqlSetOptions  extproc(*CWIDEN: 'jx_sqlSetOptions');                                                 1000817
    829+     //json object with options ( see sample)                                                                       1000818
    830+     parms          Pointer    value options(*string:*nopass);                                                      1000819
    831+   End-PR;                                                                                                          1000820
    832+                                                                                                                    1000821
    833+ // returns a object node with one resulting row for the SQL statment                                               1000822
    834+   //Returns one SQL row as jx Obejct                                                                               1000823
    835+   Dcl-PR json_sqlResultRow Pointer extproc(*CWIDEN: 'jx_sqlResultRow');                                            1000824
    836+     //SQL statement to run                                                                                         1000825
    837+     sqlStmt        Pointer    value options(*string);                                                              1000826
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    838+     //json object template                                                                                         1000827
    839+     parms          Pointer    value options(*string:*nopass);                                                      1000828
    840+   End-PR;                                                                                                          1000829
    841+                                                                                                                    1000830
    842+ // returns an array (or object with array) of resulting rows for the SQL statment                                  1000831
    843+   //Returns SQL rows as jx Obejct                                                                                  1000832
    844+   Dcl-PR json_sqlResultSet Pointer extproc(*CWIDEN: 'jx_sqlResultSet');                                            1000833
    845+     //SQL statement to run                                                                                         1000834
    846+     sqlStmt        Pointer    value options(*string);                                                              1000835
    847+     //From row; 1=First                                                                                            1000836
    848+     start          Int(10)    value options(*nopass);                                                              1000837
    849+     //max number of rows; json_ALLROWS=all                                                                         1000838
    850+     limit          Int(10)    value options(*nopass);                                                              1000839
    851+     //resultset format:                                                                                            1000840
    852+     format         Int(10)    value options(*nopass);                                                              1000841
    853+     //json object template                                                                                         1000842
    854+     parms          Pointer    value options(*string:*nopass);                                                      1000843
    855+   End-PR;                                                                                                          1000844
    856+                                                                                                                    1000845
    857+                                                                                                                    1000846
    858+   Dcl-C json_ALLROWS const(-1);                                                                                    1000847
    859+                                                                                                                    1000848
    860+   //Following constants used by json_sqlResultSet:format                                                           1000849
    861+   //+ An array with each row as an object                                                                          1000850
    862+   Dcl-C json_ROWARRAY const(0);                                                                                    1000851
    863+   //+ Metaobject: rows, fields                                                                                     1000852
    864+   Dcl-C json_META    const(1);                                                                                     1000853
    865+   //+ Columns info                                                                                                 1000854
    866+   Dcl-C json_FIELDS  const(2);                                                                                     1000855
    867+   //+ Count all rows in the resultset                                                                              1000856
    868+   // ( Pricy so awoid it || )                                                                                      1000857
    869+   Dcl-C json_TOTALROWS const(4);                                                                                   1000858
    870+   //+ Uppercase column names                                                                                       1000859
    871+   Dcl-C json_UPPERCASE const(8);                                                                                   1000860
    872+                                                                                                                    1000861
    873+   //+ Appoximate number of rows..                                                                                  1000862
    874+   //  ( unpresise but cheap || prefered  )                                                                         1000863
    875+   Dcl-C json_APPROXIMATE_TOTALROWS const(16);                                                                      1000864
    876+                                                                                                                    1000865
    877+                                                                                                                    1000866
    878+                                                                                                                    1000867
    879+ // SQL cursor processing                                                                                           1000868
    880+   //Returns handle to sql statement                                                                                1000869
    881+   Dcl-PR json_sqlOpen Pointer extproc(*CWIDEN:'jx_sqlOpen'  );                                                     1000870
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    882+     //SQL statement to run                                                                                         1000871
    883+     sqlStmt        Pointer    value options(*string);                                                              1000872
    884+     //json object template                                                                                         1000873
    885+     parms          Pointer    value options(*string:*nopass);                                                      1000874
    886+   End-PR;                                                                                                          1000875
    887+                                                                                                                    1000876
    888+ // Fetch next from from that open sql handle, starting from rowNumer. 1=First row                                  1000877
    889+   //Returns a row object (or *NULL if EOF)                                                                         1000878
    890+   Dcl-PR json_sqlFetchRelative Pointer                                                                             1000879
    891+                              extproc(*CWIDEN: 'jx_sqlFetchRelative');                                              1000880
    892+     //sql statement handle ( from sqlOpen)                                                                         1000881
    893+     pSqlHndl       Pointer    value;                                                                               1000882
    894+     //row from where to start 1=First                                                                              1000883
    895+     fromRow        Int(10)    value;                                                                               1000884
    896+   End-PR;                                                                                                          1000885
    897+                                                                                                                    1000886
    898+ // Fetch next from from that open sql handle                                                                       1000887
    899+   //Returns a row object (or *NULL if EOF)                                                                         1000888
    900+   Dcl-PR json_sqlFetchNext Pointer extproc(*CWIDEN:'jx_sqlFetchNext');                                             1000889
    901+     //sql statement handle ( from sqlOpen)                                                                         1000890
    902+     pSqlHndl       Pointer    value;                                                                               1000891
    903+   End-PR;                                                                                                          1000892
    904+                                                                                                                    1000893
    905+ // Number of columns in result set ( -1 if error)                                                                  1000894
    906+   //Returns number of columns                                                                                      1000895
    907+   Dcl-PR json_sqlColumns Int(10) extproc(*CWIDEN:'jx_sqlColumns');                                                 1000896
    908+     //sql statement handle ( from sqlOpen)                                                                         1000897
    909+     pSqlHndl       Pointer    value;                                                                               1000898
    910+   End-PR;                                                                                                          1000899
    911+                                                                                                                    1000900
    912+ // Number of rows  in result set ( -1 if error)                                                                    1000901
    913+ // Note: This will run a hidden "select count(*)" which might be a little pricy                                    1000902
    914+   //Returns number of rows                                                                                         1000903
    915+   Dcl-PR json_sqlRows Int(10) extproc(*CWIDEN:'jx_sqlRows');                                                       1000904
    916+     //sql statement handle ( from sqlOpen)                                                                         1000905
    917+     pSqlHndl       Pointer    value;                                                                               1000906
    918+   End-PR;                                                                                                          1000907
    919+                                                                                                                    1000908
    920+ // Always colse the cursor after use, to release resources                                                         1000909
    921+   Dcl-PR json_sqlClose  extproc(*CWIDEN:'jx_sqlClose');                                                            1000910
    922+     //sql statement handle ( from sqlOpen)                                                                         1000911
    923+     pSqlHndl       Pointer;                                                                                        1000912
    924+   End-PR;                                                                                                          1000913
    925+                                                                                                                    1000914
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    926+ // Execute any SQL statement not involving a cursor                                                                1000915
    927+   //Returns *ON if error                                                                                           1000916
    928+   Dcl-PR json_sqlExec Ind extproc(*CWIDEN:'jx_sqlExec'  );                                                         1000917
    929+     //SQL statement to run (template)                                                                              1000918
    930+     sqlStmt        Pointer    value options(*string);                                                              1000919
    931+     //json object template data                                                                                    1000920
    932+     parms          Pointer    value options(*string:*nopass);                                                      1000921
    933+   End-PR;                                                                                                          1000922
    934+                                                                                                                    1000923
    935+ // Execute an update table where the row is defined as a json object                                               1000924
    936+   //Returns *ON if error                                                                                           1000925
    937+   Dcl-PR json_sqlUpdate Ind extproc(*CWIDEN:'jx_sqlUpdate');                                                       1000926
    938+     //table name                                                                                                   1000927
    939+     table          Pointer    value options(*string);                                                              1000928
    940+     //json object: {a:123,b:"value"}                                                                               1000929
    941+     row            Pointer    value options(*string);                                                              1000930
    942+     //where clause : 'where myKey=$key'                                                                            1000931
    943+     where          Pointer    value options(*string:*nopass);                                                      1000932
    944+     //where parameters: { key:777}                                                                                 1000933
    945+     whereParms     Pointer    value options(*string:*nopass);                                                      1000934
    946+   End-PR;                                                                                                          1000935
    947+                                                                                                                    1000936
    948+   //Returns *ON if error                                                                                           1000937
    949+   Dcl-PR json_sqlInsert Ind extproc(*CWIDEN:'jx_sqlInsert');                                                       1000938
    950+     //table name                                                                                                   1000939
    951+     table          Pointer    value options(*string);                                                              1000940
    952+     //json object: {a:123,b:"value"}                                                                               1000941
    953+     row            Pointer    value options(*string);                                                              1000942
    954+     //extra parms                                                                                                  1000943
    955+     parms          Pointer    value options(*string:*nopass);                                                      1000944
    956+   End-PR;                                                                                                          1000945
    957+                                                                                                                    1000946
    958+   //Returns *ON if error                                                                                           1000947
    959+   Dcl-PR json_sqlUpsert Ind extproc(*CWIDEN:'jx_sqlUpsert');                                                       1000948
    960+     //table name                                                                                                   1000949
    961+     table          Pointer    value options(*string);                                                              1000950
    962+     //json object: {a:123,b:"value"}                                                                               1000951
    963+     row            Pointer    value options(*string);                                                              1000952
    964+     //where clause : 'where myKey=$key'                                                                            1000953
    965+     where          Pointer    value options(*string:*nopass);                                                      1000954
    966+     //where parameters: { key:777}                                                                                 1000955
    967+     whereParms     Pointer    value options(*string:*nopass);                                                      1000956
    968+   End-PR;                                                                                                          1000957
    969+                                                                                                                    1000958
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
    970+   //Returns id of last insert                                                                                      1000959
    971+   Dcl-PR json_sqlGetInsertId Int(10) extproc(*CWIDEN:'jx_sqlGetInsertId');                                         1000960
    972+   End-PR;                                                                                                          1000961
    973+                                                                                                                    1000962
    974+   //Returns array of column info                                                                                   1000963
    975+   Dcl-PR json_sqlGetMeta Pointer extproc(*CWIDEN:'jx_sqlGetMeta');                                                 1000964
    976+     sqlstmt        Pointer    value options(*string);                                                              1000965
    977+   End-PR;                                                                                                          1000966
    978+                                                                                                                    1000967
    979+ // Return pointer to database connection. No options => will be default local database                             1000968
    980+   Dcl-PR json_sqlConnect Pointer extproc(*CWIDEN: 'jx_sqlConnect');                                                1000969
    981+     //json object or string with options                                                                           1000970
    982+     parms          Pointer    value options(*string:*nopass);                                                      1000971
    983+   End-PR;                                                                                                          1000972
    984+                                                                                                                    1000973
    985+ // Return pointer to database connection. No options => will be default local database                             1000974
    986+   Dcl-PR json_sqlDisconnect  extproc(*CWIDEN: 'jx_sqlDisconnect');                                                 1000975
    987+   End-PR;                                                                                                          1000976
    988+                                                                                                                    1000977
    989+ // Return sql code for previous statement                                                                          1000978
    990+   Dcl-PR json_sqlCode Int(10) extproc(*CWIDEN: 'jx_sqlCode');                                                      1000979
    991+   End-PR;                                                                                                          1000980
    992+                                                                                                                    1000981
    993+ //Returns a JSON object from a REST call                                                                           1000982
    994+   Dcl-PR json_httpRequest Pointer extproc(*CWIDEN:'jx_httpRequest');                                               1000983
    995+     //Full URL to the resource                                                                                     1000984
    996+     url            Pointer    value options(*string);                                                              1000985
    997+     //json object or string                                                                                        1000986
    998+     pReqNode       Pointer    value options(*string:*nopass);                                                      1000987
    999+     //extra CURL options                                                                                           1000988
   1000+     options        Pointer    value options(*string:*nopass);                                                      1000989
   1001+   End-PR;                                                                                                          1000990
   1002+                                                                                                                    1000991
   1003+ // when the dataarea SQLTRACE is set, your SQL statements                                                          1000992
   1004+ // are logged into SQLTRACE table.                                                                                 1000993
   1005+ // you can supply an extr eye-catch wariable :trcid                                                                1000994
   1006+   Dcl-PR json_traceSetId  extproc(*CWIDEN : 'jx_traceSetId');                                                      1000995
   1007+     traceId        Int(20)    value; //Ccsid of inpur file                                                         1000996
   1008+   End-PR;                                                                                                          1000997
   1009+                                                                                                                    1000998
   1010+ // -------------------------------------------------------------------------------------------                     1000999
   1011+ // Depricated and renamed functions :                                                                              1001000
   1012+ // -------------------------------------------------------------------------------------------                     1001001
   1013+ // Depricated - use  json_GetValueStr                                                                              1001002
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1014+   Dcl-PR json_GetValue Varchar(32767) extproc(*CWIDEN : 'jx_GetValueVC');                                          1001003
   1015+     //Pointer to node                                                                                              1001004
   1016+     pNode          Pointer    value;                                                                               1001005
   1017+     //If not found - default value                                                                                 1001006
   1018+     Expression     Pointer    value options(*string:*nopass);                                                      1001007
   1019+     //If not found - default value                                                                                 1001008
   1020+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001009
   1021+   End-PR;                                                                                                          1001010
   1022+                                                                                                                    1001011
   1023+ // Depricated - use  json_NodeCopy                                                                                 1001012
   1024+   Dcl-PR json_Copy extproc(*CWIDEN : 'jx_NodeCopy');                                                               1001013
   1025+     //element. Retrive from Locate()                                                                               1001014
   1026+     pRootNode      Pointer    value;                                                                               1001015
   1027+     //element. Retrive from Locate()                                                                               1001016
   1028+     pNewChild      Pointer    value;                                                                               1001017
   1029+     //Reference location to where it arrive                                                                        1001018
   1030+     RefLocation    Int(10)    value;                                                                               1001019
   1031+   End-PR;                                                                                                          1001020
   1032+                                                                                                                    1001021
   1033+   Dcl-PR json_ElementCopy extproc(*CWIDEN : 'jx_NodeCopy');                                                        1001022
   1034+     //element. Retrive from Locate()                                                                               1001023
   1035+     pRootNode      Pointer    value;                                                                               1001024
   1036+     //element. Retrive from Locate()                                                                               1001025
   1037+     pNewChild      Pointer    value;                                                                               1001026
   1038+     //Reference location to where it arrive                                                                        1001027
   1039+     RefLocation    Int(10)    value;                                                                               1001028
   1040+   End-PR;                                                                                                          1001029
   1041+                                                                                                                    1001030
   1042+ // Depricated - use  json_NodeDelete                                                                               1001031
   1043+   Dcl-PR json_Delete extproc(*CWIDEN : 'jx_NodeDelete');                                                           1001032
   1044+     //element. Retrive from Locate()                                                                               1001033
   1045+     pRootNode      Pointer    value;                                                                               1001034
   1046+   End-PR;                                                                                                          1001035
   1047+                                                                                                                    1001036
   1048+ // Depricated - use  json_NodeDelete                                                                               1001037
   1049+   Dcl-PR json_ElementDelete extproc(*CWIDEN : 'jx_NodeDelete');                                                    1001038
   1050+     //element. Retrive from Locate()                                                                               1001039
   1051+     pRootNode      Pointer    value;                                                                               1001040
   1052+   End-PR;                                                                                                          1001041
   1053+                                                                                                                    1001042
   1054+ // Depricated - use  json_AsJsonText                                                                               1001043
   1055+   Dcl-PR json_AsText Varchar(32767) extproc(*CWIDEN : 'jx_AsJsonText');                                            1001044
   1056+     //element. Retrive from Locate()                                                                               1001045
   1057+     pNode          Pointer    value;                                                                               1001046
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1058+   End-PR;                                                                                                          1001047
   1059+                                                                                                                    1001048
   1060+                                                                                                                    1001049
   1061+ // json_XpathValue   is depricated and replaced by: json_GetStr                                                    1001050
   1062+   Dcl-PR json_XpathValue Varchar(32767)                                                                            1001051
   1063+                        extproc(*CWIDEN : 'jx_GetValueVC');                                                         1001052
   1064+     //Pointer to tree                                                                                              1001053
   1065+     pNode          Pointer    value;                                                                               1001054
   1066+     //Locations expression to node                                                                                 1001055
   1067+     Expression     Pointer    value options(*string);                                                              1001056
   1068+     //If not found - default value                                                                                 1001057
   1069+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001058
   1070+   End-PR;                                                                                                          1001059
   1071+                                                                                                                    1001060
   1072+ // json_XpathValueNum   is depricated and replaced by: json_GetNum                                                 1001061
   1073+   Dcl-PR json_XpathValueNum Packed(30:15)                                                                          1001062
   1074+                           extproc(*CWIDEN : 'jx_GetValueNum');                                                     1001063
   1075+     //Pointer to tree                                                                                              1001064
   1076+     pJsonCom       Pointer    value;                                                                               1001065
   1077+     //Location expression to node or attributes                                                                    1001066
   1078+     Node           Pointer    value options(*string);                                                              1001067
   1079+     //If not found - default value                                                                                 1001068
   1080+     Defaultvalue   Packed(30:15) value options(*nopass);                                                           1001069
   1081+   End-PR;                                                                                                          1001070
   1082+                                                                                                                    1001071
   1083+ // Use - json_NodeType                                                                                             1001072
   1084+   Dcl-PR json_ElementType Int(5) extproc(*CWIDEN : 'jx_GetNodeType');                                              1001073
   1085+     //Pointer to tree to receive format                                                                            1001074
   1086+     pNode          Pointer    value;                                                                               1001075
   1087+   End-PR;                                                                                                          1001076
   1088+                                                                                                                    1001077
   1089+ // Use json_NodeAdd                                                                                                1001078
   1090+   //returns the new element                                                                                        1001079
   1091+   Dcl-PR json_ElementAdd Pointer extproc(*CWIDEN : 'jx_NodeAdd');                                                  1001080
   1092+     //element. Retrive from Locate()                                                                               1001081
   1093+     pRootNode      Pointer    value;                                                                               1001082
   1094+     //Reference location to where it arrive                                                                        1001083
   1095+     RefLocation    Int(10)    value;                                                                               1001084
   1096+     //Name of element                                                                                              1001085
   1097+     Name           Pointer    value options(*string);                                                              1001086
   1098+     //Value of element                                                                                             1001087
   1099+     Value          Pointer    value options(*string);                                                              1001088
   1100+   End-PR;                                                                                                          1001089
   1101+                                                                                                                    1001090
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1102+ // Use json_GetNext                                                                                                1001091
   1103+   //Returns pointer to next sibling (elem)                                                                         1001092
   1104+   Dcl-PR json_GetElemNext Pointer extproc(*CWIDEN : 'jx_GetNodeNext');                                             1001093
   1105+     //Pointer to current element (elem)                                                                            1001094
   1106+     pElem          Pointer    value  ;                                                                             1001095
   1107+   End-PR;                                                                                                          1001096
   1108+                                                                                                                    1001097
   1109+ // use json_GetChild                                                                                               1001098
   1110+   //Returns pointer to next child (elem)                                                                           1001099
   1111+   Dcl-PR json_GetElemChild Pointer extproc(*CWIDEN : 'jx_GetNodeChild');                                           1001100
   1112+     //Pointer to current element (elem)                                                                            1001101
   1113+     pElem          Pointer    value;                                                                               1001102
   1114+   End-PR;                                                                                                          1001103
   1115+                                                                                                                    1001104
   1116+                                                                                                                    1001105
   1117+ // use get json_GetName                                                                                            1001106
   1118+   Dcl-PR json_getElemName Varchar(32767)                                                                           1001107
   1119+                         extproc(*CWIDEN : 'jx_GetNodeNameVC');                                                     1001108
   1120+     //Pointer to node                                                                                              1001109
   1121+     pNode          Pointer    value;                                                                               1001110
   1122+   End-PR;                                                                                                          1001111
   1123+                                                                                                                    1001112
   1124+ // use xml_GetValueStr                                                                                             1001113
   1125+   Dcl-PR json_GetElemValue Varchar(32767)                                                                          1001114
   1126+                          extproc(*CWIDEN : 'jx_GetNodeValueVC');                                                   1001115
   1127+     //Pointer to element                                                                                           1001116
   1128+     pElem          Pointer    value;                                                                               1001117
   1129+     //If not found - default value                                                                                 1001118
   1130+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001119
   1131+   End-PR;                                                                                                          1001120
   1132+                                                                                                                    1001121
   1133+  // use json_GetAttrValue                                                                                          1001122
   1134+   Dcl-PR json_GetAttr Varchar(32767)                                                                               1001123
   1135+                     extproc(*CWIDEN : 'jx_GetNodeAttrValueVC');                                                    1001124
   1136+     //Pointer to element                                                                                           1001125
   1137+     pNode          Pointer    value;                                                                               1001126
   1138+     //Attribute Name                                                                                               1001127
   1139+     AttrName       Pointer    value options(*string);                                                              1001128
   1140+     //If not found - default value                                                                                 1001129
   1141+     Defaultvalue   Pointer    value options(*string:*nopass);                                                      1001130
   1142+   End-PR;                                                                                                          1001131
   1143+                                                                                                                    1001132
   1144+ // has no effect any longer                                                                                        1001133
   1145+   //Set input and output CCSID                                                                                     1001134
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1146+   Dcl-PR json_setCcsid  extproc(*CWIDEN : 'jx_SetCcsid');                                                          1001135
   1147+     //Ccsid of inpur file                                                                                          1001136
   1148+     inputCCSID     Int(10)    value;                                                                               1001137
   1149+     //Ccsid of output file                                                                                         1001138
   1150+     outputCCSID    Int(10)    value;                                                                               1001139
   1151+   End-PR;                                                                                                          1001140
   1152+                                                                                                                    1001141
   1153+ // depricated - use setNum                                                                                         1001142
   1154+   Dcl-PR json_SetDec Pointer extproc(*CWIDEN: 'jx_SetDecByName');                                                  1001143
   1155+     //Pointer to json_ tree                                                                                        1001144
   1156+     pNode          Pointer    value;                                                                               1001145
   1157+     //Location expression to node or attributes                                                                    1001146
   1158+     Expresion      Pointer    value options(*string);                                                              1001147
   1159+     //New value to set / pointer to object                                                                         1001148
   1160+     Value          Packed(30:15) value;                                                                            1001149
   1161+   End-PR;                                                                                                          1001150
   1162+                                                                                                                    1001151
   1163+ // Depricated in both JSON and XML - use  json_WriteJsonStmf /   json_WriteXmlStmf                                 1001152
   1164+ /if not defined(JSONXML_DEPRICATED)                                                                                1001153
   1165+ /define  JSONXML_DEPRICATED                                                                                        1001154
   1166+   Dcl-PR json_WriteStmf  extproc(*CWIDEN : 'jx_WriteJsonStmf');                                                    1001155
   1167+     //element. Retrive from Locate()                                                                               1001156
   1168+     pNode          Pointer    value;                                                                               1001157
   1169+     //Name of output stream file                                                                                   1001158
   1170+     FileName       Pointer    value options(*string);                                                              1001159
   1171+     //Ccsid of output file                                                                                         1001160
   1172+     Ccsid          Int(10)    value;                                                                               1001161
   1173+     Trim           Ind        value options(*nopass);                                                              1001162
   1174+   End-PR;                                                                                                          1001163
   1175+                                                                                                                    1001164
   1176+   Dcl-PR xml_WriteStmf  extproc(*CWIDEN : 'jx_WriteXmlStmf');                                                      1001165
   1177+     //element. Retrive from Locate()                                                                               1001166
   1178+     pNode          Pointer    value;                                                                               1001167
   1179+     //Name of output stream file                                                                                   1001168
   1180+     FileName       Pointer    value options(*string);                                                              1001169
   1181+     //Ccsid of output file                                                                                         1001170
   1182+     Ccsid          Int(10)    value;                                                                               1001171
   1183+     Trim           Ind        value options(*nopass);                                                              1001172
   1184+   End-PR;                                                                                                          1001173
   1185+ /endif                                                                                                             1001174
   1186    Dcl-S pJson        Pointer;                                                                                       000013
   1187                                                                                                                      000014
   1188    //------------------------------------------------------------- *                                                 000015
   1189                                                                                                                      000016
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     30
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
   1190    // Creat a empty root object                                                                                      000017
   1191    pJson = json_NewObject();                                                                                         000018
   1192                                                                                                                      000019
   1193    // add new elements to the object                                                                                 000020
   1194    json_SetInt    (pJson : 'a'  : 1 );                                                                               000021
   1195    json_SetDec    (pJson : 'b'  : 12.34);                                                                            000022
   1196    json_SetDec    (pJson : 'c'  : 123);                                                                              000023
   1197    json_SetDec    (pJson : 'pi' : 22/7); // 3.147.... infinit                                                        000024
   1198    json_SetBool   (pJson : 'ok' : 2>1);  // true                                                                     000025
   1199    json_SetStr    (pJson : 's'  : 'Hello world');  // String                                                         000026
   1200    json_SetNull   (pJson : 'n'  );  // Null                                                                          000027
   1201                                                                                                                      000028
   1202                                                                                                                      000029
   1203    // Write it out:                                                                                                  000030
   1204    Json_WriteStmf (pJson  :                                                                                          000031
   1205       './Simple-1.json':1208:*OFF                                                                                    000032
   1206    );                                                                                                                000033
   1207                                                                                                                      000034
   1208    json_Close(pJSON);                                                                                                000035
   1209    *inlr = *on;                                                                                                      000036
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     31
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv Number Seq     Message text
 *RNF5409 00   1194 000021  The prototyped call returns a value which is lost when
                            CALLP is used.
 *RNF5409 00   1195 000022  The prototyped call returns a value which is lost when
                            CALLP is used.
 *RNF5409 00   1196 000023  The prototyped call returns a value which is lost when
                            CALLP is used.
 *RNF5409 00   1197 000024  The prototyped call returns a value which is lost when
                            CALLP is used.
 *RNF5409 00   1198 000025  The prototyped call returns a value which is lost when
                            CALLP is used.
 *RNF5409 00   1199 000026  The prototyped call returns a value which is lost when
                            CALLP is used.
 *RNF5409 00   1200 000027  The prototyped call returns a value which is lost when
                            CALLP is used.
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                             / C o p y   M e m b e r s
 Line   Src  RPG name   <-------- External name -------> CCSID  <- Last change ->
 Number Id              Library    File       Member            Date     Time
     12    1 JSONPARSE+ ./../headers/JSONPARSER.rpgle      819  17.09.19 12:51:32
          * * * * *   E N D   O F   / C O P Y   M E M B E R S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     32
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          No references in the source.
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
          *INLR             N(1)                 1209M
 *RNF7031 JSON_AFTER_SIBLING...
                            CONST                 424D
 *RNF7031 JSON_ALLOW_PRIMITIVES...
                            CONST                  72D
 *RNF7031 JSON_ALLROWS      CONST                 858D
 *RNF7031 JSON_APPROXIMATE_TOTALROWS...
                            CONST                 875D
 *RNF7031 JSON_ARRAY        CONST                  55D
 *RNF7031 JSON_ARRAYAPPEND  *(16)                 495D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYPUSH    *(16)                 481D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSLICE   *(16)                 505D
                            PROTOTYPE
 *RNF7031 JSON_ARRAYSORT    *(16)                 517D
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXT   A(32767)              607D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASJSONTEXTMEM...
                            U(10,0)               613D
                            PROTOTYPE
 *RNF7031 JSON_ASTEXT       A(32767)             1055D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXT    A(32767)              636D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_ASXMLTEXTMEM U(10,0)               641D
                            PROTOTYPE
 *RNF7031 JSON_BEFORE_SIBLING...
                            CONST                 423D
 *RNF7031 JSON_BY_CONTEXT   CONST                  64D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     33
 *RNF7031 JSON_CHILD_LIST   CONST                  92D
 *RNF7031 JSON_CLEAR        PROTOTYPE             780D
 *RNF7031 JSON_CLONEFORMAT  PROTOTYPE             587D
          JSON_CLOSE        PROTOTYPE             785D   1208M
 *RNF7031 JSON_COPY         PROTOTYPE            1024D
 *RNF7031 JSON_COPY_CLONE   CONST                 492D
 *RNF7031 JSON_COPYVALUE    *(16)                 400D
                            PROTOTYPE
 *RNF7031 JSON_DELETE       PROTOTYPE            1043D
 *RNF7031 JSON_DELIMITERDS  DS(11)                669D
                            BASED(PROTOTYPE+)
 *RNF7031   APOS            A(1)                  679D
 *RNF7031   BACKSLASH       A(1)                  671D
 *RNF7031   BLANK           A(1)                  675D
 *RNF7031   BRABEG          A(1)                  673D
 *RNF7031   BRAEND          A(1)                  674D
 *RNF7031   CURBEG          A(1)                  677D
 *RNF7031   CUREND          A(1)                  678D
 *RNF7031   DOT             A(1)                  676D
 *RNF7031   MASTERSPACE     A(1)                  672D
 *RNF7031   QUOT            A(1)                  680D
 *RNF7031   SLASH           A(1)                  670D
 *RNF7031 JSON_DELIMITERS   CONST                  48D
 *RNF7031 JSON_DONTREPLACE  CONST                 559D
 *RNF7031 JSON_DUMP         PROTOTYPE             581D
 *RNF7031 JSON_ELEMENTADD   *(16)                1091D
                            PROTOTYPE
 *RNF7031 JSON_ELEMENTCOPY  PROTOTYPE            1033D
 *RNF7031 JSON_ELEMENTDELETE...
                            PROTOTYPE            1049D
 *RNF7031 JSON_ELEMENTTYPE  I(5,0)               1084D
                            PROTOTYPE
 *RNF7031 JSON_ERROR        N(1)                  118D
                            PROTOTYPE
 *RNF7031 JSON_EVAL         CONST                  56D
 *RNF7031 JSON_FIELDS       CONST                 866D
 *RNF7031 JSON_FIRST_CHILD  CONST                 421D
 *RNF7031 JSON_FOREACH      N(1)                  720D
                            PROTOTYPE
 *RNF7031 JSON_GETATTR      A(32767)             1134D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETATTRFIRST *(16)                 762D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNAME  A(32767)              773D
                            VARYING(2)
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     34
                            PROTOTYPE
 *RNF7031 JSON_GETATTRNEXT  *(16)                 768D
                            PROTOTYPE
 *RNF7031 JSON_GETATTRVALUE A(32767)              744D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETCHILD     *(16)                 206D
                            PROTOTYPE
 *RNF7031 JSON_GETDELIMITERS...
                            *(16)                  40D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMCHILD *(16)                1111D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNAME  A(32767)             1118D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETELEMNEXT  *(16)                1104D
                            PROTOTYPE
 *RNF7031 JSON_GETELEMVALUE A(32767)             1125D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETILOBVALUE N(1)                  391D
                            PROTOTYPE
 *RNF7031 JSON_GETINT       I(20,0)               380D
                            PROTOTYPE
 *RNF7031 JSON_GETLENGTH    I(10,0)               543D
                            PROTOTYPE
 *RNF7031 JSON_GETMESSAGEOBJECT...
                            *(16)                 131D
                            PROTOTYPE
 *RNF7031 JSON_GETNAME      A(32767)              325D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNAMEASPATH...
                            A(32767)              331D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNEXT      *(16)                 200D
                            PROTOTYPE
 *RNF7031 JSON_GETNODEATTRVALUE...
                            A(32767)              725D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETNUM       P(30,15)              371D
                            PROTOTYPE
 *RNF7031 JSON_GETPARENT    *(16)                 212D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     35
                            PROTOTYPE
 *RNF7031 JSON_GETSTR       A(32767)              348D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETSTRJOIN   A(32767)              358D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUE     A(32767)             1014D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_GETVALUEINT  I(20,0)               312D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUENUM  P(30,15)              304D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUEPTR  *(16)                 318D
                            PROTOTYPE
 *RNF7031 JSON_GETVALUESTR  A(32767)              296D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_HAS          N(1)                  162D
                            PROTOTYPE
 *RNF7031 JSON_HTTPREQUEST  *(16)                 994D
                            PROTOTYPE
 *RNF7031 JSON_IGNORE_CASE  CONST                 540D
 *RNF7031 JSON_ISNODE       N(1)                  186D
                            PROTOTYPE
 *RNF7031 JSON_ISNULL       N(1)                  178D
                            PROTOTYPE
 *RNF7031 JSON_ISTRUE       N(1)                  170D
                            PROTOTYPE
          JSON_ITERATOR     DS(145)               684D    702     710     721
                            BASED(PROTOTYPE+)
 *RNF7031   BREAK           N(1)                  698D
 *RNF7031   COMMA           A(1)                  691D
                            VARYING(2)
 *RNF7031   COUNT           I(10,0)               692D
 *RNF7031   FILLER          A(64)                 699D
 *RNF7031   ISFIRST         N(1)                  688D
 *RNF7031   ISLAST          N(1)                  689D
 *RNF7031   ISLIST          N(1)                  687D
 *RNF7031   ISRECURSIVE     N(1)                  690D
 *RNF7031   LENGTH          I(10,0)               693D
 *RNF7031   LISTARR         *(16)                 696D
 *RNF7031   ROOT            *(16)                 685D
 *RNF7031   SIZE            I(10,0)               694D
 *RNF7031   THIS            *(16)                 686D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     36
 *RNF7031 JSON_LAST_CHILD   CONST                 422D
 *RNF7031 JSON_LITERAL      CONST                  60D
 *RNF7031 JSON_LOCATE       *(16)                 145D
                            PROTOTYPE
 *RNF7031 JSON_LOCATEORCREATE...
                            *(16)                 153D
                            PROTOTYPE
 *RNF7031 JSON_LOOKUPVALUE  *(16)                 529D
                            PROTOTYPE
 *RNF7031 JSON_MAPIX        N(1)                  814D
                            PROTOTYPE
 *RNF7031 JSON_MEMLEAK      N(1)                  790D
                            PROTOTYPE
 *RNF7031 JSON_MEMSTAT      PROTOTYPE             794D
 *RNF7031 JSON_MEMUSE       U(20,0)               798D
                            PROTOTYPE
 *RNF7031 JSON_MERGE        *(16)                 549D
                            PROTOTYPE
 *RNF7031 JSON_MERGEOBJECTS *(16)                 563D
                            PROTOTYPE
 *RNF7031 JSON_MESSAGE      A(1024)               124D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_META         CONST                 864D
 *RNF7031 JSON_MOVE_MODES   CONST                  70D
 *RNF7031 JSON_MOVE_UNLINK  CONST                 491D
 *RNF7031 JSON_MOVEOBJECTINTO...
                            *(16)                 573D
                            PROTOTYPE
 *RNF7031 JSON_NEWARRAY     *(16)                 475D
                            PROTOTYPE
          JSON_NEWOBJECT    *(16)                 468D   1191
                            PROTOTYPE
 *RNF7031 JSON_NODEADD      *(16)                 432D
                            PROTOTYPE
 *RNF7031 JSON_NODECHECKSUM U(10,0)               463D
                            PROTOTYPE
 *RNF7031 JSON_NODECLONE    *(16)                 426D
                            PROTOTYPE
 *RNF7031 JSON_NODECOPY     PROTOTYPE             411D
 *RNF7031 JSON_NODEDELETE   PROTOTYPE             445D
 *RNF7031 JSON_NODERENAME   N(1)                  192D
                            PROTOTYPE
 *RNF7031 JSON_NODESANITIZE PROTOTYPE             456D
 *RNF7031 JSON_NODETYPE     I(5,0)                340D
                            PROTOTYPE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     37
 *RNF7031 JSON_NODEUNLINK   *(16)                 451D
                            PROTOTYPE
 *RNF7031 JSON_OBJCOPY      CONST                  63D
 *RNF7031 JSON_OBJECT       CONST                  54D
 *RNF7031 JSON_OBJLINK      CONST                  61D
 *RNF7031 JSON_OBJMOVE      CONST                  65D
 *RNF7031 JSON_OBJREPLACE   CONST                  62D
 *RNF7031 JSON_PARSE        CONST                  76D
 *RNF7031 JSON_PARSEFILE    *(16)                  96D
                            PROTOTYPE
 *RNF7031 JSON_PARSESTRING  *(16)                 104D
                            PROTOTYPE
 *RNF7031 JSON_POINTER_VALUE...
                            CONST                  57D
 *RNF7031 JSON_REPLACE      CONST                 560D
 *RNF7031 JSON_ROOT         CONST                  59D
 *RNF7031 JSON_ROWARRAY     CONST                 862D
 *RNF7031 JSON_SAME_CASE    CONST                 539D
 *RNF7031 JSON_SEGMENTDISPOSE...
                            PROTOTYPE             808D
 *RNF7031 JSON_SEGMENTSELECTNO...
                            *(16)                 802D
                            PROTOTYPE
 *RNF7031 JSON_SETATTRVALUE PROTOTYPE             752D
          JSON_SETBOOL      *(16)                 258D   1198M
                            PROTOTYPE
 *RNF7031 JSON_SETCCSID     PROTOTYPE            1146D
          JSON_SETDEC       *(16)                1154D   1195M   1196M   1197M
                            PROTOTYPE
 *RNF7031 JSON_SETDECPOINT  PROTOTYPE             112D
 *RNF7031 JSON_SETDELIMITERS...
                            PROTOTYPE              43D
 *RNF7031 JSON_SETEVAL      *(16)                 225D
                            PROTOTYPE
          JSON_SETINT       *(16)                 240D   1194M
                            PROTOTYPE
 *RNF7031 JSON_SETITERATOR  DS(145)               702D
                            PROTOTYPE
 *RNF7031 JSON_SETNODEATTRVALUE...
                            PROTOTYPE             735D
          JSON_SETNULL      *(16)                 218D   1200M
                            PROTOTYPE
 *RNF7031 JSON_SETNUM       *(16)                 249D
                            PROTOTYPE
 *RNF7031 JSON_SETPROCPTR   *(16)                 276D
                            PROTOTYPE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     38
 *RNF7031 JSON_SETPTR       *(16)                 267D
                            PROTOTYPE
 *RNF7031 JSON_SETRECURSIVEITERATOR...
                            DS(145)               710D
                            PROTOTYPE
          JSON_SETSTR       *(16)                 231D   1199M
                            PROTOTYPE
 *RNF7031 JSON_SETVALUE     *(16)                 285D
                            PROTOTYPE
 *RNF7031 JSON_SQLCLOSE     PROTOTYPE             921D
 *RNF7031 JSON_SQLCODE      I(10,0)               990D
                            PROTOTYPE
 *RNF7031 JSON_SQLCOLUMNS   I(10,0)               907D
                            PROTOTYPE
 *RNF7031 JSON_SQLCONNECT   *(16)                 980D
                            PROTOTYPE
 *RNF7031 JSON_SQLDISCONNECT...
                            PROTOTYPE             986D
 *RNF7031 JSON_SQLEXEC      N(1)                  928D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHNEXT *(16)                 900D
                            PROTOTYPE
 *RNF7031 JSON_SQLFETCHRELATIVE...
                            *(16)                 890D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETINSERTID...
                            I(10,0)               971D
                            PROTOTYPE
 *RNF7031 JSON_SQLGETMETA   *(16)                 975D
                            PROTOTYPE
 *RNF7031 JSON_SQLINSERT    N(1)                  949D
                            PROTOTYPE
 *RNF7031 JSON_SQLOPEN      *(16)                 881D
                            PROTOTYPE
 *RNF7031 JSON_SQLRESULTROW *(16)                 835D
                            PROTOTYPE
 *RNF7031 JSON_SQLRESULTSET *(16)                 844D
                            PROTOTYPE
 *RNF7031 JSON_SQLROWS      I(10,0)               915D
                            PROTOTYPE
 *RNF7031 JSON_SQLSETOPTIONS...
                            PROTOTYPE             828D
 *RNF7031 JSON_SQLUPDATE    N(1)                  937D
                            PROTOTYPE
 *RNF7031 JSON_SQLUPSERT    N(1)                  959D
                            PROTOTYPE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     39
 *RNF7031 JSON_STREAM       *(16)                 649D
                            PROTOTYPE
 *RNF7031 JSON_SUCCESSTRUE  *(16)                 139D
                            PROTOTYPE
 *RNF7031 JSON_TOTALROWS    CONST                 869D
 *RNF7031 JSON_TRACESETID   PROTOTYPE            1006D
 *RNF7031 JSON_UNKNOWN      CONST                  53D
 *RNF7031 JSON_UPPERCASE    CONST                 871D
 *RNF7031 JSON_USE_LOCALE   CONST                 526D
 *RNF7031 JSON_VALUE        CONST                  58D
 *RNF7031 JSON_WRITECSVSTMF PROTOTYPE             655D
 *RNF7031 JSON_WRITEJSONSTMF...
                            PROTOTYPE             595D
          JSON_WRITESTMF    PROTOTYPE            1166D   1204M
 *RNF7031 JSON_WRITEXMLSTMF PROTOTYPE             624D
 *RNF7031 JSON_XPATHVALUE   A(32767)             1062D
                            VARYING(2)
                            PROTOTYPE
 *RNF7031 JSON_XPATHVALUENUM...
                            P(30,15)             1073D
                            PROTOTYPE
 *RNF7031 MO_MERGE_MATCH    CONST                  86D
 *RNF7031 MO_MERGE_NEW      CONST                  84D
 *RNF7031 MO_MERGE_REPLACE  CONST                  89D
          PJSON             *(16)                1186D   1191M   1194    1195
                                                 1196    1197    1198    1199
                                                 1200    1204    1208
          PROTOTYPE_ONLY    *(16)                 669     684
 *RNF7031 XML_WRITESTMF     PROTOTYPE            1176D
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
          LR                                     1209M
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     40
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          jx_Has                                  162
          jx_Dump                                 581
          jx_Error                                118
          jx_Clear                                780
          jx_Close                                785    1208
          jx_MapIx                                814
          jx_IsTrue                               170
          jx_IsNull                               178
          jx_isNode                               186
          jx_Stream                               649
          jx_MemUse                               798
          jx_Message                              124
          jx_GetNode                              145
          jx_NodeAdd                              432    1091
          jx_ForEach                              720
          jx_MemLeak                              790
          jx_MemStat                              794
          jx_sqlOpen                              881
          jx_sqlRows                              915
          jx_sqlExec                              928
          jx_sqlCode                              990
          jx_NodeCopy                             411    1024    1033
          jx_NewArray                             475
          jx_sqlClose                             921
          jx_SetCcsid                            1146
          jx_ParseFile                             96
          jx_CopyValue                            400
          jx_NodeClone                            426
          jx_NewObject                            468    1191
          jx_ArrayPush                            481
          jx_ArraySort                            517
          jx_getLength                            543
          jx_NodeMerge                            549
          jx_AsXmlText                            636
          jx_sqlUpdate                            937
          jx_sqlInsert                            949
          jx_sqlUpsert                            959
          jx_NodeRename                           192
          jx_GetValueVC                           348    1014    1063
          jx_NodeDelete                           445    1043    1049
          jx_NodeUnlink                           451
          jx_ArraySlice                           505
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     41
          jx_AsJsonText                           608    1055
          jx_sqlColumns                           907
          jx_sqlGetMeta                           975
          jx_sqlConnect                           980
          jx_traceSetId                          1006
          jx_ParseString                          104
          jx_SetDecPoint                          112
          jx_SuccessTrue                          139
          jx_GetNodeNext                          200    1104
          jx_GetNodeType                          340    1084
          jx_GetValueNum                          371    1074
          jx_GetValueInt                          380
          jx_ArrayAppend                          495
          jx_lookupValue                          529
          jx_CloneFormat                          587
          jx_SetIterator                          703
          jx_GetAttrNext                          768
          jx_httpRequest                          994
          jx_GetNodeChild                         206    1111
          jx_SetStrByName                         231    1199
          jx_SetIntByName                         240    1194
          jx_SetDecByName                         249    1154    1195    1196
                                                 1197
          jx_SetPtrByName                         267     276
          jx_GetStrJoinVC                         359
          jx_NodeSanitize                         456
          jx_NodeCheckSum                         463
          jx_MergeObjects                         563
          jx_NodeMoveInto                         573
          jx_WriteXmlStmf                         624    1176
          jx_AsXmlTextMem                         641
          jx_WriteCsvStmf                         655
          jx_SetAttrValue                         752
          jx_GetAttrFirst                         762
          jx_sqlResultRow                         835
          jx_sqlResultSet                         844
          jx_sqlFetchNext                         900
          jx_GetDelimiters                         40
          jx_GetNodeParent                        212
          jx_SetNullByName                        218    1200
          jx_SetEvalByName                        225
          jx_SetBoolByName                        258    1198
          jx_GetNodeNameVC                        326    1119
          ILOB_XmlGetValue                        391
          jx_WriteJsonStmf                        595    1166    1206
          jx_AsJsonTextMem                        614
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     42
          jx_GetAttrNameVC                        774
          jx_sqlSetOptions                        828
          jx_sqlDisconnect                        986
          jx_SetDelimiters2                        43
          jx_SetValueByName                       285
          jx_GetNodeValueVC                       297    1126
          jx_GetAttrValueVC                       745
          jx_SegmentDispose                       808
          jx_sqlGetInsertId                       971
          jx_GetOrCreateNode                      154
          jx_GetNodeValueNum                      305
          jx_GetNodeValueInt                      312
          jx_GetNodeValuePtr                      318
          jx_SegmentSelectNo                      803
          jx_GetMessageObject                     132
          jx_SetNodeAttrValue                     735
          jx_sqlFetchRelative                     891
          jx_GetNodeNameAsPath                    332
          jx_GetNodeAttrValueVC                   726    1135
          jx_SetRecursiveIterator                 712
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     43
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF5409 00      7 The prototyped call returns a value which is lost when CALLP
                    is used.
 *RNF7031 00    182 The name or indicator is not referenced.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             NOXDB/JSONPARS6A         D1EDPAS4   17.09.19 12:51:51        Page     44
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :      189
     Warning      (10) . . . . . . . :        0
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :      189
   Source Totals:
     Records . . . . . . . . . . . . :     1209
     Specifications  . . . . . . . . :      614
     Data records  . . . . . . . . . :        0
     Comments  . . . . . . . . . . . :      422
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program JSONPARS6A placed in library NOXDB. 00 highest severity. Created on 17.09.19 at 12:51:51.
           * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
